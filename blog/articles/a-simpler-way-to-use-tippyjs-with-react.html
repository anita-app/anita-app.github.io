<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width,initial-scale=1"> <meta name="application-name" content="Anita"> <meta name="msapplication-TileColor" content="#002346"> <link rel="apple-touch-icon" sizes="180x180" href="/assets/icons/favicon/apple-touch-icon.png"> <link rel="icon" type="image/png" sizes="32x32" href="/assets/icons/favicon/favicon-32x32.png"> <link rel="icon" type="image/png" sizes="16x16" href="/assets/icons/favicon/favicon-16x16.png"> <link rel="manifest" href="/assets/icons/favicon/site.webmanifest"> <link rel="mask-icon" href="/assets/icons/favicon/safari-pinned-tab.svg" color="#5bbad5"> <link rel="shortcut icon" href="/assets/icons/favicon/favicon.ico"> <meta name="msapplication-TileColor" content="#da532c"> <meta name="msapplication-config" content="/assets/icons/favicon/browserconfig.xml"> <meta name="theme-color" content="#002346"> <link rel="stylesheet" href="/assets/css/styles-0-21-0.min.css"> <title>A simpler way to use Tippy.js with React</title> <meta name="description" content="Use Tippy.js in any React project without third-party libraries or other middleware."> </head> <body class="text-gray-800 antialiased flex flex-col h-screen justify-between"> <nav class="top-0 absolute z-50 w-full flex flex-wrap items-center justify-between py-3 navbar-expand-lg bg-gradient-to-r from-prussian-blue-400 to-prussian-blue-700"> <div class="container px-4 mx-auto flex flex-wrap items-center justify-between z-50"> <div class="w-full relative flex justify-between lg:w-auto lg:static lg:block lg:justify-start"> <div class="flex-grow relative flex items-center lg:w-auto lg:static"> <a class="text-lg font-bold leading-relaxed inline-block mr-4 py-2 whitespace-no-wrap uppercase text-white" href="/"> <img src="/assets/logo/logo_square.svg" style="height:35px;width:auto" alt="Anita"> </a> <a class="text-lg font-bold leading-relaxed inline-block mr-4 py-2 whitespace-no-wrap uppercase text-white" href="/"> Anita </a> </div> <button class="cursor-pointer text-xl leading-none px-3 py-1 border border-solid border-transparent rounded bg-transparent block lg:hidden outline-none focus:outline-none" type="button" onclick='toggleNavbar("main-collapse-navbar")'> <ion-icon name="menu-outline" class="text-white" style="width:1.5em;height:1.5em"></ion-icon> </button> </div> <div class="lg:flex flex-grow items-center bg-white lg:bg-transparent lg:shadow-none hidden" id="main-collapse-navbar"> <ul class="flex flex-col lg:flex-row list-none lg:ml-auto"> <li class="flex items-center"> <a class="lg:text-white lg:hover:text-gray-300 text-gray-800 px-3 py-4 lg:py-2 flex items-center text-xs uppercase font-bold" href="/blog"> Blog </a> </li> <li class="flex items-center"> <a class="lg:text-white lg:hover:text-gray-300 text-gray-800 px-3 py-4 lg:py-2 flex items-center text-xs uppercase font-bold" href="https://github.com/anita-app/anita"> <span class="inline-block mr-2">Source Code</span> <ion-icon name="logo-github" class="lg:text-gray-300 text-gray-500" style="width:1.5em;height:1.5em"></ion-icon> </a> </li> </ul> </div> </div> </nav> <section class="relative"> <div class="mx-auto pb-20 mt-36 mb-36"> <div class="w-full max-w-3xl ml-auto mr-auto py-10 px-6 sm:px-8 md:px-0"> <article> <div class="pt-2 pb-1 pr-5 border-b rounded-t"> <h1 class="block text-center font-light leading-8 tracking-tight text-gray-900 text-4xl pb-6">A simpler way to use Tippy.js with React</h1> <span class="text-sm text-gray-400">Article</span> </div> <p class="text-sm text-gray-500 mb-8 mt-1">Published on December 18, 2022 by ilDon </p> <figure class="mb-10 mt-10"> <img class="w-full rounded-lg mx-auto" src="/assets/images/blog/a-simpler-way-to-use-tippyjs-with-react/a-simpler-way-to-use-tippyjs-with-react.jpg" alt="" width="1310" height="873"> </figure> <div class="prose prose-lg prose-prussian-blue mx-auto mt-6 text-gray-500 max-w-none"> <p>Tooltips are a powerful UX element. They help users understand the purpose of UI elements without cluttering the layout of the page.</p> <p>That is, if tooltips are properly rendered. When dealing with tooltips in a web app, there are many things to consider. </p> <p>First, the UI in itself is obviously very important. Tooltips should be nice to look at, and they should be easy to use. But there are also many other things to consider. Tooltips should be accessible, they should be easy to implement, and they should be easy to maintain. </p> <p>Due to the many things to consider, developing them from scratch can be a lengthy and tedious process. Thankfully, there are many libraries that can help us with this task. <a href="https://atomiks.github.io/tippyjs/">Tippy.js</a> is probably one of the most popular libraries for rendering tooltips in a web app. It is lightweight, it is easy to use, and it is very flexible.</p> <p>In this article I will discuss how I implemented tooltips in Anita using Tippy.js, and how I integrated it with React.</p> <h2 id="myfrustrationwithmostreacttooltiplibraries">My frustration with most React tooltip libraries</h2> <p>When I <a href="/blog/articles/porting-anita-from-angular-to-react-resulted-in-20-less-code.html">migrated Anita from Angular to React</a>, I picked <a href="https://github.com/ReactTooltip/react-tooltip#readme">react-tooltip</a> to render tooltips. The choice seemed nearly obvious. With more than <a href="https://www.npmjs.com/package/react-tooltip">1,200,000 weekly downloads on NPM</a>, it is easily one of the most popular tooltip libraries for React. But after using it for a while I found that I did not like the developer experience.</p> <p>The thing that bothered me the most was the way the tooltips are implemented. The library uses a custom tooltip component, <code>ReactTooltip</code>. As explained in the docs, to render a simple tooltip we need to do something like this:</p> <div class="code-block"><pre class="d"><code>&lt;button data-tip="Hello world"&gt;Hover me&lt;/button&gt;
&lt;ReactTooltip /&gt;
</code></pre></div> <p>For each tooltip, we need to add a <code>data-tip</code> attribute to the element we want to attach the tooltip to, and we need to include in the React Tree a <code>ReactTooltip</code> node. This is not a big deal, but it does add some clutter to the markup. If we need to add multiple tooltips to a page, we also need to add a <code>data-for</code> attribute to the element for which we want to render the tooltip. The <code>data-for</code> value must then match the <code>id</code> of a <code>ReactTooltip</code> component. Again, this is not a big deal, but it adds even more clutter to the markup.</p> <p>What I would prefer is to have a simple way of adding tooltips to any element, without adding any additional custom data attributes to the element. I would also prefer to keep the markup clean, and not have to include a custom component simply to render tooltips.</p> <p>Unfortunately most React libraries I came across, have the same problem. They all rely on, in one way or the other, a custom component to render the tooltips. For example, <a href="https://github.com/atomiks/tippyjs-react#readme">@tippyjs/react</a> uses a <code>Tippy</code> component to render the tooltips:</p> <div class="code-block"><pre class="d"><code>&lt;Tippy content={&lt;span&gt;Tooltip&lt;/span&gt;}&gt;
  &lt;button&gt;My button&lt;/button&gt;
&lt;/Tippy&gt;
</code></pre></div> <h2 id="renderingtooltipswithtippyjsandacustomhook">Rendering tooltips with Tippy.js and a custom hook</h2> <p>Tippy.js provides a <code>tippy</code> function that can be used to render a tooltip. </p> <p>The function takes two arguments. The first identifies the DOM elements to which a tooltip should be attached to. It can be a <code>selector</code>, an array of DOM <code>Element</code>s, or a <code>NodeList</code>. The second argument is an object with the configuration of the tooltip. </p> <p>For example, to render a tooltip with the text “Hello world” we can do something like this:</p> <div class="code-block"><pre class="d"><code>tippy('#my-button', {
  content: 'Hello world',
});
</code></pre></div> <p>The problem of integrating Tippy.js in a React app is that the <code>tippy</code> function will attach tooltips only to elements that are in the DOM when the function <code>tippy</code> is called. </p> <p>Because React renders the elements in the DOM only after the component is mounted, we need a strategy to render the tooltips after the component is mounted. We can do this by using a custom hook. The idea is that the hook will call the <code>tippy</code> function when the component is mounted, it will create an instance for the DOM element, and it will destroy such instance when the component is unmounted.</p> <p>To create the Tippy.js instance, we could pass to the hook a reference to the element to which we want to attach a tooltip. This, however, would result again in a cluttered component. We would first need to create a <code>ref</code> constant with <code>React.useRef</code>, and then we would need to add a <code>ref</code> attribute to the element to which we want to attach the tooltip. We would then need to pass the reference to the hook. This would look something like this:</p> <div class="code-block"><pre class="d"><code>const MyButton = () =&gt; {
  const buttonRef = React.useRef();
  useTippy(buttonRef, { content: 'Hello world' });

  return (
    &lt;button ref={buttonRef}&gt;Hover me&lt;/button&gt;
  )
}
</code></pre></div> <p>In the hook we would then need to call the <code>tippy</code> function only once the reference is set.</p> <p>This approach might be an improvement over the "component-based" approach of many libraries, but it's a little one. Instead of a custom component, we now have a reference to the element to which we want to attach the tooltip. We can do better.</p> <p>We can pass to the hook the <code>selector</code> of the element to which we want to attach the tooltip. The hook can then rely on Tippy.js to find the element to which we want to attach the tooltip. </p> <p>This is how the hook looks like:</p> <div class="code-block"><pre class="d"><code>import { useEffect, useRef } from 'react'
import tippy, { Instance } from 'tippy.js'

export const useTippyTooltip = (selector: string, options): void =&gt; {
  const instancesRef = useRef&lt;Array&lt;Instance&gt; | undefined&gt;()
  window.requestAnimationFrame(() =&gt; {
    if (instancesRef.current?.length) {
      return
    }
    instancesRef.current = tippy(selector, options)
  })
  useEffect(() =&gt; () =&gt; {
    instancesRef.current?.every((i) =&gt; i.destroy())
  }
  , [])
}
</code></pre></div> <p>The hook takes two arguments: the <code>selector</code> and the <code>options</code> object. The <code>selector</code> is the same as the one used by Tippy.js. The <code>options</code> object is as well the same object that we would pass to the <code>tippy</code> function. The hook then uses a <code>useRef</code> hook to store the instances of the tooltips to avoid creating multiple instances for the same elements. </p> <p>Note that the hook uses <code>window.requestAnimationFrame</code> to delay the creation of the tooltip until the next frame. This is necessary because the element to which we want to attach the tooltip is most likely not in the DOM yet when the hook is first executed. The hook then calls the <code>tippy</code> function to create the tooltip. Finally, the hook also uses the return function of a <code>useEffect</code> hook to destroy the tooltip when the component is unmounted.</p> <p>The hook can be used in a functional component like this:</p> <div class="code-block"><pre class="d"><code>const MyButton = () =&gt; {
  useTippyTooltip('#my-button', { content: 'Click the button to do something' })
  return (
    &lt;button id="my-button"&gt;Hover me&lt;/button&gt;
  )
}
</code></pre></div> <h2 id="conclusion">Conclusion</h2> <p>As an additional bonus, this approach has the benefit of directly interacting with Tippy.js. We don’t need to rely on a third-party library to render the tooltips. This means that we can use any Tippy.js feature directly, without any of the limitations that might be imposed by a middleware. </p> <p>For example, in Anita we show tooltips on certain buttons only below certain screen widths. This is achieved with the <a href="https://tailwindcss.com/docs/responsive-design">responsive design breakpoints prefixes</a>, such as <code>lg:hidden</code>. Tippy.js does not support adding custom CSS classes via the <code>options</code> object, and we don't want to define an entire new Tippy.js theme just for this. Thanks to the approach described in this post, we can use the <code>onShow</code> callback to add the custom CSS class to the tooltip. This is how we do it:</p> <div class="code-block"><pre class="d"><code>instancesRef.current?.forEach((i) =&gt; {
  i.props.onShow = (i: Instance) =&gt; {
    i.popper.classList.add(additionalClasses)
  }
})
</code></pre></div> <p>In conclusion, the approach described in this post is a good compromise between the flexibility of Tippy.js and the way in which React renders the DOM. It allows us to use Tippy.js directly, without relying on a third-party library, and without adding any additional custom data attributes to the elements to which we want to attach the tooltips.</p> </div> </article> <div class="flex justify-center mt-10"> <a class="bg-blue-500 hover:bg-blue-700 text-white py-4 px-6 rounded" href="/app"> <span class="font-bold text-2xl">Get started</span><sup class="text-xs">Beta</sup> </a> </div> </div> </div> </section> <footer class="relative bg-gray-300 pt-8 pb-6"> <div class="bottom-auto top-0 left-0 right-0 w-full absolute pointer-events-none overflow-hidden -mt-20" style="height:80px;transform:translateZ(0)"> <svg class="absolute bottom-0 overflow-hidden" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="none" version="1.1" viewBox="0 0 2560 100" x="0" y="0"> <polygon class="text-gray-300 fill-current" points="2560 0 2560 100 0 100"></polygon> </svg> </div> <div class="container mx-auto px-4"> <div class="flex flex-wrap items-center md:justify-left justify-left"> <div class="w-2/12 md:w-3/12"> <button class="bg-white text-gray-900 shadow-lg font-normal h-10 w-10 items-center justify-center align-center rounded-full outline-none focus:outline-none mr-2" onclick='window.open("https://github.com/anita-app/anita","_blank")'> <ion-icon name="logo-github" class="mt-1" style="width:1.5em;height:1.5em"></ion-icon> </button> </div> <div class="column-1 w-10/12 md:w-6/12 text-right md:text-center py-1"> <div class="flex justify-end md:justify-center text-sm text-gray-600 font-semibold flex-wrap"> Developed with <ion-icon name="heart-outline" class="text-red-800 self-end ml-1 mr-1" style="width:1.2em;height:1.2em"></ion-icon> by humans & <a href="https://copilot.github.com/" target="_blank" class="ml-1"><u>GitHub Copilot</u></a>, </div> <div class="flex justify-end md:justify-center text-sm text-gray-600 font-semibold flex-wrap"> made possible by <a href="/licenses.html" class="ml-1"><u>open source</u></a>. </div> </div> </div> </div> <script src="/assets/js/main-0-21-0.min.js"></script> <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script> <script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script> <script data-goatcounter="https://anita.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script> </footer> </body> </html> 