(this["webpackJsonpanita-app"]=this["webpackJsonpanita-app"]||[]).push([[0],{162:function(e,t){},164:function(e,t){},174:function(e,t){},176:function(e,t){},203:function(e,t){},205:function(e,t){},206:function(e,t){},211:function(e,t){},213:function(e,t){},219:function(e,t){},221:function(e,t){},240:function(e,t){},252:function(e,t){},255:function(e,t){},293:function(e,t,n){},294:function(e,t,n){},295:function(e,t,n){"use strict";n.r(t);n(154);var r,i=n(13),a=n(6);!function(e){e[e.toggleSidebar=1]="toggleSidebar",e[e.addProjectToList=2]="addProjectToList",e[e.setProjectList=3]="setProjectList",e[e.setCurrentProject=4]="setCurrentProject",e[e.resetCurrentProject=5]="resetCurrentProject",e[e.addSectionForChildOfSelector=6]="addSectionForChildOfSelector",e[e.resetSectionForChildOfSelector=7]="resetSectionForChildOfSelector",e[e.setValidStateForEle=8]="setValidStateForEle",e[e.unsetValidStateForEle=9]="unsetValidStateForEle",e[e.updateFormElement=10]="updateFormElement",e[e.updateFormElementKey=11]="updateFormElementKey",e[e.setFormProject=12]="setFormProject",e[e.setProjectEditorMode=13]="setProjectEditorMode",e[e.updateFormProjectSettings=14]="updateFormProjectSettings",e[e.updateFormProjectAddSection=15]="updateFormProjectAddSection",e[e.updateFormProjectUpdateSection=16]="updateFormProjectUpdateSection",e[e.updateFormProjectUpdateFormModelOfSection=17]="updateFormProjectUpdateFormModelOfSection",e[e.updateFormProjectRemoveSection=18]="updateFormProjectRemoveSection",e[e.updateFormProjectAddFieldToSection=19]="updateFormProjectAddFieldToSection",e[e.updateFormProjectRemoveFieldFromSection=20]="updateFormProjectRemoveFieldFromSection",e[e.updateFormProjectUpdateFormModelAddOption=21]="updateFormProjectUpdateFormModelAddOption",e[e.updateFormProjectUpdateFormModelDeleteOption=22]="updateFormProjectUpdateFormModelDeleteOption",e[e.updateFormProjectUpdateFormModelOptionValue=23]="updateFormProjectUpdateFormModelOptionValue"}(r||(r={}));var o,c={element:null},s={};!function(e){e[e.basicInput=1]="basicInput",e[e.basicTextarea=2]="basicTextarea",e[e.basicCheckbox=3]="basicCheckbox",e[e.basicSelect=4]="basicSelect",e[e.basicRadio=5]="basicRadio",e[e.hiddenInput=6]="hiddenInput",e[e.optionsMaker=7]="optionsMaker",e[e.datePicker=8]="datePicker",e[e.dateTimePicker=9]="dateTimePicker",e[e.childOfSelectorForSection=10]="childOfSelectorForSection",e[e.parentsSelector=11]="parentsSelector"}(o||(o={}));var l,u,d,f=[{value:o.basicInput,label:"Short text"},{value:o.basicTextarea,label:"Long text"},{value:o.basicCheckbox,label:"Check box"},{value:o.basicSelect,label:"Drop-down list"},{value:o.basicRadio,label:"Alternative choice"},{value:o.datePicker,label:"Date picker"},{value:o.dateTimePicker,label:"Date & time"}];!function(e){e.color="color",e.email="email",e.number="number",e.password="password",e.range="range",e.tel="tel",e.text="text",e.url="url"}(l||(l={})),function(e){e.date="date",e.month="month",e.week="week"}(u||(u={})),function(e){e.datetimeLocal="datetime-local",e.time="time"}(d||(d={}));var h,p,b=[{value:l.text,label:"Text"},{value:l.email,label:"Email"},{value:l.number,label:"Number"},{value:l.password,label:"Password"},{value:l.color,label:"Color"},{value:l.range,label:"Range"},{value:l.tel,label:"Tel"},{value:l.url,label:"Url"}],j=[{value:u.date,label:"Date"},{value:u.month,label:"Month"},{value:u.week,label:"Week"}],m=[{value:d.datetimeLocal,label:"Date & time"},{value:d.time,label:"Time only"}],v={componentCode:o.basicInput,fieldName:"label",type:l.text,label:"Label",required:!0,width:"8"},x={componentCode:o.basicInput,fieldName:"label",type:l.text,label:"Label",required:!0,width:"11"},O=[{componentCode:o.basicInput,fieldName:"value",type:l.text,label:"Value",required:!0,width:"3"},v],y=[{componentCode:o.hiddenInput,fieldName:"value"},x],g=[{componentCode:o.basicInput,fieldName:"value",type:l.text,label:"Value",disabled:!0,required:!0,width:"3"},v],w=[{componentCode:o.hiddenInput,fieldName:"value"},x];!function(e){e[e.fileSystem=1]="fileSystem",e[e.IndexedDB=2]="IndexedDB",e[e.SQLite=3]="SQLite"}(h||(h={})),function(e){e.id="id",e.createdAt="createdAt",e.parentsInfo="parentsInfo",e.updatedAt="updatedAt",e.createdBy="createdBy"}(p||(p={}));var k,S,N="Not supported in this browser.\nAvailable only on the Desktop version of Chrome, Edge and Opera.",I=[{componentCode:o.hiddenInput,fieldName:p.id},{componentCode:o.hiddenInput,fieldName:p.createdAt},{componentCode:o.basicInput,fieldName:"title",type:l.text,value:"",label:"Project",required:!0},{componentCode:o.basicTextarea,fieldName:"description",value:"",label:"Description",required:!0}],C=[{label:"File system",value:h.fileSystem,disabled:"undefined"===typeof window.showOpenFilePicker,hint:"function"===typeof window.showOpenFilePicker?'The Project is saved in a file on your computer in JSON. Data is updated automatically every time you make any change.\nYou can chose the name and the location of the file when you click "Save" at the bottom of this form.':N},{label:"Local database (IndexedDB)",value:h.IndexedDB,hint:"The Project is saved on your computer in the IndexedDB database of your Browser.\nYou can export data in a JSON file at any time."},{label:"Local database (SQLite)",value:h.SQLite,disabled:"undefined"===typeof window.showOpenFilePicker,hint:"function"===typeof window.showOpenFilePicker?"The Project is saved on your computer in a SQLite database.\nThe database is stored in a file in your File System.":N}],E=[].concat(I,[{componentCode:o.basicRadio,fieldName:"localStorage",value:h.IndexedDB,label:"Local storage",required:!0,options:C}]),D=[].concat(I,[{componentCode:o.basicRadio,fieldName:"localStorage",value:h.IndexedDB,label:"Local storage",required:!0,disabled:!0,options:C}]),F=n(28),P=n(10),A=(o.hiddenInput,p.id,o.basicInput,l.text,o.childOfSelectorForSection,Object.entries(o).map((function(e){var t=Object(P.a)(e,2);t[0];return t[1]})).filter((function(e){return![o.basicInput,o.datePicker,o.dateTimePicker].includes(e)&&"number"===typeof e}))),_=function(e,t){return[{componentCode:o.basicInput,fieldName:"label",type:l.text,label:"Field label",required:!0,width:e.toString(),prerequisites:[{componentCode:[void 0,""].concat(Object(F.a)(A))}]},{componentCode:o.basicInput,fieldName:"label",type:l.text,label:"Field label",required:!0,width:t.toString(),prerequisites:[{componentCode:[o.basicInput]},{componentCode:[o.datePicker]},{componentCode:[o.dateTimePicker]}]}]},T=function(e){return{componentCode:o.basicSelect,fieldName:"componentCode",options:f,value:f[0].value,label:"Data type",required:!0,width:e.toString()}},M=[{componentCode:o.basicSelect,fieldName:"type",options:b,value:l.text,label:"Content type",required:!0,width:"2",prerequisites:[{componentCode:[o.basicInput]}]},{componentCode:o.basicSelect,fieldName:"type",options:j,value:u.date,label:"Date format",required:!0,width:"2",prerequisites:[{componentCode:[o.datePicker]}]},{componentCode:o.basicSelect,fieldName:"type",options:m,value:d.datetimeLocal,label:"Time format",required:!0,width:"2",prerequisites:[{componentCode:[o.dateTimePicker]}]}],L=[{componentCode:o.optionsMaker,fieldName:"options",type:l.text,label:"Possible values",prerequisites:[{componentCode:[o.basicSelect,o.basicRadio]}],required:!0},{componentCode:o.basicCheckbox,fieldName:"required",value:!1,label:"Required"}],B=[].concat(Object(F.a)(_(7,5)),[T(3)],M,[{componentCode:o.basicInput,fieldName:"fieldName",type:l.text,label:"Identifier",required:!0,width:"2"}],L),U=[].concat(Object(F.a)(_(8,6)),[T(4)],M,[{componentCode:o.hiddenInput,fieldName:"fieldName"}],L),V=[].concat(Object(F.a)(_(7,5)),[T(3)],M,[{componentCode:o.basicInput,fieldName:"fieldName",type:l.text,label:"Identifier",disabled:!0,required:!0,width:"2"}],L),R=[].concat(Object(F.a)(_(8,6)),[T(4)],M,[{componentCode:o.hiddenInput,fieldName:"fieldName"}],L),q=[{componentCode:o.hiddenInput,fieldName:p.id},{componentCode:o.basicInput,fieldName:"title",type:l.text,label:"Section name",required:!0},{componentCode:o.childOfSelectorForSection,fieldName:"childOf",label:"Parent sections:",options:[]}];!function(e){e[e.advanced=1]="advanced",e[e.basic=2]="basic"}(S||(S={}));var H,z=(k={},Object(i.a)(k,S.advanced,{projectInfo:{newItem:E,existingItem:D},sectionInfo:q,sectionEles:{newItem:B,existingItem:V},optionEles:{newItem:O,existingItem:g}}),Object(i.a)(k,S.basic,{projectInfo:{newItem:E,existingItem:D},sectionInfo:q,sectionEles:{newItem:U,existingItem:R},optionEles:{newItem:y,existingItem:w}}),k);!function(e){e._settings="_settings",e._sections="_sections"}(H||(H={}));var W,K,Q,J=n(4),G=n(5),Y=n(39),$=function(){function e(){Object(J.a)(this,e)}return Object(G.a)(e,null,[{key:"make",value:function(e){var t=new Date((new Date).toUTCString()).toISOString(),n=Math.floor(9e3*Math.random())+1e3,r="".concat(e).concat(t).concat(n);return Y.a.SHA256(r).toString()}},{key:"random",value:function(){var e=new Date((new Date).toUTCString()).toISOString(),t=Math.floor(9e3*Math.random())+1e3,n="".concat(e).concat(t);return Y.a.SHA256(n).toString()}}]),e}(),X=n(91),Z=n.n(X),ee={original:(W={},Object(i.a)(W,H._settings,[]),Object(i.a)(W,H._sections,[]),W),project:(K={},Object(i.a)(K,H._settings,[]),Object(i.a)(K,H._sections,[]),K),mode:S.basic},te={sidebar:"-translate-x-full"},ne=[],re={project:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case r.setCurrentProject:return t.payload;case r.resetCurrentProject:return null;default:return e}},projects:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case r.addProjectToList:return e?e.concat(t.payload):[t.payload];case r.setProjectList:return t.payload;default:return e}},sectionsForChildOfSelector:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ne,t=arguments.length>1?arguments[1]:void 0;if(t.type===r.addSectionForChildOfSelector){var n=e.concat();if(n.length){var i=n.findIndex((function(e){return e.id===t.payload.id})),a=i>=0?i:n.length;n[a]=t.payload}else n.push(t.payload);return n}return e},formElesValidState:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case r.setValidStateForEle:return Object(a.a)(Object(a.a)({},e),{},Object(i.a)({},t.payload.formEleId,t.payload.valid));case r.unsetValidStateForEle:var n=Object(a.a)({},e);return delete n[t.payload],n;default:return e}},formElement:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case r.updateFormElement:return{element:Object(a.a)({},t.payload)};case r.updateFormElementKey:return{element:Object(a.a)(Object(a.a)({},e.element),{},Object(i.a)({},t.payload.fieldName,t.payload.value))};default:return e}},formProject:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ee,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case r.setProjectEditorMode:return{original:e.original,project:e.project,mode:e.mode===S.basic?S.advanced:S.basic};case r.setFormProject:return{original:Z()(t.payload),mode:e.mode,project:Z()(t.payload)};case r.updateFormProjectSettings:return{original:e.original,mode:e.mode,project:Object(a.a)(Object(a.a)({},e.project),{},Object(i.a)({},H._settings,[Object(a.a)(Object(a.a)({},e.project[H._settings][0]),{},Object(i.a)({},t.payload.fieldName,t.payload.value))]))};case r.updateFormProjectAddSection:return{original:e.original,mode:e.mode,project:Object(a.a)(Object(a.a)({},e.project),{},Object(i.a)({},H._sections,e.project[H._sections].concat({id:$.random(),title:"",formModel:[{}]})))};case r.updateFormProjectUpdateSection:var n={original:e.original,mode:e.mode,project:Object(a.a)({},e.project)},o=n.project[H._sections][t.payload.index];return n.project[H._sections][t.payload.index]=Object(a.a)(Object(a.a)({},o),{},Object(i.a)({},t.payload.fieldName,t.payload.value)),n;case r.updateFormProjectUpdateFormModelOfSection:var c={original:e.original,mode:e.mode,project:Object(a.a)({},e.project)},s=c.project[H._sections][t.payload.indexSection].formModel[t.payload.indexFormElement],l=Object(a.a)(Object(a.a)({},s),{},Object(i.a)({},t.payload.fieldName,t.payload.value));return t.payload.identifierAutoVal&&(l.fieldName=t.payload.identifierAutoVal),c.project[H._sections][t.payload.indexSection].formModel[t.payload.indexFormElement]=l,c;case r.updateFormProjectAddFieldToSection:var u={original:e.original,mode:e.mode,project:Object(a.a)({},e.project)};return u.project[H._sections][t.payload].formModel.push({}),u;case r.updateFormProjectRemoveFieldFromSection:var d={original:e.original,mode:e.mode,project:Object(a.a)({},e.project)};return d.project[H._sections][t.payload.sectionIndex].formModel.splice(t.payload.fieldIndex,1),d;case r.updateFormProjectRemoveSection:var f={original:e.original,mode:e.mode,project:Object(a.a)({},e.project)};return f.project[H._sections].splice(t.payload,1),f;case r.updateFormProjectUpdateFormModelAddOption:var h={original:e.original,mode:e.mode,project:Object(a.a)({},e.project)},p=h.project[H._sections][t.payload.indexSection].formModel[t.payload.indexFormElement].options.length+1;return h.project[H._sections][t.payload.indexSection].formModel[t.payload.indexFormElement].options.push({label:"",value:p}),h;case r.updateFormProjectUpdateFormModelDeleteOption:var b={original:e.original,mode:e.mode,project:Object(a.a)({},e.project)};return b.project[H._sections][t.payload.indexSection].formModel[t.payload.indexFormElement].options.splice(t.payload.indexOptions,1),b;case r.updateFormProjectUpdateFormModelOptionValue:var j={original:e.original,mode:e.mode,project:Object(a.a)({},e.project)};return j.project[H._sections][t.payload.indexSection].formModel[t.payload.indexFormElement].options[t.payload.indexOptions]=t.payload.formElement,j;default:return e}},layout:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:te,t=arguments.length>1?arguments[1]:void 0;if(t.type===r.toggleSidebar){var n=Object(a.a)({},e);return n.sidebar="-translate-x-full"===n.sidebar?"":"-translate-x-full",n}return e}},ie=n(92),ae=Object(ie.a)(re),oe=Object(ie.b)(ae),ce=n(3),se=n(2),le=n.n(se),ue={system:void 0},de={name:"localSettings",fields:["data"]};!function(e){e[e.testData=1]="testData"}(Q||(Q={}));var fe,he={name:"projects",fields:["title","fileHandle","description",p.createdAt]},pe={projects:he.name,localSettings:de.name},be=[],je=[he,de],me={name:H._sections,pk:"id",fields:["title"],jsonFields:["childOf","formModel"]},ve={name:H._settings,pk:"id",fields:["title","localStorage","createdAt","description"]};!function(e){e[e.auds_settings=1]="auds_settings",e[e.auds_sections=2]="auds_sections"}(fe||(fe={}));var xe=[ve,me],Oe=p.id,ye=p.parentsInfo,ge=p.createdBy,we=function(){function e(){Object(J.a)(this,e)}return Object(G.a)(e,null,[{key:"info",value:function(t,n){var r=n?["".concat(t,": ").concat(JSON.stringify(n))]:[t];return e.doLog(r)}},{key:"list",value:function(t,n){e.isEmptyList(n)&&e.doLog([t,"none"]);var r=Array.isArray(n)?e.listFromArray(n):e.listFromObject(n);return r=r.substring(0,r.length-1),r+=".",e.doLog(["".concat(t," ").concat(r)])}},{key:"isEmptyList",value:function(e){return Array.isArray(e)&&!e.length||"object"===typeof e&&!Object.keys(e).length}},{key:"listFromArray",value:function(t){var n="";return t.forEach((function(t){n+="".concat(e.spacesForListeles).concat(e.formatValueForList(t),";")})),n}},{key:"listFromObject",value:function(t){var n="";for(var r in t)n+="".concat(e.spacesForListeles).concat(r,": ").concat(e.formatValueForList(t[r]),";");return n}},{key:"raw",value:function(t,n){return e.doLog(["".concat(t,": "),n])}},{key:"error",value:function(t,n,r){return e.doLog([t,n,r],"error")}},{key:"warn",value:function(t,n,r){return e.doLog([t,n,r],"warn")}},{key:"formatValueForList",value:function(t){return e.isPrimitiveValue(t)||null===t?t:JSON.stringify(t)}},{key:"isPrimitiveValue",value:function(e){switch(typeof e){case"string":case"number":case"boolean":case"undefined":return!0;default:return!1}}},{key:"doLog",value:function(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"log",i=(new Date).toISOString();return t[0]="[".concat(i,"] ").concat(t[0]),!0===e.debug&&(n=console)[r].apply(n,Object(F.a)(t)),t.join(". ")}}]),e}();we.debug=!0,we.spacesForListeles="\n                            - ";var ke=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Oe,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[Oe],c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Oe,s=arguments.length>7?arguments[7]:void 0,l=arguments.length>8?arguments[8]:void 0,u=arguments.length>9?arguments[9]:void 0;Object(J.a)(this,e),this.allSez=t,this.name=n,this.fields=r,this.jsonFields=i,this.pk=a,this.indexes=o,this.orderBy=c,this.childOf=s,this.parentsIdentifiers=l,this.ownerIdentifier=u,this.section=void 0}return Object(G.a)(e,[{key:"make",value:function(){return this.addPkToFields(),this.addPkToIndexes(),this.addSpecialFieldsToFields("indexes"),this.addSpecialFieldsToFields("jsonFields"),this.setOwnerIdentifier(),this.checkOrderByExists(),this.checkRelations(),this.checkParentIdentifier(),this.buildSez(),this.section}},{key:"addPkToFields",value:function(){this.fields.includes(this.pk)||this.fields.unshift(this.pk)}},{key:"addPkToIndexes",value:function(){this.indexes.includes(this.pk)||this.indexes.unshift(this.pk)}},{key:"addSpecialFieldsToFields",value:function(e){var t=this;this[e].forEach((function(e){t.fields.includes(e)||t.fields.push(e)}))}},{key:"setOwnerIdentifier",value:function(){this.ownerIdentifier||(this.ownerIdentifier=ge),this.fields.includes(this.ownerIdentifier)||this.fields.push(this.ownerIdentifier)}},{key:"checkOrderByExists",value:function(){this.fields.includes(this.orderBy)||this.fields.push(this.orderBy)}},{key:"checkRelations",value:function(){this.childOf&&this.loopAllRelations()}},{key:"loopAllRelations",value:function(){var e=this;this.childOf.forEach((function(t){return e.checkRelationsExist(t)})),this.childOf.length||(this.childOf=void 0)}},{key:"checkRelationsExist",value:function(e){if(!(this.getSezByName(e)>=0)){var t=this.childOf.indexOf(e);this.childOf.splice(t,1),we.error("Error in .childOf list","Section '".concat(e,"' does not exist in the sections list and has hence been removed from the .childOf list"))}}},{key:"getSezByName",value:function(e){for(var t=-1,n=0,r=this.allSez.length;-1===t&&n<r;)this.allSez[n].name===e&&(t=n),n++;return t}},{key:"checkParentIdentifier",value:function(){this.childOf&&!this.parentsIdentifiers&&(this.parentsIdentifiers=ye)}},{key:"buildSez",value:function(){this.section={name:this.name,pk:this.pk,indexes:this.indexes,orderBy:this.orderBy,fields:this.fields,ownerIdentifier:this.ownerIdentifier,jsonFields:this.jsonFields},this.addChildOf()}},{key:"addChildOf",value:function(){this.childOf&&(this.section.childOf=this.childOf,this.section.parentsIdentifiers=this.parentsIdentifiers)}}]),e}(),Se=function(){function e(t){Object(J.a)(this,e),this.allSez=t,this.ds={}}return Object(G.a)(e,[{key:"make",value:function(){var e=this;return this.allSez.forEach((function(t){return e.buildSez(t)})),this.ds}},{key:"buildSez",value:function(e){var t=new ke(this.allSez,e.name,e.fields,e.jsonFields,e.pk,e.indexes,e.orderBy,e.childOf,e.parentsIdentifiers,e.ownerIdentifier).make();this.addToTempDs(t)}},{key:"addToTempDs",value:function(e){this.ds[e.name]=e}}]),e}(),Ne=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];Object(J.a)(this,e),this.executers=t,this.options=n,this.allSez=r,this.addSystemSections=i,this.dbStore=void 0,this.DS={}}return Object(G.a)(e,[{key:"init",value:function(){var e=Object(ce.a)(le.a.mark((function e(){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.addSystemSections&&(this.DS=Object.assign(this.DS,new Se(xe).make())),this.allSez.length&&(this.DS=Object.assign(this.DS,new Se(this.allSez).make())),this.options.DS&&(this.DS=Object.assign(this.DS,this.options.DS)),!this.executers.dbStore){e.next=9;break}return e.next=6,new this.executers.dbStore(this.options,this.DS).initDB();case 6:this.dbStore=e.sent,e.next=10;break;case 9:throw new Error("No dbStore passed to DbConnector. To initialize DbConnector, you must pass a valid dbStore");case 10:return e.abrupt("return",this);case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"callInsertor",value:function(e,t){return new this.executers.insertor(this,e,t)}},{key:"callSelector",value:function(e,t){return new this.executers.selector(this,e,t)}},{key:"callUpdator",value:function(e,t){return new this.executers.updator(this,e,t)}},{key:"callDeletor",value:function(e,t){return new this.executers.deletor(this,e,t)}}]),e}(),Ie=function(){function e(t){Object(J.a)(this,e),this.sections=t,this.allSez=[],this.datastructure={}}return Object(G.a)(e,[{key:"extend",value:function(){var e=this;return this.sections.forEach((function(t){return e.buildSectionDefinition(t)})),this.allSez.forEach((function(t){return e.buildAndAddAllSections(t)})),this.datastructure}},{key:"buildSectionDefinition",value:function(e){var t={name:e.id,fields:Object.values(p),jsonFields:[p.parentsInfo]};e.formModel.forEach((function(e){t.fields.push(e.fieldName)})),this.allSez.push(t)}},{key:"buildAndAddAllSections",value:function(e){var t=new ke(this.allSez,e.name,e.fields).make();this.addToTempTs(t)}},{key:"addToTempTs",value:function(e){this.datastructure[e.name]=e}}]),e}(),Ce=n(150),Ee=function(){function e(t,n){Object(J.a)(this,e),this.options=t,this.DS=n,this.db=void 0,this.deletedSections=[]}return Object(G.a)(e,[{key:"initDB",value:function(){var e=Object(ce.a)(le.a.mark((function e(){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.options.indexedDbName){e.next=2;break}throw Error("No name found in DsDbInitOptions. Please provide a name for the database by setting the name on the property indexedDbName in the options passed to DbConnector.");case 2:return this.setDb(),this.options.previousVersions||(this.options.previousVersions=[]),this.handlePreviousVersion(),this.buildDb(),e.abrupt("return",this);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"postProjectCreation",value:function(){var e=Object(ce.a)(le.a.mark((function e(){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.makeDexieInfoForUpgrade());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"postProjectUpdate",value:function(){var e=Object(ce.a)(le.a.mark((function e(t){var n,r,i,a,o,c=this;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Object.keys(t).concat(t[H._sections].map((function(e){return e.id}))),r=Object.keys(this.DS),i=r.filter((function(e){return!n.includes(e)})),a=n.filter((function(e){return!r.includes(e)})),!(i.length>0||a.length>0)){e.next=13;break}return this.options.previousVersions.push(i.concat()),i.forEach((function(e){delete c.DS[e]})),a.length>0&&(o=t[H._sections].filter((function(e){return a.includes(e.id)})),Object.assign(this.DS,new Ie(o).extend())),this.close(),this.handlePreviousVersion(),this.buildDb(),e.next=13,this.db.open();case 13:return e.abrupt("return",this.makeDexieInfoForUpgrade());case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"close",value:function(){return this.db.close()}},{key:"onProjectDeleted",value:function(){return this.db.delete()}},{key:"makeDexieInfoForUpgrade",value:function(){return{dexieInfoForUpgrade:{previousVersions:this.options.previousVersions,DS:this.DS}}}},{key:"setDb",value:function(){this.db=new Ce.a(this.options.indexedDbName)}},{key:"handlePreviousVersion",value:function(){var e=this;this.deletedSections=[],this.options.previousVersions.forEach((function(t){return t.forEach((function(t){e.DS[t]||e.deletedSections.push(t)}))}))}},{key:"buildDb",value:function(){var e,t=(null===(e=this.options.previousVersions)||void 0===e?void 0:e.length)+1||1,n={};for(var r in this.DS)n[this.DS[r].name]=this.DS[r].indexes.join();return this.deletedSections.forEach((function(e){return n[e]=null})),this.db.version(t).stores(n)}}]),e}(),De=n(20),Fe=function(){function e(){Object(J.a)(this,e)}return Object(G.a)(e,null,[{key:"methodToExecute",value:function(e,t,n){var r=t.length;if(!r)return"dexieFullCollection";if(2===r&&(">="===t[0][1]||">"===t[0][1])&&("<="===t[1][1]||"<"===t[1][1]))return"dexieBetween";if("="!==t[0][1])return"complexSelect";if(1===r&&t[0][0]===e[n].pk)return"dexieGet";if(e[n].indexes.indexOf(t[0][0])>-1)return"dexieGet";var i=!0;return t.forEach((function(t){"="!==t[1]&&(i=!1),e[n].indexes.indexOf(t[0])<0&&(i=!1)})),i?"dexieWhere":"complexSelect"}},{key:"buildArrayFildsNValues",value:function(e){var t={};return e.forEach((function(e){t[e[0]]=e[2]})),t}},{key:"buildBetweenSearchParams",value:function(e){var t=">="===e[0][1],n="<="===e[1][1];return{field:e[0][0],lowerBound:e[0][2],upperBound:e[1][2],includeLower:t,includeUpper:n}}},{key:"buildFilter4Dexie",value:function(e){var t=e[0],n=e[1],r=e[2];return function(e){switch(n){case"===":return e[t]===r;case"!=":return e[t]!=r;case">":case"<":return e[t]>r;case">=":return e[t]>=r;case"<=":return e[t]<=r;default:return e[t]==r}}}},{key:"chainFilters",value:function(e,t){return function(n){if(!e.length)return!0;var r,i=e[0](n),a=Object(De.a)(e);try{for(a.s();!(r=a.n()).done;){var o=r.value;if("OR"===t)i=i||o(n);else i=i&&o(n)}}catch(c){a.e(c)}finally{a.f()}return i}}}]),e}(),Pe=function(){function e(t,n,r){Object(J.a)(this,e),this.dbConnector=t,this.section=n,this.element=r,this.logic="AND",this.table=void 0,this.collection=void 0,this.dexieFilters=[],this.arrWhere=[],this.orderBy=void 0,this.debug=!1,this.table=this.dbConnector.DS[this.section].name,this.collection=this.dbConnector.dbStore.db[this.table]}return Object(G.a)(e,[{key:"addWhere",value:function(e){return this.arrWhere.push(e),this}},{key:"setOrLogic",value:function(){return this.logic="OR",this}},{key:"setOrderBy",value:function(e){this.orderBy=e}},{key:"select",value:function(){var e=Object(ce.a)(le.a.mark((function e(){var t;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("AND"===this.logic){e.next=2;break}return e.abrupt("return",this.complexSelect());case 2:return t=Fe.methodToExecute(this.dbConnector.DS,this.arrWhere,this.section),this.handleDebug("SELECT","methodToExecute",t),e.abrupt("return",this[t]());case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"dexieGet",value:function(){var e=Object(ce.a)(le.a.mark((function e(){var t,n,r;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t={})[this.arrWhere[0][0]]=this.arrWhere[0][2],e.next=4,this.dbConnector.dbStore.db[this.table].get(t);case 4:return n=e.sent,r=n?[n]:[],e.abrupt("return",r);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"dexieWhere",value:function(){var e=Object(ce.a)(le.a.mark((function e(){var t;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Fe.buildArrayFildsNValues(this.arrWhere),e.abrupt("return",this.dbConnector.dbStore.db[this.table].where(t).toArray());case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"dexieBetween",value:function(){var e=Object(ce.a)(le.a.mark((function e(){var t;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Fe.buildBetweenSearchParams(this.arrWhere),e.abrupt("return",this.dbConnector.dbStore.db[this.table].where(t.field).between(t.lowerBound,t.upperBound,t.includeLower,t.includeUpper).toArray());case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"dexieFullCollection",value:function(){var e=Object(ce.a)(le.a.mark((function e(){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.dbConnector.dbStore.db[this.table].toArray());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"complexSelect",value:function(){var e=this;this.arrWhere.forEach((function(t){return e.dexieFilters.push(Fe.buildFilter4Dexie(t))}));var t=this.dbConnector.dbStore.db[this.table].toCollection(),n=Fe.chainFilters(this.dexieFilters,this.logic);return t=t.and(n),this.handleDebug("SELECT","WHERE",this.arrWhere),this.orderBy?t.sortBy(this.orderBy):t.toArray()}},{key:"insert",value:function(){var e=Object(ce.a)(le.a.mark((function e(){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.handleDebug("INSERT","WITH OBJECT",this.element),e.next=3,this.dbConnector.dbStore.db[this.table].put(this.element);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"update",value:function(){var e=Object(ce.a)(le.a.mark((function e(){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.handleDebug("UPDATE","WITH OBJECT",this.element),e.next=3,this.dbConnector.dbStore.db[this.table].update(this.element[this.dbConnector.DS[this.section].pk],this.element);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"count",value:function(){return this.collection.count()}},{key:"delete",value:function(){var e=Object(ce.a)(le.a.mark((function e(){var t;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Fe.buildArrayFildsNValues(this.arrWhere),this.handleDebug("DELETE","WHERE",this.arrWhere),e.next=4,this.dbConnector.dbStore.db[this.table].where(t).delete();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"clearDb",value:function(){var e=Object(ce.a)(le.a.mark((function e(){var t,n;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n in t=[],this.dbConnector.DS)this.dbConnector.DS[n].name&&t.push(this.dbConnector.dbStore.db[this.dbConnector.DS[n].name].clear());return e.next=4,Promise.all(t);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"clearTable",value:function(){var e=Object(ce.a)(le.a.mark((function e(){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.dbConnector.dbStore.db[this.table].clear();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"handleDebug",value:function(e,t,n){this.debug&&we.raw("EXECUTING ".concat(e," FOR TABLE ").concat(this.table," ").concat(t," "),n)}}]),e}(),Ae=function(){function e(t,n,r){Object(J.a)(this,e),this.dbConnector=t,this.section=n,this.args=r}return Object(G.a)(e,[{key:"autoDelete",value:function(){var e=Object(ce.a)(le.a.mark((function e(){var t;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.args[this.dbConnector.DS[this.section].pk]){e.next=6;break}return t=this.args[this.dbConnector.DS[this.section].pk],e.next=4,new Pe(this.dbConnector,this.section).addWhere([this.dbConnector.DS[this.section].pk,"=",t]).delete();case 4:e.next=7;break;case 6:we.error("Error in autoDelete","No PK value was found on the element");case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"clearSection",value:function(){var e=Object(ce.a)(le.a.mark((function e(){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Pe(this.dbConnector,this.section).clearTable();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),_e=function(){function e(t,n,r){Object(J.a)(this,e),this.dbConnector=t,this.section=n,this.element=r}return Object(G.a)(e,[{key:"autoInsert",value:function(){return this.element instanceof Array?this.insertMany():this.insertOne()}},{key:"insertMany",value:function(){var e=this.dbConnector.DS[this.section].name;return this.dbConnector.dbStore.db[e].bulkPut(this.element)}},{key:"insertOne",value:function(){return new Pe(this.dbConnector,this.section,this.element).insert().catch((function(e){we.error("Error in autoinsert: ",e)}))}}]),e}(),Te=function(){function e(t,n,r){Object(J.a)(this,e),this.dbConnector=t,this.section=n,this.args=r,this.data=[],this.qe=void 0}return Object(G.a)(e,[{key:"single",value:function(){var e=Object(ce.a)(le.a.mark((function e(){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setUpSelect(),this.setQuery(),e.next=4,this.executeSelect();case 4:return e.abrupt("return",this.data[0]);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"multiple",value:function(){var e=Object(ce.a)(le.a.mark((function e(){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setUpSelect(),this.setQuery(),this.setOrder(),e.next=5,this.executeSelect();case 5:return e.abrupt("return",this.data);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"count",value:function(){var e=Object(ce.a)(le.a.mark((function e(){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Pe(this.dbConnector,this.section).count());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setUpSelect",value:function(){this.qe=new Pe(this.dbConnector,this.section)}},{key:"setQuery",value:function(){this.args&&this.args[this.dbConnector.DS[this.section].pk]&&this.qe.addWhere([this.dbConnector.DS[this.section].pk,"=",this.args[this.dbConnector.DS[this.section].pk]])}},{key:"setOrder",value:function(){this.qe.setOrderBy(this.dbConnector.DS[this.section].orderBy)}},{key:"executeSelect",value:function(){var e=Object(ce.a)(le.a.mark((function e(){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.qe.select();case 2:this.data=e.sent;case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),Me={insertor:_e,selector:Te,updator:function(){function e(t,n,r){Object(J.a)(this,e),this.dbConnector=t,this.section=n,this.element=r}return Object(G.a)(e,[{key:"autoUpdate",value:function(){return new Pe(this.dbConnector,this.section,this.element).update().catch((function(e){we.error("Error in autoUpdate",e)}))}}]),e}(),deletor:Ae,dbStore:Ee};function Le(e){oe.dispatch(e)}var Be,Ue,Ve=function(){function e(){Object(J.a)(this,e),this.projectList=[]}return Object(G.a)(e,[{key:"load",value:function(){var e=Object(ce.a)(le.a.mark((function e(){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadFromLocalDB();case 2:this.dispatchProjectList(this.projectList);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadFromLocalDB",value:function(){var e=Object(ce.a)(le.a.mark((function e(){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ue.system.callSelector(pe.projects).multiple();case 2:this.projectList=e.sent;case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"dispatchProjectList",value:function(e){Le({type:r.setProjectList,payload:e})}}]),e}(),Re=n(1),qe=n.n(Re),He=function(){function e(){Object(J.a)(this,e),this.systemDbName="anitaDB"}return Object(G.a)(e,[{key:"init",value:function(){var e=Object(ce.a)(le.a.mark((function e(){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return we.info("Anita web app."),e.next=3,this.initSystemIndexedDb(this.systemDbName);case 3:this.setLoggerDebug(),this.loadProjectList();case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initSystemIndexedDb",value:function(){var e=Object(ce.a)(le.a.mark((function e(t){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Ne(Me,{previousVersions:be,indexedDbName:t},je,!1).init();case 2:ue.system=e.sent;case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"isReactDev",value:function(){return"_self"in qe.a.createElement("div")}},{key:"setLoggerDebug",value:function(){we.debug=this.isReactDev()}},{key:"loadProjectList",value:function(){(new Ve).load()}}]),e}();!function(e){e.add="add",e.edit="edit"}(Be||(Be={})),function(e){e.projectId="projectId",e.sectionId="sectionId",e.elementId="elementId",e.parentId="parentId"}(Ue||(Ue={}));var ze={projectsNone:"/projects/none",projectsList:"/projects/list",projectAdd:"/projects/".concat(Be.add),projectEdit:"/projects/".concat(Be.edit,"/:").concat(Ue.projectId),projectDetails:"/project/:".concat(Ue.projectId,"/info"),projectSectionElesList:"/project/:".concat(Ue.projectId,"/list/:").concat(Ue.sectionId),projectSectionAddEle:"/project/:".concat(Ue.projectId,"/:").concat(Ue.sectionId,"/").concat(Be.add),projectSectionEditEle:"/project/:".concat(Ue.projectId,"/:").concat(Ue.sectionId,"/").concat(Be.edit,"/:").concat(Ue.elementId),projectSectionEleDetails:"/project/:".concat(Ue.projectId,"/:").concat(Ue.sectionId,"/details/:").concat(Ue.elementId)};function We(){return window.showDirectoryPicker()}function Ke(e){return Qe.apply(this,arguments)}function Qe(){return(Qe=Object(ce.a)(le.a.mark((function e(t){var n;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getFile();case 2:return n=e.sent,e.abrupt("return",n.text());case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Je(e,t){return Ge.apply(this,arguments)}function Ge(){return(Ge=Object(ce.a)(le.a.mark((function e(t,n){var r,i,a;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getFileHandle(n,{create:!0});case 2:return r=e.sent,e.next=5,r.getFile();case 5:return i=e.sent,e.next=8,i.arrayBuffer();case 8:return a=e.sent,e.abrupt("return",new Uint8Array(a));case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ye(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Anita project data file",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{"application/json":[".json"]},r={types:[{name:e,description:t,accept:n}]};return window.showSaveFilePicker(r)}function $e(){return($e=Object(ce.a)(le.a.mark((function e(t,n){var r;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.createWritable();case 2:return r=e.sent,e.next=5,r.write(n);case 5:return e.next=7,r.close();case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Xe(e,t){return Ze.apply(this,arguments)}function Ze(){return(Ze=Object(ce.a)(le.a.mark((function e(t,n){var r;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={},n&&(r.writable=!0,r.mode="readwrite"),e.next=4,t.queryPermission(r);case 4:if(e.t0=e.sent,"granted"!==e.t0){e.next=7;break}return e.abrupt("return",!0);case 7:return e.next=9,t.requestPermission(r);case 9:if(e.t1=e.sent,"granted"!==e.t1){e.next=12;break}return e.abrupt("return",!0);case 12:return e.abrupt("return",!1);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var et=function(){function e(t){Object(J.a)(this,e),this.dbConnector=t,this.data=void 0}return Object(G.a)(e,[{key:"save",value:function(){var e=Object(ce.a)(le.a.mark((function e(){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setData(),e.next=3,this.saveDataToDisk();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setData",value:function(){this.data=JSON.stringify(this.dbConnector.dbStore.db)}},{key:"saveDataToDisk",value:function(){return function(e,t){return $e.apply(this,arguments)}(this.dbConnector.options.projectInfo.fileHandle,this.data)}}]),e}(),tt=function(){function e(t,n,r){Object(J.a)(this,e),this.dbConnector=t,this.section=n,this.args=r}return Object(G.a)(e,[{key:"autoDelete",value:function(){var e=Object(ce.a)(le.a.mark((function e(){var t,n=this;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object.keys(this.args).length){e.next=2;break}return e.abrupt("return","Fatal error: trying to delete without any parameter");case 2:return t=this.dbConnector.dbStore.db[this.section].findIndex((function(e){return e.id===n.args.id})),this.dbConnector.dbStore.db[this.section].splice(t,1),e.next=6,new et(this.dbConnector).save();case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"clearSection",value:function(){var e=Object(ce.a)(le.a.mark((function e(){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.dbConnector.dbStore.db[this.section].length=0,e.next=3,new et(this.dbConnector).save();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),nt=n(7),rt=n(8),it="286b88f2ceb76ce1e7d28117bb2a7659";function at(e,t){return Y.a.AES.encrypt(e,t).toString()}function ot(e,t){return Y.a.AES.decrypt(e,t).toString()}var ct=function(){function e(t,n,r){Object(J.a)(this,e),this.dbConnector=t,this.section=n,this.element=r,this.owner=void 0,this.undecryptedKey=void 0,this.keyIdentifier=void 0}return Object(G.a)(e,[{key:"getUserKey",value:function(){if(this.setOwner(),this.setUndecryptedKey(),this.undecryptedKey)return this.makeKeyIdentifier(),e.userKeys[this.keyIdentifier]||this.decryptUserKey(),this.returnUserUnencryptedKey()}},{key:"logNoKeyError",value:function(){we.error("ERROR: skipping encryption as no key was found for user ".concat(this.owner,". Did you forget to pass the user key in the options when initializing DbInit?"))}},{key:"setOwner",value:function(){this.owner=this.element[this.dbConnector.DS[this.section].ownerIdentifier]}},{key:"setUndecryptedKey",value:function(){this.undecryptedKey="object"===typeof this.dbConnector.options.encryptionKeys&&this.dbConnector.options.encryptionKeys[this.owner]?this.dbConnector.options.encryptionKeys[this.owner]:void 0}},{key:"makeKeyIdentifier",value:function(){this.keyIdentifier="".concat(this.owner).concat(this.undecryptedKey)}},{key:"decryptUserKey",value:function(){e.userKeys[this.keyIdentifier]=ot(this.undecryptedKey,it)}},{key:"returnUserUnencryptedKey",value:function(){return e.userKeys[this.keyIdentifier]}}],[{key:"decryptUserKey",value:function(e){return at(e,it)}}]),e}();ct.userKeys={};var st=function(e){Object(nt.a)(n,e);var t=Object(rt.a)(n);function n(){return Object(J.a)(this,n),t.apply(this,arguments)}return Object(G.a)(n,[{key:"do",value:function(){var e=Object(ce.a)(le.a.mark((function e(){var t,n;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==(t=this.getUserKey())){e.next=3;break}return e.abrupt("return",this.logNoKeyError());case 3:for(n in this.element)Object.values(p).includes(n)||this.encrypt(t,n);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"encrypt",value:function(e,t){this.element[t]&&(this.element[t]=at(this.element[t],e))}}]),n}(ct),lt=function(){function e(t,n,r){Object(J.a)(this,e),this.dbConnector=t,this.section=n,this.elements=r,this.index=void 0,this.element=void 0}return Object(G.a)(e,[{key:"save",value:function(){var e=Object(ce.a)(le.a.mark((function e(){var t,n,r;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.setSectionStore(),this.elements instanceof Array){t=Object(De.a)(this.elements);try{for(t.s();!(n=t.n()).done;)r=n.value,this.processElement(r)}catch(i){t.e(i)}finally{t.f()}}else this.processElement(this.elements);return e.next=4,new et(this.dbConnector).save();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setSectionStore",value:function(){this.dbConnector.dbStore.db[this.section]||(this.dbConnector.dbStore.db[this.section]=[])}},{key:"processElement",value:function(e){this.element=e,this.checkIfElementInStoreAndSetIndex(),this.addToStore()}},{key:"checkIfElementInStoreAndSetIndex",value:function(){var e=this,t=this.dbConnector.dbStore.db[this.section],n=t.findIndex((function(t){return e.element[e.dbConnector.DS[e.section].pk]===t[e.dbConnector.DS[e.section].pk]}));this.index=n>=0?n:t.length}},{key:"addToStore",value:function(){this.dbConnector.dbStore.db[this.section][this.index]=this.element}}]),e}(),ut=function(e){Object(nt.a)(n,e);var t=Object(rt.a)(n);function n(){return Object(J.a)(this,n),t.apply(this,arguments)}return Object(G.a)(n,[{key:"autoInsert",value:function(){var e=Object(ce.a)(le.a.mark((function e(){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.dbConnector.options.encrypted){e.next=3;break}return e.next=3,this.handleEncryption();case 3:return e.next=5,this.save();case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"handleEncryption",value:function(){var e=Object(ce.a)(le.a.mark((function e(){var t,n,r;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.elements instanceof Array)){e.next=20;break}t=Object(De.a)(this.elements),e.prev=2,t.s();case 4:if((n=t.n()).done){e.next=10;break}return r=n.value,e.next=8,new st(this.dbConnector,this.section,r).do();case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),t.e(e.t0);case 15:return e.prev=15,t.f(),e.finish(15);case 18:e.next=22;break;case 20:return e.next=22,new st(this.dbConnector,this.section,this.elements).do();case 22:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));return function(){return e.apply(this,arguments)}}()}]),n}(lt),dt=function(e){Object(nt.a)(n,e);var t=Object(rt.a)(n);function n(){return Object(J.a)(this,n),t.apply(this,arguments)}return Object(G.a)(n,[{key:"do",value:function(){var e=Object(ce.a)(le.a.mark((function e(){var t,n;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==(t=this.getUserKey())){e.next=3;break}return e.abrupt("return",this.logNoKeyError());case 3:for(n in this.element)Object.values(p).includes(n)||this.decrypt(t,n);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"decrypt",value:function(e,t){this.element[t]&&(this.element[t]=ot(this.element[t],e))}}]),n}(ct),ft=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object(J.a)(this,e),this.dbConnector=t,this.section=n,this.args=r,this.results=void 0}return Object(G.a)(e,[{key:"single",value:function(){var e=Object(ce.a)(le.a.mark((function e(){var t=this;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.doSelect();case 2:if(this.results.length){e.next=4;break}return e.abrupt("return");case 4:return e.abrupt("return",this.results.find((function(e){return t.filterKeys(e)})));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"filterKeys",value:function(e){for(var t=Object.keys(this.args),n=!0,r=0;n&&r<t.length;)n=e[t[r]]===this.args[t[r]],r++;return n}},{key:"multiple",value:function(){var e=Object(ce.a)(le.a.mark((function e(){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.doSelect();case 2:return e.abrupt("return",this.results);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"count",value:function(){var e=Object(ce.a)(le.a.mark((function e(){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.multiple();case 2:return e.abrupt("return",this.results.length);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"doSelect",value:function(){var e=Object(ce.a)(le.a.mark((function e(){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.results=this.dbConnector.dbStore.db[this.section]&&this.dbConnector.dbStore.db[this.section].length?this.dbConnector.dbStore.db[this.section]:[],e.next=3,this.handleDecryption();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"handleDecryption",value:function(){var e=Object(ce.a)(le.a.mark((function e(){var t;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.dbConnector.options.encrypted||!this.results.length){e.next=8;break}t=0;case 2:if(!(t<this.results.length)){e.next=8;break}return e.next=5,new dt(this.dbConnector,this.section,this.results[t]).do();case 5:t++,e.next=2;break;case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();function ht(e,t,n){return pt.apply(this,arguments)}function pt(){return(pt=Object(ce.a)(le.a.mark((function e(t,n,r){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.projectInfo.fileHandle){e.next=4;break}return e.next=3,Ye("anita-fh-".concat(t.projectInfo.id),n,r);case 3:return e.abrupt("return",e.sent);case 4:return e.next=6,Xe(t.projectInfo.fileHandle,!0);case 6:return e.abrupt("return",t.projectInfo.fileHandle);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function bt(e,t,n){return jt.apply(this,arguments)}function jt(){return(jt=Object(ce.a)(le.a.mark((function e(t,n,r){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.projectInfo.fileHandle){e.next=4;break}return e.next=3,We();case 3:return e.abrupt("return",e.sent);case 4:return e.next=6,Xe(t.projectInfo.fileHandle,!0);case 6:return e.abrupt("return",t.projectInfo.fileHandle);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var mt=function(){function e(t,n){var r;Object(J.a)(this,e),this.options=t,this.DS=n,this.db=(r={},Object(i.a)(r,H._settings,[]),Object(i.a)(r,H._sections,[]),r),this.contents=void 0}return Object(G.a)(e,[{key:"initDB",value:function(){var e=Object(ce.a)(le.a.mark((function e(){var t;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.options.projectInfo){e.next=2;break}throw new Error("No projectInfo passed to DbConnector.\nTo retrieve a project from a local file, pass the an Object of type LocalProjectSettings as value of projectInfo to the options of DbConnector");case 2:return e.next=4,ht(this.options);case 4:if(t=e.sent,!this.options.projectInfo.fileHandle){e.next=10;break}return e.next=8,this.initializeExistingProject();case 8:e.next=11;break;case 10:this.options.projectInfo.fileHandle=t;case 11:return e.abrupt("return",this);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"postProjectCreation",value:function(){var e=Object(ce.a)(le.a.mark((function e(){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.initializeExistingProject();case 2:return e.abrupt("return",{fileHandle:this.options.projectInfo.fileHandle});case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"postProjectUpdate",value:function(){var e=Object(ce.a)(le.a.mark((function e(){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{fileHandle:this.options.projectInfo.fileHandle});case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"close",value:function(){}},{key:"initializeExistingProject",value:function(){var e=Object(ce.a)(le.a.mark((function e(){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.doReadFile();case 2:this.parseFileContents(),this.makedDS();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"doReadFile",value:function(){var e=Object(ce.a)(le.a.mark((function e(){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ke(this.options.projectInfo.fileHandle);case 2:this.contents=e.sent;case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"parseFileContents",value:function(){this.db=JSON.parse(this.contents)}},{key:"makedDS",value:function(){Object.assign(this.DS,new Ie(this.db[H._sections]).extend())}}]),e}(),vt=function(e){Object(nt.a)(n,e);var t=Object(rt.a)(n);function n(){return Object(J.a)(this,n),t.apply(this,arguments)}return Object(G.a)(n,[{key:"autoUpdate",value:function(){var e=Object(ce.a)(le.a.mark((function e(){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.dbConnector.options.encrypted){e.next=3;break}return e.next=3,this.handleEncryption();case 3:return e.next=5,this.save();case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"handleEncryption",value:function(){var e=Object(ce.a)(le.a.mark((function e(){var t,n,r;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.elements instanceof Array)){e.next=20;break}t=Object(De.a)(this.elements),e.prev=2,t.s();case 4:if((n=t.n()).done){e.next=10;break}return r=n.value,e.next=8,new st(this.dbConnector,this.section,r).do();case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),t.e(e.t0);case 15:return e.prev=15,t.f(),e.finish(15);case 18:e.next=22;break;case 20:return e.next=22,new st(this.dbConnector,this.section,this.elements).do();case 22:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));return function(){return e.apply(this,arguments)}}()}]),n}(lt),xt={insertor:ut,selector:ft,updator:vt,deletor:tt,dbStore:mt},Ot=n(48),yt=n(40),gt=n.n(yt),wt=function(){function e(t,n,r){Object(J.a)(this,e),this.dbConnector=t,this.section=n,this.element=r}return Object(G.a)(e,[{key:"select",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=gt.a.select({autoQuoteTableNames:!0,autoQuoteFieldNames:!0}).from(this.dbConnector.DS[this.section].name);return e.length&&e.forEach((function(e){return t.where("".concat(e.field," ").concat(e.operator," ?"),e.value)})),t.toString()}},{key:"count",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=gt.a.select({autoQuoteTableNames:!0,autoQuoteFieldNames:!1}).field("COUNT(*) as count").from(this.dbConnector.DS[this.section].name);return e.length&&e.forEach((function(e){return t.where("".concat(e.field," ").concat(e.operator," ?"),e.value)})),t.toString()}},{key:"insert",value:function(){return this.element instanceof Array?this.insertMany():this.insertOne()}},{key:"insertOne",value:function(){var e=Object(a.a)({},this.element);for(var t in e)this.fieldsRemoverIfThereIsNoColumn(e,t);return gt.a.insert({autoQuoteTableNames:!0,autoQuoteFieldNames:!0}).into(this.dbConnector.DS[this.section].name).setFields(e).toString()}},{key:"insertMany",value:function(){var e=this,t=Object(Ot.cloneDeep)(this.element);return t.forEach((function(t){for(var n in t)e.fieldsRemoverIfThereIsNoColumn(t,n)})),gt.a.insert({autoQuoteTableNames:!0,autoQuoteFieldNames:!0}).into(this.dbConnector.DS[this.section].name).setFieldsRows(t).toString()}},{key:"update",value:function(){var e=Object(a.a)({},this.element);for(var t in e)t!==this.dbConnector.DS[this.section].pk&&this.fieldsRemoverIfThereIsNoColumn(e,t);var n=gt.a.update({autoQuoteTableNames:!0,autoQuoteFieldNames:!0}).table(this.dbConnector.DS[this.section].name).setFields(e),r=this.dbConnector.DS[this.section].pk;return n.where("".concat(r," = ?"),e[this.dbConnector.DS[this.section].pk]),n.toString()}},{key:"delete",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=gt.a.delete({autoQuoteTableNames:!0,autoQuoteFieldNames:!0}).from(this.dbConnector.DS[this.section].name);return e.length&&e.forEach((function(e){return t.where("".concat(e.field," ").concat(e.operator," ?"),e.value)})),t.toString()}},{key:"fieldsRemoverIfThereIsNoColumn",value:function(e,t){this.dbConnector.DS[this.section].fields.includes(t)||(delete e[t],we.warn("WARNING: field ".concat(t," removed because no corresponding column was found in the schema.")))}}]),e}(),kt=function(){function e(t){Object(J.a)(this,e),this.args=t,this.whereArgs=[],this.addWhereFromObj()}return Object(G.a)(e,[{key:"addWhereFromObj",value:function(){if(this.args)for(var e in this.args)this.addWhere(e,this.args[e])}},{key:"addWhere",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"=",r={field:e,operator:n,value:t};return this.whereArgs.push(r),this}}]),e}();function St(e,t){return Nt.apply(this,arguments)}function Nt(){return(Nt=Object(ce.a)(le.a.mark((function e(t,n){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.dbStore.db.run(n);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function It(e,t,n){return Ct.apply(this,arguments)}function Ct(){return(Ct=Object(ce.a)(le.a.mark((function e(t,n,r){var i,a,o;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return we.info("Exporting schema..."),i=t.export(),e.next=4,n.getFileHandle("".concat(r,".db"),{create:!0});case 4:return a=e.sent,e.next=7,a.createWritable({keepExistingData:!0});case 7:return o=e.sent,e.next=10,o.write(i);case 10:return e.next=12,o.close();case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Et=function(e){Object(nt.a)(n,e);var t=Object(rt.a)(n);function n(e,r,i){var a;return Object(J.a)(this,n),(a=t.call(this,i)).dbConnector=e,a.section=r,a}return Object(G.a)(n,[{key:"autoDelete",value:function(){var e=Object(ce.a)(le.a.mark((function e(){var t;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object.keys(this.args).length){e.next=2;break}return e.abrupt("return","Fatal error: trying to delete without any parameter");case 2:return t=new wt(this.dbConnector,this.section).delete(this.whereArgs),e.next=5,St(this.dbConnector,t);case 5:return e.next=7,It(this.dbConnector.dbStore.db,this.dbConnector.options.projectInfo.fileHandle,this.dbConnector.options.projectInfo.id);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"clearSection",value:function(){var e=Object(ce.a)(le.a.mark((function e(){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),n}(kt),Dt=function(){function e(t,n,r){Object(J.a)(this,e),this.dbConnector=t,this.section=n,this.elements=void 0,this.elements=Object(Ot.cloneDeep)(r)}return Object(G.a)(e,[{key:"autoInsert",value:function(){var e=Object(ce.a)(le.a.mark((function e(){var t,n;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.dbConnector.options.encrypted){e.next=3;break}return e.next=3,this.handleEncryption();case 3:return null!==(t=this.dbConnector.DS[this.section].jsonFields)&&void 0!==t&&t.length&&this.handleJsonFields(),n=new wt(this.dbConnector,this.section,this.elements).insert(),e.next=7,St(this.dbConnector,n);case 7:return e.next=9,It(this.dbConnector.dbStore.db,this.dbConnector.options.projectInfo.fileHandle,this.dbConnector.options.projectInfo.id);case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"handleJsonFields",value:function(){if(this.elements instanceof Array){var e,t=Object(De.a)(this.elements);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.handleJsonField(n)}}catch(r){t.e(r)}finally{t.f()}}else this.handleJsonField(this.elements)}},{key:"handleJsonField",value:function(e){var t,n=Object(De.a)(this.dbConnector.DS[this.section].jsonFields);try{for(n.s();!(t=n.n()).done;){var r=t.value;e[r]&&(e[r]=JSON.stringify(e[r]))}}catch(i){n.e(i)}finally{n.f()}}},{key:"handleEncryption",value:function(){var e=Object(ce.a)(le.a.mark((function e(){var t,n,r;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.elements instanceof Array)){e.next=20;break}t=Object(De.a)(this.elements),e.prev=2,t.s();case 4:if((n=t.n()).done){e.next=10;break}return r=n.value,e.next=8,new st(this.dbConnector,this.section,r).do();case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),t.e(e.t0);case 15:return e.prev=15,t.f(),e.finish(15);case 18:e.next=22;break;case 20:return e.next=22,new st(this.dbConnector,this.section,this.elements).do();case 22:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));return function(){return e.apply(this,arguments)}}()}]),e}();function Ft(e,t){return Pt.apply(this,arguments)}function Pt(){return(Pt=Object(ce.a)(le.a.mark((function e(t,n){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.exec(n));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function At(e,t){return t.map((function(t){var n={};return t.forEach((function(t,r){return n[e[r]]=t})),n}))}var _t=function(e){Object(nt.a)(n,e);var t=Object(rt.a)(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Object(J.a)(this,n),(i=t.call(this,a)).dbConnector=e,i.section=r,i.results=void 0,i}return Object(G.a)(n,[{key:"single",value:function(){var e=Object(ce.a)(le.a.mark((function e(){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.doSelect();case 2:if(!this.results.length){e.next=4;break}return e.abrupt("return",this.results[0]);case 4:return e.abrupt("return");case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"multiple",value:function(){var e=Object(ce.a)(le.a.mark((function e(){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.doSelect();case 2:return e.abrupt("return",this.results);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"count",value:function(){var e=Object(ce.a)(le.a.mark((function e(){var t,n;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new wt(this.dbConnector,this.section).count(this.whereArgs),e.next=3,Ft(this.dbConnector.dbStore.db,t);case 3:if((n=e.sent).length){e.next=6;break}return e.abrupt("return",0);case 6:return e.abrupt("return",n[0].values[0][0]);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"doSelect",value:function(){var e=Object(ce.a)(le.a.mark((function e(){var t,n,r;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.count(),n=new wt(this.dbConnector,this.section).select(this.whereArgs),e.next=4,Ft(this.dbConnector.dbStore.db,n);case 4:if((r=e.sent).length){e.next=8;break}return this.results=[],e.abrupt("return");case 8:if(this.results=At(r[0].columns,r[0].values),!this.dbConnector.options.encrypted){e.next=12;break}return e.next=12,this.handleDecryption();case 12:null!==(t=this.dbConnector.DS[this.section].jsonFields)&&void 0!==t&&t.length&&this.parseJsonFields();case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"parseJsonFields",value:function(){var e=this;this.results.forEach((function(t){for(var n in t)e.dbConnector.DS[e.section].jsonFields.includes(n)&&(t[n]=JSON.parse(t[n]))}))}},{key:"handleDecryption",value:function(){var e=Object(ce.a)(le.a.mark((function e(){var t;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.dbConnector.options.encrypted||!this.results.length){e.next=8;break}t=0;case 2:if(!(t<this.results.length)){e.next=8;break}return e.next=5,new dt(this.dbConnector,this.section,this.results[t]).do();case 5:t++,e.next=2;break;case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(kt),Tt=function(){function e(t,n){Object(J.a)(this,e),this.dbStore=t,this.DS=n,this.sql=""}return Object(G.a)(e,[{key:"createSchema",value:function(){var e=Object(ce.a)(le.a.mark((function e(){var t;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t in this.DS)this.handleTable(this.DS[t].name,this.DS[t].fields);return e.next=3,this.dbStore.db.run(this.sql);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"handleTable",value:function(e,t){this.sql+="DROP TABLE IF EXISTS '".concat(e,"'; CREATE TABLE '").concat(e,"' (").concat(this.createFields(t),");")}},{key:"createFields",value:function(e){var t,n="",r=Object(De.a)(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;n+="".concat(i," TEXT,")}}catch(a){r.e(a)}finally{r.f()}return n.substring(0,n.length-1)}}]),e}(),Mt=n(151),Lt=n.n(Mt),Bt=function(){function e(t,n){Object(J.a)(this,e),this.options=t,this.DS=n,this.db=void 0,this.contents=void 0}return Object(G.a)(e,[{key:"initDB",value:function(){var e=Object(ce.a)(le.a.mark((function e(){var t;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.options.projectInfo){e.next=2;break}throw new Error("No projectInfo passed to DbConnector.\nTo retrieve a project from a local file, pass the an Object of type LocalProjectSettings as value of projectInfo to the options of DbConnector");case 2:return e.next=4,bt(this.options,"SQLite Project Database",{"application/x-sqlite3":[".db"]});case 4:if(t=e.sent,!this.options.projectInfo.fileHandle){e.next=10;break}return e.next=8,this.initializeExistingProject();case 8:e.next=12;break;case 10:return e.next=12,this.onProjectCreation(t);case 12:return e.abrupt("return",this);case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"postProjectCreation",value:function(){var e=Object(ce.a)(le.a.mark((function e(){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.makeDSFromDB();case 2:return e.abrupt("return",{fileHandle:this.options.projectInfo.fileHandle});case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"postProjectUpdate",value:function(){var e=Object(ce.a)(le.a.mark((function e(){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{fileHandle:this.options.projectInfo.fileHandle});case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"close",value:function(){}},{key:"initializeExistingProject",value:function(){var e=Object(ce.a)(le.a.mark((function e(){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.doReadFile();case 2:return e.next=4,this.loadDB(this.contents);case 4:return e.next=6,this.makeDSFromDB();case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onProjectCreation",value:function(){var e=Object(ce.a)(le.a.mark((function e(t){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Object.assign(this.options.projectInfo,{fileHandle:t}),e.next=3,this.loadDB();case 3:return e.next=5,new Tt(this,this.DS).createSchema();case 5:return e.next=7,It(this.db,this.options.projectInfo.fileHandle,this.options.projectInfo.id);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"doReadFile",value:function(){var e=Object(ce.a)(le.a.mark((function e(){var t;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat(this.options.projectInfo.id,".db"),e.next=3,Je(this.options.projectInfo.fileHandle,t);case 3:this.contents=e.sent;case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"makeDSFromDB",value:function(){var e=Object(ce.a)(le.a.mark((function e(){var t,n;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ft(this.db,"SELECT * FROM _sections");case 2:t=e.sent,(n=At(t[0].columns,t[0].values)).forEach((function(e){me.jsonFields.forEach((function(t){e[t]=JSON.parse(e[t])}))})),Object.assign(this.DS,new Ie(n).extend());case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadDB",value:function(){var e=Object(ce.a)(le.a.mark((function e(t){var n;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Lt()({locateFile:function(){return"".concat("/app","/assets/sql-wasm.wasm")}});case 2:n=e.sent,this.db=new n.Database(t);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),Ut=function(){function e(t,n,r){Object(J.a)(this,e),this.dbConnector=t,this.section=n,this.elements=r}return Object(G.a)(e,[{key:"autoUpdate",value:function(){var e=Object(ce.a)(le.a.mark((function e(){var t,n,r,i;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.dbConnector.options.encrypted){e.next=3;break}return e.next=3,this.handleEncryption();case 3:if(t=[],this.elements instanceof Array){n=Object(De.a)(this.elements);try{for(n.s();!(r=n.n()).done;)i=r.value,t.push(this.buildQuery(i))}catch(a){n.e(a)}finally{n.f()}}else t.push(this.buildQuery(this.elements));return St(this.dbConnector,t.join(";")),e.next=8,It(this.dbConnector.dbStore.db,this.dbConnector.options.projectInfo.fileHandle,this.dbConnector.options.projectInfo.id);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"buildQuery",value:function(e){var t,n=Object(a.a)({},e);if(null!==(t=this.dbConnector.DS[this.section].jsonFields)&&void 0!==t&&t.length){var r,i=Object(De.a)(this.dbConnector.DS[this.section].jsonFields);try{for(i.s();!(r=i.n()).done;){var o=r.value;n[o]=JSON.stringify(n[o])}}catch(c){i.e(c)}finally{i.f()}}return new wt(this.dbConnector,this.section,n).update()}},{key:"handleEncryption",value:function(){var e=Object(ce.a)(le.a.mark((function e(){var t,n,r;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.elements=Object(Ot.cloneDeep)(this.elements),!(this.elements instanceof Array)){e.next=21;break}t=Object(De.a)(this.elements),e.prev=3,t.s();case 5:if((n=t.n()).done){e.next=11;break}return r=n.value,e.next=9,new st(this.dbConnector,this.section,r).do();case 9:e.next=5;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),t.e(e.t0);case 16:return e.prev=16,t.f(),e.finish(16);case 19:e.next=23;break;case 21:return e.next=23,new st(this.dbConnector,this.section,this.elements).do();case 23:case"end":return e.stop()}}),e,this,[[3,13,16,19]])})));return function(){return e.apply(this,arguments)}}()}]),e}(),Vt={insertor:Dt,selector:_t,updator:Ut,deletor:Et,dbStore:Bt},Rt=function(){function e(t,n,r){Object(J.a)(this,e),this.projectInfo=t,this.projectSections=n,this.fileHandle=r,this.projectId=void 0,this.projectId=t.id}return Object(G.a)(e,[{key:"init",value:function(){var e=Object(ce.a)(le.a.mark((function e(){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.projectInfo.localStorage!=h.fileSystem){e.next=5;break}return e.next=3,this.doFileSystem();case 3:case 8:e.next=12;break;case 5:if(this.projectInfo.localStorage!=h.SQLite){e.next=10;break}return e.next=8,this.doSQLite();case 10:return e.next=12,this.doIndexedDb();case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"doFileSystem",value:function(){var e=Object(ce.a)(le.a.mark((function e(){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.fileHandle&&(this.projectInfo=Object(a.a)(Object(a.a)({},this.projectInfo),{},{fileHandle:this.fileHandle})),e.next=3,new Ne(xt,{projectInfo:this.projectInfo}).init();case 3:ue[this.projectId]=e.sent;case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"doSQLite",value:function(){var e=Object(ce.a)(le.a.mark((function e(){var t,n;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.fileHandle&&(this.projectInfo=Object(a.a)(Object(a.a)({},this.projectInfo),{},{fileHandle:this.fileHandle})),this.projectSections&&(n=new Ie(this.projectSections)).extend(),e.next=4,new Ne(Vt,{projectInfo:this.projectInfo},null===(t=n)||void 0===t?void 0:t.allSez).init();case 4:ue[this.projectId]=e.sent;case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"doIndexedDb",value:function(){var e=Object(ce.a)(le.a.mark((function e(){var t;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.projectSections){e.next=8;break}return(t=new Ie(this.projectSections)).extend(),e.next=5,new Ne(Me,{previousVersions:[],indexedDbName:this.projectId},t.allSez).init();case 5:ue[this.projectId]=e.sent,e.next=12;break;case 8:if(!this.projectInfo.dexieInfoForUpgrade){e.next=12;break}return e.next=11,new Ne(Me,{previousVersions:this.projectInfo.dexieInfoForUpgrade.previousVersions,DS:this.projectInfo.dexieInfoForUpgrade.DS,indexedDbName:this.projectId}).init();case 11:ue[this.projectId]=e.sent;case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),qt=function(){function e(t,n){Object(J.a)(this,e),this.projectSettings=t,this.sectionsDefinitions=n}return Object(G.a)(e,[{key:"set",value:function(){var e;Le({type:r.setCurrentProject,payload:(e={},Object(i.a)(e,H._settings,this.projectSettings.concat()),Object(i.a)(e,H._sections,this.sectionsDefinitions.concat()),e)})}}]),e}(),Ht=function(){function e(t,n){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];Object(J.a)(this,e),this.projectId=t,this.projectInfo=n,this.setProject=r,this.projectSettings=void 0,this.projectSections=void 0}return Object(G.a)(e,[{key:"loadProject",value:function(){var e=Object(ce.a)(le.a.mark((function e(){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.projectInfo){e.next=3;break}return e.next=3,this.setProjectInfoFromIndexedDB();case 3:return e.next=5,this.createNewInstanceOfDbConnectorForrProject();case 5:return e.next=7,this.loadProjectSettings();case 7:return e.next=9,this.loadProjectSections();case 9:this.setProject&&this.callCurrentProjectSetter();case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setProjectInfoFromIndexedDB",value:function(){var e=Object(ce.a)(le.a.mark((function e(){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ue.system.callSelector(pe.projects,{id:this.projectId}).single();case 2:this.projectInfo=e.sent;case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"createNewInstanceOfDbConnectorForrProject",value:function(){var e=Object(ce.a)(le.a.mark((function e(){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Rt(this.projectInfo).init();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadProjectSettings",value:function(){var e=Object(ce.a)(le.a.mark((function e(){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ue[this.projectId].callSelector(H._settings).multiple();case 2:this.projectSettings=e.sent;case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadProjectSections",value:function(){var e=Object(ce.a)(le.a.mark((function e(){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ue[this.projectId].callSelector(H._sections).multiple();case 2:this.projectSections=e.sent;case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"callCurrentProjectSetter",value:function(){new qt(this.projectSettings,this.projectSections).set()}}]),e}();function zt(e){return Wt.apply(this,arguments)}function Wt(){return Wt=Object(ce.a)(le.a.mark((function e(t){var n,r,i,a=arguments;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=!(a.length>1&&void 0!==a[1])||a[1],"function"!==typeof(null===ue||void 0===ue||null===(n=ue[t])||void 0===n?void 0:n.callSelector)){e.next=3;break}return e.abrupt("return",!0);case 3:return e.next=5,ue.system.callSelector(pe.projects,{id:t}).single();case 5:if((i=e.sent).localStorage!=h.IndexedDB){e.next=10;break}return e.next=9,new Ht(t,i,r).loadProject();case 9:return e.abrupt("return",!0);case 10:return e.abrupt("return",!1);case 11:case"end":return e.stop()}}),e)}))),Wt.apply(this,arguments)}var Kt=function(){function e(t,n){Object(J.a)(this,e),this.childOf=t,this.sections=n,this.parentInfoFormModel=void 0,this.options=[]}return Object(G.a)(e,[{key:"build",value:function(){return this.setOptions(),this.setParentSelector(),this.parentInfoFormModel}},{key:"setOptions",value:function(){var e=this;this.childOf.forEach((function(t){var n=e.sections.find((function(e){return e.id===t}));e.options.push({value:t,label:n.title})}))}},{key:"setParentSelector",value:function(){this.parentInfoFormModel={componentCode:o.parentsSelector,fieldName:p.parentsInfo,label:"Parent elements",options:this.options}}}]),e}();function Qt(e,t){return e.find((function(e){return e.id===t}))}var Jt,Gt=n(0),Yt=function(e){var t=e.children,n=e.width;return Object(Gt.jsx)("div",{className:"".concat(n," my-3 px-2 inline-block align-top"),children:t})},$t=function(e){var t=e.label;return Object(Gt.jsx)("label",{className:"w-full block mb-0 ml-1 text-gray-700 text-sm",children:t})};!function(e){e[e.required=1]="required",e[e.emailFormat=2]="emailFormat",e[e.telephoneNumber=3]="telephoneNumber",e[e.urlFormat=4]="urlFormat"}(Jt||(Jt={}));var Xt=Object(Re.memo)((function(e){var t=e.formEle,n=e.element,r=e.updateValidatorState,i=n[t.fieldName],a=/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(i);return Object(Re.useEffect)((function(){r(Jt.emailFormat,a)}),[i]),a||!i?null:Object(Gt.jsx)("div",{className:"ml-1 text-red-600 text-xs italic  d-block-inline",children:"Invalid Email"})}),(function(e,t){return e.element[e.formEle.fieldName]===t.element[t.formEle.fieldName]&&e.touched===t.touched})),Zt=Object(Re.memo)((function(e){var t=e.formEle,n=e.element,r=e.touched,i=e.updateValidatorState,a=n[t.fieldName];return Object(Re.useEffect)((function(){i(Jt.required,""!==a&&void 0!==a&&null!==a)}),[a]),a||!r?Object(Gt.jsx)("div",{className:"ml-1 text-xs italic text-gray-400 d-block-inline",children:"Required"}):Object(Gt.jsx)("div",{className:"ml-1 text-red-600 text-xs italic",children:"This field is required"})}),(function(e,t){return e.element[e.formEle.fieldName]===t.element[t.formEle.fieldName]&&e.touched===t.touched})),en=Object(Re.memo)((function(e){var t=e.formEle,n=e.element,r=e.updateValidatorState,i=n[t.fieldName],a=/^\+?\(?([0-9]{3})\)?[-. ]?([0-9]{3})[-. ]?([0-9]{4,})$/.test(i);return Object(Re.useEffect)((function(){r(Jt.telephoneNumber,a)}),[i]),a||!i?null:Object(Gt.jsx)("div",{className:"ml-1 text-red-600 text-xs italic  d-block-inline",children:"Invalid telephone number"})}),(function(e,t){return e.element[e.formEle.fieldName]===t.element[t.formEle.fieldName]&&e.touched===t.touched})),tn=Object(Re.memo)((function(e){var t=e.formEle,n=e.element,r=e.updateValidatorState,i=n[t.fieldName],a=/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:[/?#]\S*)?$/i.test(i);return Object(Re.useEffect)((function(){r(Jt.urlFormat,a)}),[i]),a||!i?null:Object(Gt.jsx)("div",{className:"ml-1 text-red-600 text-xs italic  d-block-inline",children:"Invalid address (must start with 'http://' or 'https://')"})}),(function(e,t){return e.element[e.formEle.fieldName]===t.element[t.formEle.fieldName]&&e.touched===t.touched})),nn=Object(Re.memo)((function(e){var t,n,r,o=[],c=Object(Re.useState)({})[1],s=function(t,n){c((function(r){if(r[t]===n)return r;var o=Object(a.a)(Object(a.a)({},r),{},Object(i.a)({},t,n)),c=Object.keys(o).every((function(e){return o[e]}));return e.setIsValidForField(c),o}))};return e.formEle.required&&o.push(Object(Gt.jsx)(Zt,Object(a.a)({updateValidatorState:s},e),"required-validator")),(null===(t=e.formEle)||void 0===t?void 0:t.type)===l.email&&o.push(Object(Gt.jsx)(Xt,Object(a.a)({updateValidatorState:s},e),"email-validator")),(null===(n=e.formEle)||void 0===n?void 0:n.type)===l.tel&&o.push(Object(Gt.jsx)(en,Object(a.a)({updateValidatorState:s},e),"telephone-validator")),(null===(r=e.formEle)||void 0===r?void 0:r.type)===l.url&&o.push(Object(Gt.jsx)(tn,Object(a.a)({updateValidatorState:s},e),"url-validator")),Object(Gt.jsx)("div",{className:"flex",children:o})}),(function(e,t){return e.element[e.formEle.fieldName]===t.element[t.formEle.fieldName]&&e.touched===t.touched})),rn=function(e){var t=Object(Re.useState)(!0),n=Object(P.a)(t,2),i=n[0],a=n[1];Object(Re.useEffect)((function(){return function(){Le({type:r.unsetValidStateForEle,payload:e})}}),[e]);return[i,function(t){a(t),Le({type:r.setValidStateForEle,payload:{formEleId:e,valid:t}})}]},an=n(23),on=n.n(an),cn=Object(Re.memo)((function(e){var t=e.formEle,n=e.element,r=e.handleChange,i=Object(Re.useState)(!1),a=Object(P.a)(i,2),o=a[0],c=a[1],s=Object(Re.useRef)(on()(t.fieldName)).current,l=rn(s),u=Object(P.a)(l,2),d=u[0],f=u[1],h=t.width?t.width:"w-full";return Object(Gt.jsxs)(Yt,{width:h,children:[Object(Gt.jsx)($t,{label:t.label}),Object(Gt.jsx)("input",{name:t.fieldName,type:"checkbox",checked:!(!Reflect.has(n,t.fieldName)||"boolean"!==typeof n[t.fieldName])&&n[t.fieldName],className:"rounded mt-3 ".concat(!d&&o?"text-red-600 border border-red-600":"text-prussian-blue-500"),onChange:function(e){return r(t.fieldName,e.target.checked)},onBlur:function(){return c(!0)}},t.fieldName),Object(Gt.jsx)(nn,{formEle:t,element:n,fieldId:s,touched:o,setIsValidForField:f})]})}),(function(e,t){return e.element[e.formEle.fieldName]===t.element[t.formEle.fieldName]}));function sn(e){switch(e){case"1":return"w-full lg:w-1/12";case"2":return"w-full lg:w-2/12";case"3":return"w-full lg:w-3/12";case"4":return"w-full lg:w-4/12";case"5":return"w-full lg:w-5/12";case"6":return"w-full lg:w-6/12";case"7":return"w-full lg:w-7/12";case"8":return"w-full lg:w-8/12";case"9":return"w-full lg:w-9/12";case"10":return"w-full lg:w-10/12";case"11":return"w-full lg:w-11/12";case"12":return"w-full lg:w-12/12";default:return"w-full"}}var ln="rounded-md border border-gray-300 hover:border-gray-400 focus:border-prussian-blue-500 focus:ring-0",un="rounded-md border-2 border-red-300 hover:border-red-400 focus:border-red-200 focus:ring-0",dn=Object(Re.memo)((function(e){var t=e.formEle,n=e.element,r=e.handleChange,i=Object(Re.useState)(!1),a=Object(P.a)(i,2),o=a[0],c=a[1],s=Object(Re.useRef)(on()(t.fieldName)).current,l=rn(s),u=Object(P.a)(l,2),d=u[0],f=u[1],h=t.width?sn(t.width):"w-full";return void 0!==n[t.fieldName]&&null!==n[t.fieldName]||(n[t.fieldName]=""),Object(Gt.jsxs)(Yt,{width:h,children:[Object(Gt.jsx)($t,{label:t.label}),Object(Gt.jsx)("input",{name:t.fieldName,type:(null===t||void 0===t?void 0:t.type)||"text",placeholder:t.label,disabled:!!t.disabled&&t.disabled,required:!!t.required&&t.required,className:"w-full ".concat(!d&&o?un:ln),value:n[t.fieldName],onChange:function(e){return r(t.fieldName,e.target.value)},onBlur:function(){return c(!0)}},t.fieldName),Object(Gt.jsx)(nn,{formEle:t,element:n,fieldId:s,touched:o,setIsValidForField:f})]})}),(function(e,t){return e.element[e.formEle.fieldName]===t.element[t.formEle.fieldName]})),fn=n(27),hn=Object(Re.memo)((function(e){var t=e.formEle,n=e.element,r=e.handleChange,i=Object(Re.useState)(!1),a=Object(P.a)(i,2),o=a[0],c=a[1],s=Object(Re.useRef)(on()(t.fieldName)).current,l=rn(s),u=Object(P.a)(l,2),d=u[0],f=u[1],h=t.width?t.width:"w-full";return!n[t.fieldName]&&t.value&&(n[t.fieldName]=t.value),Object(Gt.jsxs)(Yt,{width:h,children:[Object(Gt.jsx)($t,{label:t.label}),Object(Gt.jsx)("div",{className:"mt-2 pl-1",children:t.options.map((function(e,i){return Object(Gt.jsxs)("div",{className:"mb-2",children:[Object(Gt.jsx)("input",{type:"radio",value:e.value,name:t.fieldName,checked:n[t.fieldName]==e.value,disabled:!(!e.disabled&&!t.disabled),className:"".concat(!d&&o?"bg-red-600 text-red-600":"bg-gray-200 text-prussian-blue-500"," mr-2 border-transparent focus:border-gray-500 focus:text-prussian-blue-600 focus:ring-prussian-blue-600"),onChange:function(e){return r(t.fieldName,e.target.value)},onBlur:function(){return c(!0)}}),Object(Gt.jsx)("span",{className:e.disabled||t.disabled?"text-gray-300 cursor-not-allowed":"",children:e.label}),e.hint&&Object(Gt.jsxs)("span",{children:[Object(Gt.jsx)("sup",{children:Object(Gt.jsx)("i",{className:"ml-1 text-xs bi-info-circle","data-tip":!0,"data-for":"".concat(s).concat(i)})}),Object(Gt.jsx)(fn.a,{id:"".concat(s).concat(i),effect:"solid","data-multiline":!0,className:"msg-wrapper text-center",children:Object(Gt.jsx)("span",{children:e.hint})})]})]},e.value)}))}),Object(Gt.jsx)(nn,{formEle:t,element:n,fieldId:s,touched:o,setIsValidForField:f})]},t.fieldName)}),(function(e,t){return e.element[e.formEle.fieldName]==t.element[t.formEle.fieldName]})),pn=Object(Re.memo)((function(e){var t,n,r,i,a=e.formEle,o=e.element,c=e.handleChange,s=Object(Re.useState)(!1),l=Object(P.a)(s,2),u=l[0],d=l[1],f=Object(Re.useRef)(on()(a.fieldName)).current,h=rn(f),p=Object(P.a)(h,2),b=p[0],j=p[1],m=a.width?sn(a.width):"w-full",v=o[a.fieldName]&&a.options.some((function(e){return e.value==o[a.fieldName]}))?o[a.fieldName]:null;return t=v,n=a.value,r=a.fieldName,i=c,Object(Re.useEffect)((function(){!t&&n&&i(r,n)}),[t,n,r]),Object(Gt.jsxs)(Yt,{width:m,children:[Object(Gt.jsx)($t,{label:a.label}),Object(Gt.jsxs)("select",{className:"w-full ".concat(!b&&u?un:ln),value:o[a.fieldName],onChange:function(e){return c(a.fieldName,e.target.value)},onBlur:function(){return d(!0)},children:[!a.value&&Object(Gt.jsx)("option",{value:"",children:"Chose one"}),a.options.map((function(e,t){return Object(Gt.jsx)("option",{value:e.value,children:e.label},"".concat(e.value,"-").concat(t))}))]}),(!a.value||o[a.fieldName])&&Object(Gt.jsx)(nn,{formEle:a,element:o,fieldId:f,touched:u,setIsValidForField:j})]})}),(function(e,t){var n,r,i,a=!0;null!==(n=e.formEle)&&void 0!==n&&null!==(r=n.prerequisites)&&void 0!==r&&r.length&&(null===(i=e.formEle)||void 0===i?void 0:i.prerequisites.map((function(e){return Object.keys(e)})).flat().filter((function(e,t,n){return n.indexOf(e)===t}))).forEach((function(n){e.element[n]!==t.element[n]&&(a=!1)}));return e.element[e.formEle.fieldName]===t.element[t.formEle.fieldName]&&a})),bn=Object(Re.memo)((function(e){var t=e.formEle,n=e.element,r=e.handleChange,i=Object(Re.useState)(!1),a=Object(P.a)(i,2),o=a[0],c=a[1],s=Object(Re.useRef)(on()(t.fieldName)).current,l=rn(s),u=Object(P.a)(l,2),d=u[0],f=u[1],h=t.width?t.width:"w-full";return void 0!==n[t.fieldName]&&null!==n[t.fieldName]||(n[t.fieldName]=""),Object(Gt.jsxs)(Yt,{width:h,children:[Object(Gt.jsx)($t,{label:t.label}),Object(Gt.jsx)("textarea",{name:t.fieldName,className:"w-full ".concat(!d&&o?un:ln),value:n[t.fieldName],onChange:function(e){return r(t.fieldName,e.target.value)},onBlur:function(){return c(!0)}}),Object(Gt.jsx)(nn,{formEle:t,element:n,fieldId:s,touched:o,setIsValidForField:f})]})}),(function(e,t){return e.element[e.formEle.fieldName]===t.element[t.formEle.fieldName]}));function jn(e){var t=[];return e.forEach((function(e){t.push(e.value)})),t}function mn(e,t){var n=[];return e&&t?(e.forEach((function(e){var r=t.find((function(t){return t.options.find((function(t){return t.value===e}))}));if(r){var i=r.options.find((function(t){return t.value===e}));i&&n.push(i)}})),n):n}function vn(e,t){var n=[];return e&&t?(e.forEach((function(e){var r=t.find((function(t){return t.value===e}));r&&n.push(r)})),n):n}var xn=n(14),On=n(64),yn=Object(Re.memo)((function(e){var t=e.formEle,n=e.element,r=e.handleChange,i=e.sectionId,a=Object(xn.b)((function(e){return e.formProject.project[H._sections]})),o=Object(Re.useState)([]),c=Object(P.a)(o,2),s=c[0],l=c[1],u=Object(Re.useState)(!1),d=Object(P.a)(u,2),f=d[0],h=d[1],p=Object(Re.useRef)(on()(t.fieldName)).current,b=rn(p),j=Object(P.a)(b,2),m=j[0],v=j[1];Object(Re.useEffect)((function(){var e=!0;return e&&function(){if(Array.isArray(a)){var e=[];a.forEach((function(t){t.id!==i&&e.push({value:t.id,label:t.title})})),l(e)}}(),function(){e=!1}}),[a,a.length,i]);return 0===s.length?null:Object(Gt.jsxs)(Yt,{width:"w-full",children:[Object(Gt.jsx)($t,{label:t.label}),Object(Gt.jsx)(On.a,{defaultValue:vn(n[t.fieldName],s),isMulti:!0,name:t.fieldName,options:s,className:!m&&f?"border border-red-600 rounded":"",onChange:function(e){r(t.fieldName,jn(e))},onBlur:function(){return h(!0)}}),Object(Gt.jsx)(nn,{formEle:t,element:n,fieldId:p,touched:f,setIsValidForField:v})]})}),(function(e,t){return e.element[e.formEle.fieldName]===t.element[t.formEle.fieldName]})),gn=Object(Re.memo)((function(e){var t=e.formEle,n=e.element,r=e.handleChange;return void 0!==n[t.fieldName]&&null!==n[t.fieldName]||(n[t.fieldName]=""),Object(Gt.jsx)("input",{name:t.fieldName,type:"hidden",value:n[t.fieldName],onChange:function(e){return r(t.fieldName,e.target.value)}},t.fieldName)}),(function(e,t){return e.element[e.formEle.fieldName]===t.element[t.formEle.fieldName]})),wn="bg-transparent hover:".concat("bg-green-500"," ").concat("text-green-700"," font-semibold hover:text-white border ").concat("border-green-500"," hover:border-transparent rounded"),kn="bg-transparent hover:".concat("bg-red-500"," ").concat("text-red-700"," font-semibold hover:text-white border ").concat("border-red-500"," hover:border-transparent rounded");var Sn=Object(Re.memo)((function(e){var t=e.formEle,n=e.element,r=e.handleOptionsChange,i=e.handleClickDeleteOption,a=e.indexSection,o=e.indexFormElement,c=e.index,s=e.optionElement,l=Object(xn.b)((function(e){return e.formProject.mode})),u=Object(xn.b)((function(e){return e.formProject.original[H._sections][a]})),d=Object(Re.useMemo)((function(){!function(e,t,n){!(e&&e.formModel[t]&&e.formModel[t].options&&e.formModel[t].options.length)||e.formModel[t].options.some((function(e){return e.value===n}))}(u,o,s.value);return z[l].optionEles.newItem}),[u,o,s.value,l]);return Object(Gt.jsxs)("li",{children:[Object(Gt.jsx)(Tn,{formModel:d,element:s,handleChange:r.bind(void 0,c,s)}),"function"===typeof i&&n[t.fieldName].length>2&&Object(Gt.jsxs)("div",{className:"inline-block w-full lg:w-1/12 px-2 lg:pl-1 lg:pr-3 lg:align-bottom mb-8",children:[Object(Gt.jsxs)("button",{onClick:i.bind(void 0,c),"data-tip":!0,"data-for":"deleteOption-".concat(c),className:"w-full py-1 ".concat(kn),children:[Object(Gt.jsx)("i",{className:"bi-trash hidden lg:block"}),Object(Gt.jsxs)("span",{className:"lg:hidden",children:["Delete option ",c+1]})]}),Object(Gt.jsx)(fn.a,{id:"deleteOption-".concat(c),effect:"solid",children:Object(Gt.jsxs)("span",{children:["Delete option ",c+1]})})]})]})})),Nn=Object(Re.memo)((function(e){var t=e.formEle,n=e.element,r=e.handleOptionsChange,i=e.handleClickAddOption;return"function"!==typeof r?null:(n[t.fieldName]&&Array.isArray(n[t.fieldName])&&n[t.fieldName].length||(n[t.fieldName]=Array.from(Array(2),(function(e,t){return{label:"",value:t+1}}))),Object(Gt.jsxs)("div",{className:"mt-6 pl-10 py-4 bg-gray-50 rounded-lg",children:[Object(Gt.jsx)("p",{className:"-ml-5 font-semibold mb-1",children:"Choices"}),Object(Gt.jsx)("ol",{className:"list-decimal",children:n[t.fieldName].map((function(t,n){return Object(Gt.jsx)(Sn,Object(a.a)({index:n,optionElement:t},e),"".concat(t.value,"-").concat(n))}))}),"function"===typeof i&&Object(Gt.jsx)("div",{className:"flex items-end",children:Object(Gt.jsx)("button",{className:"ml-auto mr-4 mt-3 py-2 px-3 ".concat(wn),onClick:i,children:"Add option"})})]}))}));function In(e){var t=void 0;return e.some((function(e,n){return!p[e.fieldName]&&(t=n,!0)})),t}function Cn(e){var t=e.toLowerCase(),n={a:"[\xe0\xe1\xe2\xe3\xe4\xe5]",ae:"\xe6",c:"\xe7",e:"[\xe8\xe9\xea\xeb]",i:"[\xec\xed\xee\xef]",n:"\xf1",o:"[\xf2\xf3\xf4\xf5\xf6]",oe:"\u0153",u:"[\xf9\xfa\xfb\u0171\xfc]",y:"[\xfd\xff]"};for(var r in n)t=t.replace(new RegExp(n[r],"g"),r);return t.replace(/\s/g,"-").replace(/[^\w-]/gi,"")}function En(e,t){return Dn.apply(this,arguments)}function Dn(){return(Dn=Object(ce.a)(le.a.mark((function e(t,n){var r,i;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.length,i=0;case 2:if(!(i<r)){e.next=8;break}return e.next=5,n(t[i],i,t);case 5:i++,e.next=2;break;case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Fn=function(){function e(t,n){Object(J.a)(this,e),this.project=t,this.options=n,this.optionsGroups=[]}return Object(G.a)(e,[{key:"buildOptions",value:function(){var e=Object(ce.a)(le.a.mark((function e(){var t=this;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,En(this.options,function(){var e=Object(ce.a)(le.a.mark((function e(n){var r;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ue[t.project[H._settings][0].id].callSelector(n.value).multiple();case 2:(r=e.sent).length&&t.createGroupOption(n.value,n.label,r);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:return e.abrupt("return",this.optionsGroups);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"createGroupOption",value:function(e,t,n){var r=[],i=Qt(this.project[H._sections],e),a=In(i.formModel);n.forEach((function(t){return r.push({value:"".concat(e,"|").concat(t.id),label:t[i.formModel[a].fieldName]})})),this.optionsGroups.push({label:t,options:r})}}]),e}(),Pn=Object(Re.memo)((function(e){var t=e.formEle,n=e.element,r=e.handleChange,i=Object(Re.useState)([]),a=Object(P.a)(i,2),o=a[0],c=a[1],s=Object(xn.b)((function(e){return e.project})),l=Object(Re.useState)(!1),u=Object(P.a)(l,2),d=u[0],f=u[1],h=Object(Re.useRef)(on()(t.fieldName)).current,p=rn(h),b=Object(P.a)(p,2),j=b[0],m=b[1];Object(Re.useEffect)((function(){var e=!0,n=function(){var n=Object(ce.a)(le.a.mark((function n(){var r;return le.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,new Fn(s,t.options).buildOptions();case 2:r=n.sent,e&&c(r);case 4:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();return e&&n(),function(){e=!1}}),[s,t.options]);return 0===o.length?null:Object(Gt.jsxs)(Yt,{width:"w-full",children:[Object(Gt.jsx)($t,{label:t.label}),Object(Gt.jsx)(On.a,{defaultValue:mn(n[t.fieldName],o),isMulti:!0,name:t.fieldName,options:o,className:!j&&d?"border border-red-600 rounded":"",onChange:function(e){r(t.fieldName,jn(e))},onBlur:function(){return f(!0)}}),Object(Gt.jsx)(nn,{formEle:t,element:n,fieldId:h,touched:d,setIsValidForField:m})]})}),(function(e,t){return e.element[e.formEle.fieldName]===t.element[t.formEle.fieldName]&&e.formEle.options===t.formEle.options}));var An=function(){function e(t,n){Object(J.a)(this,e),this.formEle=t,this.objValues=n,this.isIntegrated=!1}return Object(G.a)(e,[{key:"integrates",value:function(){return!this.formEle.prerequisites||!this.formEle.prerequisites.length||(this.loopPrerequisites(),this.isIntegrated)}},{key:"loopPrerequisites",value:function(){for(var e=0;!1===this.isIntegrated&&e<this.formEle.prerequisites.length;)this.checkPrerequisites(this.formEle.prerequisites[e]),e++}},{key:"checkPrerequisites",value:function(e){var t=this,n=function(n){e[n].filter((function(e){return e==t.objValues[n]})).length>0&&t.setIsIntegrated()};for(var r in e)n(r)}},{key:"setIsIntegrated",value:function(){this.isIntegrated=!0}}]),e}(),_n=function(e){return Object(Re.useMemo)((function(){return new An(e.formEle,e.element).integrates()}),[e.formEle,e.element])?function(e,t,n){switch(t){case o.hiddenInput:return Object(Gt.jsx)(gn,Object(a.a)({},n),e);case o.basicInput:case o.datePicker:case o.dateTimePicker:return Object(Gt.jsx)(dn,Object(a.a)({},n),e);case o.basicSelect:return Object(Gt.jsx)(pn,Object(a.a)({},n),e);case o.basicTextarea:return Object(Gt.jsx)(bn,Object(a.a)({},n),e);case o.basicCheckbox:return Object(Gt.jsx)(cn,Object(a.a)({},n),e);case o.basicRadio:return Object(Gt.jsx)(hn,Object(a.a)({},n),e);case o.optionsMaker:return Object(Gt.jsx)(Nn,Object(a.a)({},n),e);case o.childOfSelectorForSection:return Object(Gt.jsx)(yn,Object(a.a)({},n),e);case o.parentsSelector:return Object(Gt.jsx)(Pn,Object(a.a)({},n),e);default:return Object(Gt.jsx)(dn,Object(a.a)({},n),e)}}(e.formEle.fieldName,e.formEle.componentCode,e):null},Tn=function(e){return Object(Gt.jsx)("span",{children:e.formModel.map((function(t,n){return Object(Gt.jsx)(_n,Object(a.a)({formEle:t},e),t.fieldName+n.toString())}))})},Mn=function(e){var t=e.sectionId,n=Object(xn.b)((function(e){return e.project}))[H._sections],i=Qt(n,t),a=Object(xn.b)((function(e){return e.formElement.element})),o=function(e,t){Le({type:r.updateFormElementKey,payload:{fieldName:e,value:t}})};return Object(Gt.jsxs)("form",{name:"element-form",children:[i.childOf&&i.childOf.length>0&&Object(Gt.jsx)(Tn,{formModel:[new Kt(i.childOf,n).build()],element:a,handleChange:o}),Object(Gt.jsx)(Tn,{formModel:i.formModel,element:a,handleChange:o})]})},Ln=function(){function e(t,n,r,i){Object(J.a)(this,e),this.projectId=t,this.sectionId=n,this.element=r,this.mode=i,this.sectionModelInDS=void 0}return Object(G.a)(e,[{key:"save",value:function(){var e=Object(ce.a)(le.a.mark((function e(){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.setSectionModel(),this.checkAndSetPk(),this.setcreatedAt(),this.deleteEmptyProps(),this.mode!==Be.add){e.next=9;break}return e.next=7,ue[this.projectId].callInsertor(this.sectionId,this.element).autoInsert();case 7:e.next=12;break;case 9:return this.setupdatedAtValueIfInEditMode(),e.next=12,ue[this.projectId].callUpdator(this.sectionId,this.element).autoUpdate();case 12:return e.abrupt("return",this.element);case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setSectionModel",value:function(){this.sectionModelInDS=ue[this.projectId].DS[this.sectionId]}},{key:"checkAndSetPk",value:function(){this.element[this.sectionModelInDS.pk]||(this.element[this.sectionModelInDS.pk]=$.make(this.sectionModelInDS.name))}},{key:"deleteEmptyProps",value:function(){for(var e in this.element)""===this.element[e]&&delete this.element[e]}},{key:"setcreatedAt",value:function(){this.sectionModelInDS.fields.includes(p.createdAt)&&!this.element[p.createdAt]&&(this.element[p.createdAt]=new Date((new Date).toUTCString()).toISOString())}},{key:"setupdatedAtValueIfInEditMode",value:function(){this.sectionModelInDS.fields.includes(p.updatedAt)&&(this.element[p.updatedAt]=new Date((new Date).toUTCString()).toISOString())}}]),e}(),Bn=n(11),Un=function(e){var t=e.sectionId,n=Object(xn.b)((function(e){return e.project})),r=Object(xn.b)((function(e){return e.formElement.element})),i=Object(xn.b)((function(e){return e.formElesValidState})),a=Object(Bn.g)(),o=function(){var e=Object(ce.a)(le.a.mark((function e(){var i;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r.id?Be.edit:Be.add,e.next=3,new Ln(n[H._settings][0].id,t,r,i).save();case 3:a(-1);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(Gt.jsxs)("div",{className:"mt-6 mb-3 px-2 flex justify-end",children:[Object(Gt.jsx)("button",{className:"py-2 px-6 bg-gray-200 font-semibold rounded hover:bg-gray-300 mr-3",onClick:function(){return a(-1)},children:"Cancel"}),Object(Gt.jsx)("button",{disabled:Object.keys(i).some((function(e){return!1===i[e]})),className:"py-2 px-6 bg-prussian-blue-400 text-white font-semibold rounded hover:bg-prussian-blue-500",onClick:o,children:"Save"})]})},Vn=function(e){var t=e.children,n=e.headerText;return Object(Gt.jsxs)("div",{className:"p-4 bg-white rounded shadow",children:[n?Object(Gt.jsxs)("div",{className:"mt-3",children:[Object(Gt.jsx)("h3",{className:"text-xl font-bold",children:n}),Object(Gt.jsx)("hr",{className:"mt-4"})]}):null,Object(Gt.jsx)("div",{className:"pt-4 pb-4 overflow-y-auto",children:t})]})},Rn=function(){return Object(Gt.jsxs)("svg",{className:"mx-auto my-5 animate-spin h-5 w-5 text-prussian-blue-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[Object(Gt.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),Object(Gt.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})},qn=function(){var e=Object(Bn.h)(),t=e[Ue.elementId]?Be.edit:Be.add,n=e[Ue.projectId],i=e[Ue.sectionId],a=t===Be.edit?e[Ue.elementId]:null,o=Object(Re.useState)(null),c=Object(P.a)(o,2),s=c[0],l=c[1];if(Object(Re.useEffect)((function(){var e=!0,r=function(){var r=Object(ce.a)(le.a.mark((function r(){var o,c;return le.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,zt(n);case 2:if(o=r.sent,n&&i&&o){r.next=5;break}return r.abrupt("return",l(void 0));case 5:if(t!==Be.add){r.next=7;break}return r.abrupt("return",l({}));case 7:return r.next=9,ue[n].callSelector(i,{id:a}).single();case 9:c=r.sent,e&&l(c);case 11:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}();return e&&r(),function(){e=!1}}),[t,n,i,a]),void 0===s)return Object(Gt.jsx)(Bn.a,{to:ze.projectsList});var u=t===Be.add?"Add Element":"Edit Element";return Le({type:r.updateFormElement,payload:s}),Object(Gt.jsxs)(Vn,{headerText:u,children:[null===s&&Object(Gt.jsx)(Rn,{}),null!==s&&Object(Gt.jsx)(Mn,{sectionId:i}),null!==s&&Object(Gt.jsx)(Un,{sectionId:i})]})};function Hn(e,t){var n=e.find((function(e){return e.value==t}));return"undefined"===typeof n?null:n.label}var zn=function(){function e(t){Object(J.a)(this,e),this.project=t}return Object(G.a)(e,[{key:"delete",value:function(){var e=Object(ce.a)(le.a.mark((function e(){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.callOnProjectDeleted();case 2:return e.next=4,this.doDelete();case 4:this.reloadProjectList();case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"doDelete",value:function(){var e=Object(ce.a)(le.a.mark((function e(){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ue.system.callDeletor(pe.projects,{id:this.project.id}).autoDelete();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"callOnProjectDeleted",value:function(){var e=Object(ce.a)(le.a.mark((function e(){var t,n;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,zt(this.project.id,!1);case 2:if(!e.sent){e.next=6;break}return e.next=6,null===(t=(n=ue[this.project.id].dbStore).onProjectDeleted)||void 0===t?void 0:t.call(n);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"reloadProjectList",value:function(){(new Ve).load()}}]),e}(),Wn=function(e){var t=e.children;return Object(Gt.jsx)("div",{className:"mt-2",children:t})},Kn=function(e){var t=e.children,n=e.icon;return Object(Gt.jsx)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:Object(Gt.jsxs)("div",{className:"sm:flex sm:items-start",children:[n&&Object(Gt.jsx)("div",{className:"mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-red-100 sm:mx-0 sm:h-10 sm:w-10",children:Object(Gt.jsx)("i",{className:"".concat(n," text-xl -mt-1")})}),Object(Gt.jsx)("div",{className:"sm:flex sm:items-start",children:Object(Gt.jsx)("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left",children:t})})]})})},Qn=function(e){var t=e.children;return Object(Gt.jsx)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:t})},Jn=function(e){var t=e.children;return Object(Gt.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900",id:"modal-title",children:t})},Gn={confirm:{normal:"bg-prussian-blue-500",hover:"bg-prussian-blue-600",focus:"bg-prussian-blue-800"},alert:{normal:"bg-red-600",hover:"bg-red-700",focus:"bg-red-900"}},Yn=function(e){var t=e.title,n=e.children,r=e.type,i=e.actionText,a=e.icon,o=e.handleClickAction,c=e.closeFn,s=e.animationClass,l=e.disableAction,u=void 0!==l&&l;return Object(Gt.jsx)("div",{className:"fixed z-10 inset-0 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true",children:Object(Gt.jsxs)("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[Object(Gt.jsx)("div",{className:"animate__animated ".concat(s," animate__faster fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"),"aria-hidden":"true"}),Object(Gt.jsx)("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"\u200b"}),Object(Gt.jsxs)("div",{className:"animate__animated ".concat(s," animate__faster inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl sm:my-8 sm:align-middle sm:max-w-lg sm:w-full"),children:[Object(Gt.jsxs)(Kn,{icon:a,children:[Object(Gt.jsx)(Jn,{children:t}),Object(Gt.jsx)(Wn,{children:n})]}),Object(Gt.jsxs)(Qn,{children:[Object(Gt.jsx)("button",{onClick:o,type:"button",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 ".concat(Gn[r].normal," text-base font-medium text-white hover:").concat(Gn[r].focus," focus:outline-none focus:ring-0 focus:").concat(Gn[r].focus," sm:ml-3 sm:w-auto sm:text-sm"),disabled:u,children:i}),Object(Gt.jsx)("button",{onClick:c,type:"button",className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-0 focus:bg-gray-200 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm",children:"Cancel"})]})]})]})})},$n=function(e){var t=e.project,n=Object(Re.useState)(!1),i=Object(P.a)(n,2),a=i[0],o=i[1],c=Object(Re.useState)("animate__fadeIn"),s=Object(P.a)(c,2),l=s[0],u=s[1],d=Object(xn.b)((function(e){return e.project})),f=Object(Bn.g)(),h=function(){a?(u("animate__fadeOut"),setTimeout((function(){return o(!1)}),500)):(u("animate__fadeIn"),o(!0))};return Object(Gt.jsxs)("span",{children:[Object(Gt.jsxs)("button",{onClick:h,className:"px-4 py-2 text-red-700 inline-flex items-center md:mb-2 lg:mb-0 rounded bg-red-700 bg-opacity-10 hover:bg-opacity-20 text-sm",children:[Object(Gt.jsx)("i",{className:"bi-trash"}),Object(Gt.jsx)("span",{className:"ml-2 hidden lg:inline-block",children:"Delete project"})]}),a&&Object(Gt.jsx)(Yn,{title:"Delete Project",actionText:"Delete",type:"alert",handleClickAction:function(){var e;h(),(null===d||void 0===d||null===(e=d[H._settings][0])||void 0===e?void 0:e.id)===t.id&&Le({type:r.resetCurrentProject}),setTimeout((function(){new zn(t).delete(),f(ze.projectsList)}),500)},closeFn:h,animationClass:l,icon:"text-red-600 bi-exclamation-triangle",children:Object(Gt.jsxs)("p",{className:"text-sm text-gray-500",children:["Are you sure you want to delete this project?",Object(Gt.jsx)("br",{}),Object(Gt.jsx)("br",{}),"All project data will be permanently removed from this device. This action cannot be undone.",Object(Gt.jsx)("br",{}),Object(Gt.jsx)("br",{}),"Data stored on other devices will not be affected."]})})]})};function Xn(e,t){var n=e;return t.forEach((function(e){n=n.replace(new RegExp(":".concat(e.name),"g"),e.value)})),n}var Zn=n(18),er=function(e){var t=e.project;return Object(Gt.jsxs)(Zn.b,{to:Xn(ze.projectEdit,[{name:Ue.projectId,value:t.id}]),className:"px-4 py-3 text-gray-800 mr-3 inline-flex items-center ml-auto leading-none text-sm bg-gray-100 hover:bg-gray-200 rounded",children:[Object(Gt.jsx)("i",{className:"bi-pencil"})," ",Object(Gt.jsx)("span",{className:"ml-2 hidden sm:inline-block",children:"Edit Project"})]})},tr=function(e){var t=e.children;return Object(Gt.jsx)("div",{className:"flex items-end flex-wrap mt-6",children:t})},nr=n(34),rr=function(e){var t=e.project;return Object(Gt.jsxs)("div",{className:"p-6",children:[Object(Gt.jsx)("h1",{className:"title-font text-lg font-medium text-gray-900 mb-3",children:t.title}),Object(Gt.jsx)("p",{className:"text-gray-600 text-xs",children:"Description"}),Object(Gt.jsx)("p",{className:"text-lg mb-3",children:t.description}),Object(Gt.jsx)("p",{className:"text-gray-600 text-xs",children:"Created on:"}),Object(Gt.jsx)("p",{className:"text-md mb-3",children:nr("yyyy/MM/dd, at hh:mm",new Date(t.createdAt))}),Object(Gt.jsx)("p",{className:"text-gray-600 text-xs",children:"Storage method:"}),Object(Gt.jsx)("p",{className:"text-md",children:Hn(C,t.localStorage)}),Object(Gt.jsxs)(tr,{children:[Object(Gt.jsx)($n,{project:t}),Object(Gt.jsx)(er,{project:t})]})]})},ir=function(){var e=Object(Bn.h)()[Ue.projectId],t=Object(Re.useState)(null),n=Object(P.a)(t,2),r=n[0],i=n[1];return Object(Re.useEffect)((function(){var t=!0,n=function(){var n=Object(ce.a)(le.a.mark((function n(){var r;return le.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,zt(e);case 2:if(n.sent){n.next=5;break}return n.abrupt("return",i(void 0));case 5:return n.next=7,ue[e].callSelector(H._settings).single();case 7:r=n.sent,t&&i(r);case 9:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();return t&&n(),function(){t=!1}}),[e]),void 0===r?Object(Gt.jsx)(Bn.a,{to:ze.projectsList}):Object(Gt.jsx)("div",{className:"relative border-2 border-gray-200 border-opacity-60 rounded bg-white",style:{minHeight:"200px"},children:null===r?Object(Gt.jsx)(Rn,{}):Object(Gt.jsx)(rr,{project:r})})},ar=function(e){var t=e.projectId,n=e.sectionId,r=e.elementId,i=Object(Re.useState)(!1),a=Object(P.a)(i,2),o=a[0],c=a[1],s=Object(Re.useState)("animate__fadeIn"),l=Object(P.a)(s,2),u=l[0],d=l[1],f=Object(Bn.g)(),h=function(){o?(d("animate__fadeOut"),setTimeout((function(){return c(!1)}),500)):(d("animate__fadeIn"),c(!0))};return Object(Gt.jsxs)("span",{children:[Object(Gt.jsx)("button",{"data-tip":!0,"data-for":"deleteElement",onClick:h,className:"".concat(kn," mt-6 px-4 py-2"),children:Object(Gt.jsx)("i",{className:"bi-trash"})}),Object(Gt.jsx)(fn.a,{id:"deleteElement",effect:"solid",children:"Delete element"}),o&&Object(Gt.jsxs)(Yn,{title:"Delete element",actionText:"Delete",type:"alert",handleClickAction:function(){h(),setTimeout((function(){ue[t].callDeletor(n,{id:r}).autoDelete(),f(Xn(ze.projectSectionElesList,[{name:Ue.projectId,value:t},{name:Ue.sectionId,value:n}]))}),500)},closeFn:h,animationClass:u,icon:"text-red-600 bi-exclamation-triangle",children:[Object(Gt.jsx)("p",{className:"text-sm text-gray-500",children:"Are you sure you want to delete this element?"}),Object(Gt.jsx)("p",{className:"text-sm text-gray-500",children:"This action cannot be undone."})]})]})},or=function(){function e(t,n,r){Object(J.a)(this,e),this.listOfParents=t,this.projectId=n,this.sections=r,this.parentInfoForDetailsView=[]}return Object(G.a)(e,[{key:"get",value:function(){var e=Object(ce.a)(le.a.mark((function e(){var t=this;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,En(this.listOfParents,function(){var e=Object(ce.a)(le.a.mark((function e(n){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.processElement(n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:return e.abrupt("return",this.parentInfoForDetailsView);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"processElement",value:function(){var e=Object(ce.a)(le.a.mark((function e(t){var n,r,a,o;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.split("|"),e.next=3,ue[this.projectId].callSelector(n[0],Object(i.a)({},p.id,n[1])).single();case 3:r=e.sent,a=Qt(this.sections,n[0]),o=In(a.formModel),this.parentInfoForDetailsView.push({sectionId:n[0],element:r,txt:r[a.formModel[o].fieldName]});case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),cr=function(e){var t=e.projectId,n=e.parentsInfo,r=e.sections,i=Object(Re.useState)([]),a=Object(P.a)(i,2),o=a[0],c=a[1];return Object(Re.useEffect)((function(){var e=!0,i=function(){var i=Object(ce.a)(le.a.mark((function i(){var a;return le.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,new or(n,t,r).get();case 2:a=i.sent,e&&c(a);case 4:case"end":return i.stop()}}),i)})));return function(){return i.apply(this,arguments)}}();return e&&i(),function(){e=!1}}),[n,t,r]),Object(Gt.jsxs)("div",{className:"p-3 pt-0",children:[Object(Gt.jsx)("p",{className:"text-sm text-gray-500 mb-2",children:"Parent elements:"}),o.map((function(e,n){return Object(Gt.jsx)(Zn.b,{to:Xn(ze.projectSectionEleDetails,[{name:Ue.projectId,value:t},{name:Ue.sectionId,value:e.sectionId},{name:Ue.elementId,value:e.element.id}]),className:"mr-2 py-1 px-4 bg-gray-200 hover:bg-gray-300 bg-opacity-80 rounded-md text-sm font-semibold",children:e.txt},e.element.id)}))]})},sr=function(e){return e.value||null},lr=function(e){return e.value?"\u2713":null},ur=function(e){var t=e.value;return t?Object(Gt.jsx)("div",{className:"rounded-full",style:{backgroundColor:t,width:"25px"},children:"\xa0"}):null},dr=function(e){var t=e.value;return t?Object(Gt.jsx)("a",{href:"mailto:".concat(t),target:"_blank",rel:"noreferrer",className:"underline",children:t}):null},fr=function(e){var t=e.value;return t?nr("yyyy/MM/dd hh:mm",new Date(t)):null},hr=function(e){var t=e.value;return t?nr("yyyy/MM/dd",new Date(t)):null},pr=function(e){var t=e.value;return t?new Date(t).toLocaleString("default",{month:"short",year:"numeric"}):null},br=function(e){var t=e.value,n=Object(Re.useState)(!1),r=Object(P.a)(n,2),i=r[0],a=r[1];return t?Object(Gt.jsxs)(Gt.Fragment,{children:[i?t:t.replace(/./g,"*"),Object(Gt.jsx)("button",{type:"button",className:i?"bi-eye-slash-fill ml-3":"bi-eye-fill ml-3",onClick:function(){return a(!i)},children:Object(Gt.jsx)("i",{})})]}):null},jr=function(e){var t=e.value;return t?Object(Gt.jsxs)("span",{children:[t,"%"]}):null},mr=function(e){var t=e.value;return t?Object(Gt.jsx)("a",{href:"tel:".concat(t),target:"_blank",rel:"noreferrer",className:"underline",children:t}):null},vr=function(e,t){return Hn(e,t.value)},xr=function(e){var t,n=e.value;return n?Object(Gt.jsx)("a",{href:n,target:"_blank",rel:"noreferrer",className:"underline",children:(t=n,t.replace(/^(?:https?:\/\/)?(?:www\.)?/i,""))}):null},Or=function(e){var t=e.value;return t?t.split("-W").reverse().join("-").replace(/0(\d+)/,"$1"):null},yr=function(e){switch("string"===typeof e.componentCode?parseInt(e.componentCode,10):e.componentCode){case o.basicInput:return gr(e.type);case o.datePicker:return wr(e.type);case o.dateTimePicker:return kr(e.type);case o.basicTextarea:return sr;case o.basicSelect:case o.basicRadio:return vr.bind(null,e.options);case o.basicCheckbox:return lr;default:return sr}},gr=function(e){switch(e){case l.color:return ur;case l.email:return dr;case l.tel:return mr;case l.url:return xr;case l.password:return br;case l.range:return jr;case l.number:case l.text:default:return sr}},wr=function(e){switch(e){case u.month:return pr;case u.week:return Or;case u.date:default:return hr}},kr=function(e){switch(e){case d.time:return sr;case d.datetimeLocal:default:return fr}},Sr=function(e){var t=e.projectId,n=e.sectionId,r=e.mode,i=e.elementId,a=r===Be.add?"bi-plus":"bi-pencil",o=[{name:Ue.projectId,value:t},{name:Ue.sectionId,value:n}];r===Be.edit&&o.push({name:Ue.elementId,value:i});var c=Xn(r===Be.add?ze.projectSectionAddEle:ze.projectSectionEditEle,o);return Object(Gt.jsx)(Zn.b,{to:c,className:"absolute bottom-5 right-7 md:bottom-7 md:right-10 bg-prussian-blue-400 text-white text-xl shadow-xl rounded-3xl h-14 w-14 flex items-center justify-center",children:Object(Gt.jsx)("i",{className:a})})},Nr=function(){var e=Object(Re.useState)(null),t=Object(P.a)(e,2),n=t[0],r=t[1],i=Object(xn.b)((function(e){return e.project})),a=Object(Bn.h)(),o=a[Ue.projectId],c=a[Ue.sectionId],s=a[Ue.elementId];return Object(Re.useEffect)((function(){var e=!0,t=function(){var t=Object(ce.a)(le.a.mark((function t(){var n,i;return le.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,zt(o);case 2:if(n=t.sent,o&&c&&s&&n){t.next=5;break}return t.abrupt("return",r(void 0));case 5:return t.next=7,ue[o].callSelector(c,{id:s}).single();case 7:i=t.sent,e&&r(i);case 9:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return e&&t(),function(){e=!1}}),[o,c,s,i]),void 0===n?o&&c?Object(Gt.jsx)(Bn.a,{to:Xn(ze.projectSectionElesList,[{name:Ue.projectId,value:o},{name:Ue.sectionId,value:c}])}):Object(Gt.jsx)(Bn.a,{to:ze.projectsList}):Object(Gt.jsxs)(Vn,{headerText:"Details",children:[null===n||null===i?Object(Gt.jsx)(Rn,{}):Object(Gt.jsx)(Ir,{element:n,formModels:Qt(i[H._sections],c).formModel}),null!==n&&n.parentsInfo&&Array.isArray(n.parentsInfo)&&n.parentsInfo.length>0&&Object(Gt.jsx)(cr,{projectId:o,parentsInfo:n.parentsInfo,sections:i[H._sections]}),null!==n&&Object(Gt.jsxs)("div",{children:[Object(Gt.jsx)(ar,{projectId:o,sectionId:c,elementId:s}),Object(Gt.jsx)(Sr,{projectId:o,sectionId:c,elementId:s,mode:Be.edit})]})]})},Ir=function(e){var t=e.element,n=e.formModels;return Object(Gt.jsx)("div",{className:"p-3",children:n.map((function(e){return e.label?Object(Gt.jsx)(Cr,{formModel:e,value:t[e.fieldName]},e.fieldName):null}))})},Cr=function(e){var t=e.formModel,n=e.value;return"undefined"===typeof n?null:Object(Gt.jsxs)("div",{children:[Object(Gt.jsx)("p",{className:"text-sm text-gray-500",children:t.label}),Object(Gt.jsx)("p",{className:"mb-3",children:yr(t)({value:n})})]})},Er=function(e){var t=e.children,n=e.tdProps,r=e.elementId,i=Object(Bn.g)(),o=Object(Bn.h)();return Object(Gt.jsx)("td",Object(a.a)(Object(a.a)({onClick:function(e){var t=e.target;"A"!==t.tagName&&"BUTTON"!==t.tagName&&i(Xn(ze.projectSectionEleDetails,[{name:Ue.projectId,value:o.projectId},{name:Ue.sectionId,value:o.sectionId},{name:Ue.elementId,value:r}]))},className:"px-6 py-4 cursor-pointer"},n),{},{children:t}))},Dr=n(93),Fr=function(e){var t=e.sectionInfo,n=e.sectionData,r=function(e){var t=Object(Re.useMemo)((function(){return[]}),[e.id,e.formModel]);return Object(Re.useMemo)((function(){return e.formModel.forEach((function(n){e.id&&n.label&&t.push({Header:n.label,accessor:n.fieldName,Cell:yr(n)})}))}),[e.id,e.formModel,t]),t}(t),i=Object(Dr.useTable)({columns:r,data:n},Dr.useSortBy),o=i.getTableProps,c=i.getTableBodyProps,s=i.headerGroups,l=i.rows,u=i.prepareRow;return Object(Gt.jsxs)("table",Object(a.a)(Object(a.a)({className:"table-auto w-full divide-y divide-gray-200"},o()),{},{children:[Object(Gt.jsx)("thead",{className:"bg-gray-50",children:s.map((function(e){return Object(Gt.jsx)("tr",Object(a.a)(Object(a.a)({},e.getHeaderGroupProps()),{},{children:e.headers.map((function(e){return Object(Gt.jsx)("th",Object(a.a)(Object(a.a)({className:"px-6 py-2 text-xs text-gray-500 text-left"},e.getHeaderProps(e.getSortByToggleProps())),{},{children:e.render("Header")}))}))}))}))}),Object(Gt.jsx)("tbody",Object(a.a)(Object(a.a)({className:"divide-y divide-gray-200"},c()),{},{children:l.map((function(e){return u(e),Object(Gt.jsx)("tr",Object(a.a)(Object(a.a)({className:"whitespace-nowrap"},e.getRowProps()),{},{children:e.cells.map((function(e){return Object(Gt.jsx)(Er,{tdProps:e.getCellProps(),elementId:e.row.original.id,children:e.render("Cell")},"".concat(e.column.id).concat(e.row.id))}))}))}))}))]}))},Pr=function(e){var t=e.sectionTitle,n=e.sectionId,r=e.projectId;return Object(Gt.jsx)("div",{className:"container px-5 py-24 mx-auto",children:Object(Gt.jsx)("div",{className:"p-4 lg:w-2/3 mx-auto",children:Object(Gt.jsxs)("div",{className:"h-full bg-white shadow px-8 pt-16 pb-16 rounded-lg overflow-hidden text-center relative",children:[Object(Gt.jsx)("h2",{className:"tracking-widest text-xs title-font font-medium text-gray-400 mb-1",children:"Nothing here yet"}),Object(Gt.jsxs)("h1",{className:"title-font sm:text-2xl text-xl font-medium text-gray-900 mb-3",children:["There are no items in ",t]}),Object(Gt.jsx)("p",{className:"leading-relaxed mb-3",children:"Create a new entry to populate this list"}),Object(Gt.jsx)("div",{className:"flex flex-wrap mt-7",children:Object(Gt.jsx)(Zn.b,{to:Xn(ze.projectSectionAddEle,[{name:Ue.projectId,value:r},{name:Ue.sectionId,value:n}]),className:"flex-grow mx-2 mt-4 text-white bg-prussian-blue-400 border-0 py-3 px-8 focus:outline-none hover:bg-prussian-blue-500 rounded font-bold text-sm",children:"Create a new element"})})]})})})},Ar=function(){var e=Object(Bn.h)(),t=e[Ue.projectId],n=e[Ue.sectionId],r=Object(xn.b)((function(e){return e.project})),i=Object(Re.useState)(null),a=Object(P.a)(i,2),o=a[0],c=a[1];if(Object(Re.useEffect)((function(){var e=!0,r=function(){var r=Object(ce.a)(le.a.mark((function r(){var i;return le.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,zt(t);case 2:if(r.sent){r.next=5;break}return r.abrupt("return",c(void 0));case 5:return r.next=7,ue[t].callSelector(n).multiple();case 7:i=r.sent,e&&c(i);case 9:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}();return e&&r(),function(){e=!1}}),[n,t]),void 0===o)return Object(Gt.jsx)(Bn.a,{to:ze.projectsList});if(null===r||null===o)return Object(Gt.jsx)(Rn,{});var s=Qt(r[H._sections],n);return s?0===o.length?Object(Gt.jsx)(Pr,{sectionId:n,sectionTitle:s.title,projectId:t}):Object(Gt.jsxs)(Vn,{headerText:s.title,children:[Object(Gt.jsx)(Fr,{sectionInfo:s,sectionData:o}),Object(Gt.jsx)(Sr,{projectId:t,sectionId:n,mode:Be.add})]}):null},_r=function(){function e(t,n){Object(J.a)(this,e),this.projectSettings=t,this.localSettingAdditionalKeys=n,this.copyOfProjectSettings=void 0}return Object(G.a)(e,[{key:"save",value:function(){var e=Object(ce.a)(le.a.mark((function e(){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setProjectSettingsCloneWithAdditionalKeys(),this.doStoreProjectSettings(),e.abrupt("return",this.copyOfProjectSettings);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setProjectSettingsCloneWithAdditionalKeys",value:function(){this.copyOfProjectSettings=Object(a.a)(Object(a.a)({},this.projectSettings),this.localSettingAdditionalKeys)}},{key:"doStoreProjectSettings",value:function(){ue.system.callInsertor(pe.projects,this.copyOfProjectSettings).autoInsert()}}]),e}(),Tr=function(){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(t={},Object(i.a)(t,H._settings,[]),Object(i.a)(t,H._sections,[]),t),r=arguments.length>1?arguments[1]:void 0;Object(J.a)(this,e),this.project=n,this.mode=r}return Object(G.a)(e,[{key:"save",value:function(){var e=Object(ce.a)(le.a.mark((function e(){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("save ~ this.projectDataToSave[RESERVED_AUDS_KEYS._sections]",this.project[H._sections]),this.setcreatedAt(),this.mode===Be.edit&&this.setupdatedAt(),ue[this.project[H._settings][0].id]){e.next=6;break}return e.next=6,this.initDbInstance();case 6:return e.next=8,this.saveSettings();case 8:return e.next=10,this.saveSections();case 10:return e.next=12,this.postSaveActions();case 12:return e.abrupt("return",this.project);case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setcreatedAt",value:function(){this.project[H._settings][0].createdAt=new Date((new Date).toUTCString()).toISOString()}},{key:"setupdatedAt",value:function(){this.project[H._settings][0].updatedAt=new Date((new Date).toUTCString()).toISOString()}},{key:"initDbInstance",value:function(){var e=Object(ce.a)(le.a.mark((function e(){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Rt(this.project[H._settings][0],this.project[H._sections]).init();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"saveSettings",value:function(){var e=Object(ce.a)(le.a.mark((function e(){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ue[this.project[H._settings][0].id].callInsertor(H._settings,this.project[H._settings][0]).autoInsert();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"saveSections",value:function(){var e=Object(ce.a)(le.a.mark((function e(){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ue[this.project[H._settings][0].id].callDeletor(H._sections).clearSection();case 2:return e.next=4,ue[this.project[H._settings][0].id].callInsertor(H._sections,this.project[H._sections]).autoInsert();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"postSaveActions",value:function(){var e=Object(ce.a)(le.a.mark((function e(){var t,n,r,i;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.mode===Be.add?"postProjectCreation":"postProjectUpdate",e.next=3,null===(t=(n=ue[this.project[H._settings][0].id].dbStore)[r])||void 0===t?void 0:t.call(n,this.project);case 3:if(e.t0=e.sent,e.t0){e.next=6;break}e.t0={};case 6:return i=e.t0,e.next=9,new _r(this.project[H._settings][0],i).save();case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();var Mr=function(e){var t=e.indexSection,n=e.indexFormElement,o=e.element,c=Object(Bn.h)(),s=Object(xn.b)((function(e){return e.formProject.mode})),l=Object(xn.b)((function(e){return e.formProject.original[H._sections][t]})),u=c[Ue.projectId],d=Object(Re.useMemo)((function(){return u?Be.edit:Be.add}),[u]),f=function(e,t){return!(!t||!e)&&e.formModel.some((function(e){return e.fieldName===t}))}(l,o.fieldName),h=Object(Re.useMemo)((function(){return d===Be.edit&&f?z[s].sectionEles.existingItem:z[s].sectionEles.newItem}),[f,d,s]);return Object(Gt.jsx)(Tn,Object(a.a)({},Object(a.a)(Object(a.a)({},e),{},{formModel:h,handleChange:function(e,t,n,i){var a,o="label"!==n||f?null:(a=i)?"string"===typeof a?Cn(a):Array.isArray(a)?Cn(a.join("-")):Cn(a.toString()):null;Le({type:r.updateFormProjectUpdateFormModelOfSection,payload:{indexSection:e,indexFormElement:t,identifierAutoVal:o,fieldName:n,value:i}})}.bind(void 0,t,n),handleOptionsChange:function(e,t,n,o,c,s){Le({type:r.updateFormProjectUpdateFormModelOptionValue,payload:{indexSection:e,indexFormElement:t,indexOptions:n,formElement:Object(a.a)(Object(a.a)({},o),{},Object(i.a)({},c,s))}})}.bind(void 0,t,n),handleClickAddOption:function(e,t){Le({type:r.updateFormProjectUpdateFormModelAddOption,payload:{indexSection:e,indexFormElement:t}})}.bind(void 0,t,n),handleClickDeleteOption:function(e,t,n){Le({type:r.updateFormProjectUpdateFormModelDeleteOption,payload:{indexSection:e,indexFormElement:t,indexOptions:n}})}.bind(void 0,t,n)})))},Lr=function(e){var t=e.section,n=e.sectionIndex,i=Object(xn.b)((function(e){return e.formProject.mode})),a=Object(xn.b)((function(e){return e.formProject.project[H._sections]})),o=t.formModel.map((function(e){return Object.values(p).includes(e.fieldName)?null:e.fieldName})).filter((function(e){return null!==e})),c=function(e){Le({type:r.updateFormProjectRemoveFieldFromSection,payload:{sectionIndex:n,fieldIndex:e}})};return Object(Gt.jsxs)("div",{className:"mt-5 p-4 bg-white rounded shadow",children:[Object(Gt.jsxs)("div",{children:[Object(Gt.jsx)("h3",{className:"text-md font-bold",children:"Section # ".concat(n+1)}),Object(Gt.jsx)("hr",{className:"mt-4"})]}),Object(Gt.jsx)("div",{className:"pt-4",children:Object(Gt.jsx)(Tn,{formModel:z[i].sectionInfo,element:t,handleChange:function(e,t,n){Le({type:r.updateFormProjectUpdateSection,payload:{fieldName:t,value:n,index:e}})}.bind(void 0,n),sectionId:t.id})}),Object(Gt.jsx)("h4",{className:"pl-2 font-bold mb-2 mt-6",children:"Section element fields"}),t.formModel.map((function(e,r){return o.includes(e.fieldName)?Object(Gt.jsxs)("div",{className:"border border-transparent hover:border-prussian-blue-500 shadow rounded mb-3 p-4",children:[Object(Gt.jsx)(Mr,{indexFormElement:r,indexSection:n,element:e}),o.length<2?null:Object(Gt.jsx)("div",{className:"flex justify-end",children:Object(Gt.jsx)("button",{onClick:c.bind(void 0,r),className:"text-sm py-1 px-3 ".concat(kn),children:"Delete field"})})]},"".concat(t.id,"-").concat(r)):null})),Object(Gt.jsxs)("div",{className:"flex items-end mt-10 mb-1",children:[a.length>1&&Object(Gt.jsx)("button",{onClick:function(){Le({type:r.updateFormProjectRemoveSection,payload:n})},className:"py-2 px-4 text-sm ".concat(kn),children:"Delete section"}),Object(Gt.jsx)("button",{onClick:function(){Le({type:r.updateFormProjectAddFieldToSection,payload:n})},className:"ml-auto py-2 px-4 text-sm ".concat(wn),children:"Add field"})]})]})},Br=function(){var e=Object(Bn.h)().projectId,t=Object(xn.b)((function(e){return e.formProject.mode})),n=Object(xn.b)((function(e){return e.formProject.project})),i=Object(xn.b)((function(e){return e.formElesValidState})),a=e?Be.edit:Be.add,o=Object(Bn.g)(),c=function(){var e=Object(ce.a)(le.a.mark((function e(){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Tr(n,a).save();case 2:return e.next=4,(new Ve).load();case 4:new qt(n[H._settings],n[H._sections]).set(),o(Xn(ze.projectDetails,[{name:Ue.projectId,value:n[H._settings][0].id}]));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),s=a===Be.add?z[t].projectInfo.newItem:z[t].projectInfo.existingItem;return Object(Gt.jsxs)("span",{children:[Object(Gt.jsx)("div",{className:"mt-5 p-4 bg-white rounded shadow",children:Object(Gt.jsx)(Tn,{formModel:s,element:n[H._settings][0],handleChange:function(e,t){Le({type:r.updateFormProjectSettings,payload:{fieldName:e,value:t}})}})}),Object(Gt.jsx)("div",{className:"px-1 md:px-2 lg:px-3",children:n[H._sections].map((function(e,t){return Object(Gt.jsx)(Lr,{section:e,sectionIndex:t},e.id)}))}),Object(Gt.jsx)("div",{className:"mt-5 p-4 bg-white rounded shadow",children:Object(Gt.jsxs)("div",{className:"flex items-end flex-wrap",children:[Object(Gt.jsx)("button",{className:"w-full sm:w-auto py-2 px-6 sm:mr-3 ".concat(wn),onClick:function(){Le({type:r.updateFormProjectAddSection})},children:"Add section"}),Object(Gt.jsx)("button",{className:"w-5/12 sm:w-auto sm:ml-auto py-2 px-6 bg-gray-200 font-semibold rounded hover:bg-gray-300 mr-3",onClick:function(){return o(-1)},children:"Cancel"}),Object(Gt.jsx)("button",{disabled:Object.keys(i).some((function(e){return!1===i[e]})),className:"w-5/12 ml-auto sm:ml-0 mt-8 sm:mt-0 sm:w-auto py-2 px-6 bg-prussian-blue-400 text-white font-semibold rounded hover:bg-prussian-blue-500 disabled:bg-gray-400 disabled:bg-opacity-40 disabled:cursor-not-allowed",onClick:c,children:"Save"})]})})]})},Ur=(n(293),function(){return Object(Gt.jsx)("div",{className:"ml-auto",children:Object(Gt.jsxs)("label",{htmlFor:"project-editor-mode-toggle",className:"flex items-center cursor-pointer",children:[Object(Gt.jsxs)("div",{className:"mr-3 mt-1 text-gray-500 text-xs leading-none text-right",children:["Advanced",Object(Gt.jsx)("br",{}),"mode"]}),Object(Gt.jsxs)("div",{className:"relative mt-1",children:[Object(Gt.jsx)("input",{type:"checkbox",id:"project-editor-mode-toggle",className:"sr-only",onChange:function(){Le({type:r.setProjectEditorMode})}}),Object(Gt.jsx)("div",{className:"block bg-gray-600 w-10 h-6 rounded-full"}),Object(Gt.jsx)("div",{className:"dot absolute left-1 top-1 bg-white w-4 h-4 rounded-full transition"})]})]})})}),Vr=function(){var e=Object(Bn.h)(),t=e[Ue.projectId]?Be.edit:Be.add,n=e[Ue.projectId],a=Object(Re.useState)(null),o=Object(P.a)(a,2),c=o[0],s=o[1];if(Object(Re.useEffect)((function(){var e,r=!0;if(t===Be.add)return s((e={},Object(i.a)(e,H._settings,[{id:$.random(),title:"",description:"",createdAt:"",localStorage:h.IndexedDB}]),Object(i.a)(e,H._sections,[{id:$.random(),title:"",formModel:[{}]}]),e));var a=function(){var e=Object(ce.a)(le.a.mark((function e(){var t,i,a;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,zt(n);case 2:if(t=e.sent,n&&t){e.next=5;break}return e.abrupt("return",s(void 0));case 5:return e.next=7,ue[n].callSelector(H._settings).multiple();case 7:return i=e.sent,e.next=10,ue[n].callSelector(H._sections).multiple();case 10:a=e.sent,r&&s({_settings:i,_sections:a});case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r&&a(),function(){r=!1}}),[t,n]),void 0===c)return Object(Gt.jsx)(Bn.a,{to:ze.projectsList});var l=t===Be.add?"Add Project":"Edit Project";return Le({type:r.setFormProject,payload:c}),Object(Gt.jsxs)("span",{children:[Object(Gt.jsxs)("div",{className:"p-4 bg-white rounded shadow flex",children:[Object(Gt.jsx)("div",{children:Object(Gt.jsx)("h3",{className:"text-xl font-bold",children:l})}),null!==c&&Object(Gt.jsx)(Ur,{})]}),null===c&&Object(Gt.jsx)(Rn,{}),null!==c&&Object(Gt.jsx)(Br,{})]})},Rr=function(){function e(t,n){Object(J.a)(this,e),this.projectData=t,this.fileHandle=n}return Object(G.a)(e,[{key:"import",value:function(){var e=Object(ce.a)(le.a.mark((function e(){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.initializeDb();case 2:return e.next=4,this.setLocalProjectSettings();case 4:if(this.dispatchProject(this.projectData[H._settings][0]),this.projectData[H._settings][0].localStorage!=h.IndexedDB){e.next=8;break}return e.next=8,this.saveDataToDb();case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setLocalProjectSettings",value:function(){var e=Object(ce.a)(le.a.mark((function e(){var t,n,r;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(t=(n=ue[this.projectData[H._settings][0].id].dbStore).postProjectCreation)||void 0===t?void 0:t.call(n,this.projectData);case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0={};case 5:return r=e.t0,e.next=8,new _r(this.projectData[H._settings][0],r).save();case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initializeDb",value:function(){var e=Object(ce.a)(le.a.mark((function e(){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Rt(this.projectData[H._settings][0],this.projectData[H._sections],this.fileHandle).init();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"saveDataToDb",value:function(){var e=Object(ce.a)(le.a.mark((function e(){var t;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=le.a.keys(this.projectData);case 1:if((e.t1=e.t0()).done){e.next=7;break}return t=e.t1.value,e.next=5,ue[this.projectData[H._settings][0].id].callInsertor(t,this.projectData[t]).autoInsert();case 5:e.next=1;break;case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"dispatchProject",value:function(e){Le({type:r.addProjectToList,payload:e})}}]),e}(),qr=n(153),Hr=n.n(qr),zr=function(){function e(){Object(J.a)(this,e),this.fileHandle=void 0,this.fileContents=void 0,this.projectData=void 0}return Object(G.a)(e,[{key:"import",value:function(){var e=Object(ce.a)(le.a.mark((function e(){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("function"!==typeof window.showOpenFilePicker){e.next=5;break}return e.next=3,this.askForFileHandle();case 3:e.next=7;break;case 5:return e.next=7,this.importFromFile();case 7:if(this.fileContents){e.next=9;break}return e.abrupt("return");case 9:return this.parseFileContents(),e.abrupt("return",{project:this.projectData,fileHandle:this.fileHandle});case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"askForFileHandle",value:function(){var e=Object(ce.a)(le.a.mark((function e(){var t;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.showOpenFilePicker({multiple:!1});case 2:return t=e.sent,this.fileHandle=t[0],e.next=6,Ke(this.fileHandle);case 6:this.fileContents=e.sent;case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"importFromFile",value:function(){var e=Object(ce.a)(le.a.mark((function e(){var t;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Hr()({multiple:!1,accept:"text/json"});case 2:return t=e.sent,e.next=5,t[0].text();case 5:this.fileContents=e.sent;case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"parseFileContents",value:function(){this.projectData=JSON.parse(this.fileContents)}}]),e}(),Wr=function(e){var t=e.btnType,n=void 0===t?"icon":t,r=Object(Bn.g)(),o=Object(xn.b)((function(e){return e.formElesValidState})),c=Object(Re.useState)(!1),s=Object(P.a)(c,2),l=s[0],u=s[1],d=Object(Re.useState)("animate__fadeIn"),f=Object(P.a)(d,2),h=f[0],p=f[1],b=Object(Re.useState)(null),j=Object(P.a)(b,2),m=j[0],v=j[1],x=Object(Re.useState)(),O=Object(P.a)(x,2),y=O[0],g=O[1],w=Object(Re.useState)(null),k=Object(P.a)(w,2),S=k[0],N=k[1],I=function(){var e=Object(ce.a)(le.a.mark((function e(){var t,n,r;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!l){e.next=5;break}p("animate__fadeOut"),setTimeout((function(){return u(!1)}),500),e.next=20;break;case 5:return e.next=7,(new zr).import();case 7:if(e.t0=e.sent,e.t0){e.next=10;break}e.t0={};case 10:if(t=e.t0,n=t.project,r=t.fileHandle,n){e.next=15;break}return e.abrupt("return");case 15:p("animate__fadeIn"),u(!0),v(n),N(n[H._settings][0]),g(r);case 20:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),C=function(){var e=Object(ce.a)(le.a.mark((function e(){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m[H._settings][0]=S,e.next=3,new Rr(m,y).import();case 3:I(),new qt(m[H._settings],m[H._sections]).set(),setTimeout((function(){return r(ze.projectsList)}),500);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(Gt.jsxs)("span",{children:["icon"===n?Object(Gt.jsxs)("span",{children:[Object(Gt.jsx)("button",{"data-tip":!0,"data-for":"importProject",onClick:I,className:"mx-2 my-2 text-white bg-prussian-blue-600 border-0 py-1 px-6 focus:outline-none hover:bg-prussian-blue-700 rounded font-bold text-sm",children:Object(Gt.jsx)("i",{className:"bi bi-arrow-bar-down"})}),Object(Gt.jsx)(fn.a,{id:"importProject",effect:"solid",children:Object(Gt.jsx)("span",{children:"Import an existing project"})})]}):Object(Gt.jsx)("button",{"data-tip":!0,"data-for":"importProject",onClick:I,className:"w-full mt-4 text-white bg-prussian-blue-400 border-0 py-3 px-8 focus:outline-none hover:bg-prussian-blue-500 rounded font-bold text-sm",children:"Import an existing project"}),l&&Object(Gt.jsx)(Yn,{title:"Import project",actionText:"Import",type:"confirm",handleClickAction:C,closeFn:I,animationClass:h,disableAction:Object.keys(o).some((function(e){return!1===o[e]})),children:S&&Object(Gt.jsx)(Tn,{element:S,formModel:E,handleChange:function(e,t){N(Object(a.a)(Object(a.a)({},S),{},Object(i.a)({},e,t)))}})})]})},Kr=function(){return Object(Gt.jsx)("div",{className:"container px-0 md:px2 lg:px-5 pt-20 md:pt-24 mx-auto",children:Object(Gt.jsx)("div",{className:"p-4 lg:w-2/3 mx-auto",children:Object(Gt.jsxs)("div",{className:"h-full bg-white shadow px-8 pt-16 pb-16 rounded-lg overflow-hidden text-center relative",children:[Object(Gt.jsx)("h2",{className:"tracking-widest text-xs title-font font-medium text-gray-400 mb-1",children:"No projects found"}),Object(Gt.jsx)("h1",{className:"title-font sm:text-2xl text-xl font-medium text-gray-900 mb-3",children:"You don't have any Projects on this device yet"}),Object(Gt.jsx)("p",{className:"leading-relaxed mb-3",children:"You can create a new project or import one from an existing project file."}),Object(Gt.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 lg:gap-2 mt-7",children:[Object(Gt.jsx)(Wr,{btnType:"text"}),Object(Gt.jsx)(Zn.b,{to:ze.projectAdd,className:"w-full flex flex-wrap content-center justify-center mt-4 bg-gray-200 border-0 py-3 px-8 focus:outline-none hover:bg-gray-400 rounded font-bold text-sm",children:"Create a new project"})]})]})})})},Qr=function(e){var t=e.project;return Object(Gt.jsxs)("div",{className:"ml-auto",children:[Object(Gt.jsx)(er,{project:t}),Object(Gt.jsxs)(Zn.b,{to:Xn(ze.projectDetails,[{name:Ue.projectId,value:t.id}]),className:"px-4 py-3 text-white inline-flex items-center leading-none text-sm bg-prussian-blue-400 hover:bg-prussian-blue-500 rounded",children:[Object(Gt.jsx)("i",{className:"bi-info-circle mr-2"}),"Project details"]})]})},Jr=function(e){var t=e.project;return Object(Gt.jsx)("button",{onClick:function(){return new Ht(t.id).loadProject()},className:"px-4 py-2 text-white ml-auto inline-flex items-center md:mb-2 lg:mb-0 rounded bg-green-500 hover:bg-green-600 text-sm",children:"Load project"})},Gr=function(e){var t=e.project,n=Object(xn.b)((function(e){return e.project}));return Object(Gt.jsx)("div",{className:" mt-4 h-full border-2 border-gray-200 border-opacity-60 rounded-lg bg-white",children:Object(Gt.jsxs)("div",{className:"p-6",children:[Object(Gt.jsx)("h1",{className:"title-font text-lg font-medium text-gray-900 mb-3",children:t.title}),Object(Gt.jsx)("p",{className:"text-lg mb-3",children:t.description}),Object(Gt.jsx)("p",{className:"text-gray-600 text-xs",children:"Created on:"}),Object(Gt.jsx)("p",{className:"text-md",children:nr("yyyy/MM/dd, at hh:mm",new Date(t.createdAt))}),Object(Gt.jsxs)(tr,{children:[Object(Gt.jsx)($n,{project:t}),null===n||n[H._settings][0].id!==t.id||void 0===ue[t.id]?Object(Gt.jsx)(Jr,{project:t}):Object(Gt.jsx)(Qr,{project:t})]})]})})},Yr=function(){var e=Object(Re.useState)(!1),t=Object(P.a)(e,2),n=t[0],r=t[1],i=Object(xn.b)((function(e){return e.projects})),a=(null===i||void 0===i?void 0:i.length)||0;return Object(Re.useEffect)((function(){var e=!0,t=function(){var e=Object(ce.a)(le.a.mark((function e(){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new Ve).load();case 2:r(!0);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return e&&t(),function(){e=!1}}),[a]),Array.isArray(i)&&0===i.length?Object(Gt.jsx)(Bn.a,{to:ze.projectsNone}):n?Object(Gt.jsxs)("div",{children:[Object(Gt.jsx)("div",{className:"md:w-full bg-white border-b-2 rounded border-white",children:Object(Gt.jsxs)("div",{className:"flex h-full border-t-2 border-prussian-blue-400 border-opacity-60 rounded justify-between",children:[Object(Gt.jsx)("div",{className:"px-6 py-3",children:Object(Gt.jsx)("h1",{className:"title-font text-md font-medium text-gray-900",children:"Projects on this device"})}),Object(Gt.jsxs)("div",{className:"my-2",children:[Object(Gt.jsx)(Wr,{}),Object(Gt.jsx)(Zn.b,{"data-tip":!0,"data-for":"createProject",to:ze.projectAdd,className:"mx-2 my-2 text-white bg-prussian-blue-400 border-0 py-1 px-6 focus:outline-none hover:bg-gray-400 rounded font-bold text-sm",children:Object(Gt.jsx)("i",{className:"bi bi-plus"})}),Object(Gt.jsx)(fn.a,{id:"createProject",effect:"solid",children:Object(Gt.jsx)("span",{children:"Create a new project"})})]})]})}),Object(Gt.jsx)("div",{className:"p-1 md:w-full",children:i.map((function(e,t){return Object(Gt.jsx)(Gr,{project:e},e.id)}))})]}):Object(Gt.jsx)("span",{})},$r=function(){return Object(Gt.jsxs)(Bn.d,{children:[Object(Gt.jsx)(Bn.b,{path:ze.projectsList,element:Object(Gt.jsx)(Yr,{})}),Object(Gt.jsx)(Bn.b,{path:ze.projectAdd,element:Object(Gt.jsx)(Vr,{})}),Object(Gt.jsx)(Bn.b,{path:ze.projectEdit,element:Object(Gt.jsx)(Vr,{})}),Object(Gt.jsx)(Bn.b,{path:ze.projectsNone,element:Object(Gt.jsx)(Kr,{})}),Object(Gt.jsx)(Bn.b,{path:ze.projectDetails,element:Object(Gt.jsx)(ir,{})}),Object(Gt.jsx)(Bn.b,{path:ze.projectSectionElesList,element:Object(Gt.jsx)(Ar,{})}),Object(Gt.jsx)(Bn.b,{path:ze.projectSectionEleDetails,element:Object(Gt.jsx)(Nr,{})}),Object(Gt.jsx)(Bn.b,{path:ze.projectSectionAddEle,element:Object(Gt.jsx)(qn,{})}),Object(Gt.jsx)(Bn.b,{path:ze.projectSectionEditEle,element:Object(Gt.jsx)(qn,{})}),Object(Gt.jsx)(Bn.b,{path:"*",element:Object(Gt.jsx)(Bn.a,{to:ze.projectsList})})]})},Xr=function(e){var t,n,r,i=e.project,a=Object(xn.b)((function(e){return e.projects})),o=Object(Bn.g)(),c=Object(Re.useState)(!1),s=Object(P.a)(c,2),l=s[0],u=s[1],d=Object(Re.useRef)(null);n=d,r=function(){return u(!1)},Object(Re.useEffect)((function(){var e=function(e){null!==n&&void 0!==n&&n.current&&!n.current.contains(e.target)&&r()};return document.addEventListener("click",e),function(){document.removeEventListener("click",e)}}),[n,r]);var f=function(e){u(!l)},h=function(){var e=Object(ce.a)(le.a.mark((function e(t){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Ht(t).loadProject();case 2:p(t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),p=function(e){o(Xn(ze.projectDetails,[{name:Ue.projectId,value:e}]))};return Object(Gt.jsxs)("div",{ref:d,children:[Object(Gt.jsx)("p",{className:"text-xs text-gray-600 pl-2",children:"Current project:"}),Object(Gt.jsxs)("div",{"x-data":"{ dropdownOpen: true }",className:"relative",children:[Object(Gt.jsxs)("button",{onClick:function(){return u(!l)},className:"relative w-full flex justify-between text-left z-10 rounded py-2 px-3 bg-gray-100 hover:bg-gray-200 focus:outline-none focus:bg-gray-300",children:[Object(Gt.jsx)("span",{children:null===i||void 0===i||null===(t=i[H._settings][0])||void 0===t?void 0:t.title}),Object(Gt.jsx)("i",{className:"bi-chevron-expand my-auto"})]}),l&&Object(Gt.jsxs)("div",{className:"absolute left-0 mt-2 w-64 bg-white rounded-md overflow-hidden shadow-xl z-20 border border-bg-500",children:[(null===a||void 0===a?void 0:a.length)>1&&Object(Gt.jsx)("div",{className:"block py-2.5 px-4 text-sm bg-gray-100 text-gray-600",children:"Projects on this device"}),null===a||void 0===a?void 0:a.map((function(e){return i[H._settings][0].id===e.id?null:Object(Gt.jsx)("button",{className:"w-full block text-left px-4 py-2 text-sm text-gray-800 border-b hover:bg-gray-200",onClick:function(){return f(h(e.id))},children:e.title},e.id)})),Object(Gt.jsx)("div",{className:"block py-2.5 px-4 text-sm bg-gray-100 text-gray-600",children:"Actions"}),Object(Gt.jsxs)("button",{className:"w-full block text-left px-4 py-2 text-sm text-gray-800 border-b hover:bg-gray-200",onClick:function(){return f(p(i[H._settings][0].id))},children:[Object(Gt.jsx)("i",{className:"bi-info-circle mr-2"}),"Go to the details of the project"]}),Object(Gt.jsxs)("button",{className:"w-full block text-left px-4 py-2 text-sm text-gray-800 border-b hover:bg-gray-200",onClick:function(){return f((e=i[H._settings][0].id,o(Xn(ze.projectEdit,[{name:Ue.projectId,value:e}]))));var e},children:[Object(Gt.jsx)("i",{className:"bi-pencil mr-2"}),"Edit the current project"]}),Object(Gt.jsxs)("button",{className:"w-full block text-left px-4 py-2 text-sm text-gray-800 border-b hover:bg-gray-200",onClick:function(){return f(o(ze.projectsList))},children:[Object(Gt.jsx)("i",{className:"bi-files mr-2"}),"Go to the projects list"]}),Object(Gt.jsxs)("button",{className:"w-full block text-left px-4 py-2 text-sm text-gray-800 border-b hover:bg-gray-200",onClick:function(){return f(o(ze.projectAdd))},children:[Object(Gt.jsx)("i",{className:"bi-plus mr-2"}),"Create a new project"]})]})]})]})},Zr="block py-2.5 px-4 transition duration-200 border-l-2 hover:border-prussian-blue-700 hover:text-prussian-blue-500 text-sm font-semibold",ei=function(e,t){return"".concat(Zr,e===t?" border-prussian-blue-700":" border-transparent")},ti=[{to:ze.projectsList,txt:"Projects",icon:"bi-files"}],ni=function(){var e,t=Object(xn.b)((function(e){return e.project})),n=Object(Bn.f)();return null===t?Object(Gt.jsx)("span",{}):Object(Gt.jsxs)("div",{className:"mt-3",children:[Object(Gt.jsx)("div",{className:"block py-2.5 px-1",children:Object(Gt.jsx)(Xr,{project:t})}),Object(Gt.jsx)("div",{className:"block py-2.5 px-4",children:Object(Gt.jsx)("p",{className:"text-xs text-gray-600",children:"Project sections:"})}),null===t||void 0===t||null===(e=t[H._sections])||void 0===e?void 0:e.map((function(e){var r=Xn(ze.projectSectionElesList,[{name:Ue.projectId,value:t[H._settings][0].id},{name:Ue.sectionId,value:e.id}]);return Object(Gt.jsxs)(Zn.b,{to:r,className:ei(n.pathname,r),children:[Object(Gt.jsx)("i",{className:"bi-chevron-compact-right"}),Object(Gt.jsx)("span",{className:"ml-2",children:e.title})]},e.id)}))]})},ri=function(){var e=Object(Bn.f)();return Object(Gt.jsxs)("div",{children:[ti.map((function(t){return Object(Gt.jsxs)(Zn.b,{to:t.to,className:ei(e.pathname,t.to),children:[Object(Gt.jsx)("i",{className:t.icon}),Object(Gt.jsx)("span",{className:"ml-2",children:t.txt})]},t.to)})),Object(Gt.jsx)(ni,{})]})},ii=function(e){return Object(Gt.jsx)("div",{className:"flex-1 p-2 md:p-3 md:pt-5 lg:pt-5 lg:p-10 pt-5 overflow-auto main-scrollbar",children:e.children})},ai=function(){var e=Object(xn.b)((function(e){return e.layout.sidebar})),t=function(){Le({type:r.toggleSidebar})};return Object(Gt.jsxs)("div",{className:"bg-white text-gray-700 flex h-14 shadow-md justify-between",children:[Object(Gt.jsx)("button",{className:"mobile-menu-button p-4 focus:outline-none  md:hidden",onClick:t,children:Object(Gt.jsx)("svg",{className:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:Object(Gt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6h16M4 12h16M4 18h16"})})}),Object(Gt.jsxs)("div",{className:"relative flex items-center lg:w-auto lg:static md:pl-5 -ml-7 md:ml-0",children:[Object(Gt.jsx)(Zn.b,{to:"/",className:"text-lg font-bold leading-relaxed inline-block mr-4 py-2 whitespace-no-wrap uppercase",children:Object(Gt.jsx)("img",{src:"".concat("/app","/assets/logo/logo_square.svg"),style:{height:"30px",width:"auto"},alt:"Anita"})}),Object(Gt.jsxs)(Zn.b,{to:"/",className:"hidden md:inline-block mr-4 py-2 whitespace-no-wrap text-prussian-blue-400",children:[Object(Gt.jsx)("span",{className:"text-md font-bold leading-relaxed uppercase",children:"Anita"}),Object(Gt.jsx)("sup",{style:{fontVariant:"small-caps"},children:"Beta"})]})]}),Object(Gt.jsx)("div",{className:"visible md:hidden",children:"\xa0"}),""===e&&Object(Gt.jsx)("div",{onClick:t,className:"absolute inset-0 h-full w-full z-10 md:hidden"})]})},oi=function(e){var t=Object(xn.b)((function(e){return e.layout.sidebar}));return Object(Gt.jsx)("div",{className:"py-5 z-10",children:Object(Gt.jsxs)("div",{className:"".concat(t," sidebar h-full bg-white shadow rounded-sm text-prussian-blue-500 w-64 space-y-6 py-7 px-2 absolute inset-y-0 left-0 transform md:relative md:translate-x-0 transition duration-200 ease-in-out"),children:[Object(Gt.jsx)("nav",{children:e.children}),Object(Gt.jsxs)("div",{className:"absolute bottom-1 text-xs text-gray-400",children:[Object(Gt.jsxs)("p",{className:"inline-block mr-1",children:["v","0.12.0"]}),"|",Object(Gt.jsxs)("a",{className:"ml-1",href:"https://github.com/anita-app/anita/issues",target:"_blank",rel:"noreferrer",children:[Object(Gt.jsx)("i",{className:"bi-bug","data-tip":!0,"data-for":"reportBug"}),Object(Gt.jsx)(fn.a,{id:"reportBug",effect:"solid",children:Object(Gt.jsx)("span",{children:"Report a bug"})})]})]})]})})},ci=function(){return Object(Gt.jsxs)(Zn.a,{children:[Object(Gt.jsx)(ai,{}),Object(Gt.jsxs)("div",{className:"relative admin-container flex",children:[Object(Gt.jsx)(oi,{children:Object(Gt.jsx)(ri,{})}),Object(Gt.jsx)(ii,{children:Object(Gt.jsx)($r,{})})]})]})},si=n(38),li=n.n(si),ui=(n(294),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)));function di(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}(new He).init(),li.a.render(Object(Gt.jsx)(qe.a.StrictMode,{children:Object(Gt.jsx)(xn.a,{store:oe,children:Object(Gt.jsx)(ci,{})})}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/app",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/app","/service-worker.js");ui?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var r=n.headers.get("content-type");404===n.status||null!=r&&-1===r.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):di(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):di(t,e)}))}}()}},[[295,1,2]]]);
//# sourceMappingURL=main.de2ec005.chunk.js.map