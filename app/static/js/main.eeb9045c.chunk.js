(this["webpackJsonpanita-app"]=this["webpackJsonpanita-app"]||[]).push([[0],{158:function(e,t){},160:function(e,t){},170:function(e,t){},172:function(e,t){},199:function(e,t){},200:function(e,t){},205:function(e,t){},207:function(e,t){},214:function(e,t){},233:function(e,t){},284:function(e,t,n){},285:function(e,t,n){},286:function(e,t,n){"use strict";n.r(t);n(151);var r,i=n(6);!function(e){e[e.toggleSidebar=1]="toggleSidebar",e[e.addProjectToList=2]="addProjectToList",e[e.setProjectList=3]="setProjectList",e[e.setCurrentProject=4]="setCurrentProject",e[e.resetCurrentProject=5]="resetCurrentProject",e[e.addSectionForChildOfSelector=6]="addSectionForChildOfSelector",e[e.resetSectionForChildOfSelector=7]="resetSectionForChildOfSelector",e[e.setValidStateForEle=8]="setValidStateForEle",e[e.unsetValidStateForEle=9]="unsetValidStateForEle",e[e.updateFormElement=10]="updateFormElement",e[e.setFormProject=11]="setFormProject",e[e.setProjectEditorMode=12]="setProjectEditorMode",e[e.updateFormProjectSettings=13]="updateFormProjectSettings",e[e.updateFormProjectAddSection=14]="updateFormProjectAddSection",e[e.updateFormProjectUpdateSection=15]="updateFormProjectUpdateSection",e[e.updateFormProjectUpdateFormModelOfSection=16]="updateFormProjectUpdateFormModelOfSection",e[e.updateFormProjectRemoveSection=17]="updateFormProjectRemoveSection",e[e.updateFormProjectAddFieldToSection=18]="updateFormProjectAddFieldToSection",e[e.updateFormProjectRemoveFieldFromSection=19]="updateFormProjectRemoveFieldFromSection",e[e.updateFormProjectUpdateFormModelAddOption=20]="updateFormProjectUpdateFormModelAddOption",e[e.updateFormProjectUpdateFormModelDeleteOption=21]="updateFormProjectUpdateFormModelDeleteOption",e[e.updateFormProjectUpdateFormModelOptionValue=22]="updateFormProjectUpdateFormModelOptionValue"}(r||(r={}));var a,c={element:null},o=n(15),s={};!function(e){e[e.basicInput=1]="basicInput",e[e.basicTextarea=2]="basicTextarea",e[e.basicCheckbox=3]="basicCheckbox",e[e.basicSelect=4]="basicSelect",e[e.basicRadio=5]="basicRadio",e[e.hiddenInput=6]="hiddenInput",e[e.optionsMaker=7]="optionsMaker",e[e.datePicker=8]="datePicker",e[e.dateTimePicker=9]="dateTimePicker",e[e.childOfSelectorForSection=10]="childOfSelectorForSection",e[e.parentsSelector=11]="parentsSelector"}(a||(a={}));var u,l,d=[{value:a.basicInput,label:"Short text"},{value:a.basicTextarea,label:"Long text"},{value:a.basicCheckbox,label:"Check box"},{value:a.basicSelect,label:"Drop-down list"},{value:a.basicRadio,label:"Alternative choice"},{value:a.datePicker,label:"Date picker"},{value:a.dateTimePicker,label:"Date & time picker"}],h={componentCode:a.basicInput,fieldName:"label",type:"text",label:"Label",required:!0,width:"8"},f={componentCode:a.basicInput,fieldName:"label",type:"text",label:"Label",required:!0,width:"11"},p=[{componentCode:a.basicInput,fieldName:"value",type:"text",label:"Value",required:!0,width:"3"},h],b=[{componentCode:a.hiddenInput,fieldName:"value"},f],j=[{componentCode:a.basicInput,fieldName:"value",type:"text",label:"Value",disabled:!0,required:!0,width:"3"},h],m=[{componentCode:a.hiddenInput,fieldName:"value"},f];!function(e){e[e.fileSystem=1]="fileSystem",e[e.IndexedDB=2]="IndexedDB",e[e.SQLite=3]="SQLite"}(u||(u={})),function(e){e.id="id",e.createdAt="createdAt",e.parentsInfo="parentsInfo",e.updatedAt="updatedAt",e.createdBy="createdBy"}(l||(l={}));var v,x,O="Not supported in this browser.\nAvailable only on the Desktop version of Chrome, Edge and Opera.",y=[{componentCode:a.hiddenInput,fieldName:l.id},{componentCode:a.hiddenInput,fieldName:l.createdAt},{componentCode:a.basicInput,fieldName:"title",type:"text",value:"",label:"Project",required:!0},{componentCode:a.basicTextarea,fieldName:"description",value:"",label:"Description",required:!0}],g=[{label:"File system",value:u.fileSystem,disabled:"undefined"===typeof window.showOpenFilePicker,hint:"function"===typeof window.showOpenFilePicker?'The Project is saved in a file on your computer in JSON. Data is updated automatically every time you make any change.\nYou can chose the name and the location of the file when you click "Save" at the bottom of this form.':O},{label:"Local database (IndexedDB)",value:u.IndexedDB,hint:"The Project is saved on your computer in the IndexedDB database of your Browser.\nYou can export data in a JSON file at any time."},{label:"Local database (SQLite)",value:u.SQLite,disabled:"undefined"===typeof window.showOpenFilePicker,hint:"function"===typeof window.showOpenFilePicker?"The Project is saved on your computer in a SQLite database.\nThe database is stored in a file in your File System.":O}],w=[].concat(y,[{componentCode:a.basicRadio,fieldName:"localStorage",value:u.IndexedDB,label:"Local storage",required:!0,options:g}]),k=[].concat(y,[{componentCode:a.basicRadio,fieldName:"localStorage",value:u.IndexedDB,label:"Local storage",required:!0,disabled:!0,options:g}]),S=(a.hiddenInput,l.id,a.basicInput,a.childOfSelectorForSection,[{componentCode:a.optionsMaker,fieldName:"options",type:"text",label:"Possible values",prerequisites:[{componentCode:[a.basicSelect,a.basicRadio]}],required:!0},{componentCode:a.basicCheckbox,fieldName:"required",value:!1,label:"Required"}]),I=[{componentCode:a.basicInput,fieldName:"label",type:"text",label:"Field label",required:!0,width:"7"},{componentCode:a.basicSelect,fieldName:"componentCode",options:d,value:1,label:"Data type",required:!0,width:"3"},{componentCode:a.basicInput,fieldName:"fieldName",type:"text",label:"Identifier",required:!0,width:"2"}].concat(S),N=[{componentCode:a.basicInput,fieldName:"label",type:"text",label:"Field label",required:!0,width:"8"},{componentCode:a.basicSelect,fieldName:"componentCode",options:d,value:1,label:"Data type",required:!0,width:"4"},{componentCode:a.hiddenInput,fieldName:"fieldName"}].concat(S),C=[{componentCode:a.basicInput,fieldName:"label",type:"text",label:"Field label",required:!0,width:"7"},{componentCode:a.basicSelect,fieldName:"componentCode",options:d,value:1,label:"Data type",required:!0,width:"3"},{componentCode:a.basicInput,fieldName:"fieldName",type:"text",label:"Identifier",disabled:!0,required:!0,width:"2"}].concat(S),D=[{componentCode:a.basicInput,fieldName:"label",type:"text",label:"Field label",required:!0,width:"8"},{componentCode:a.basicSelect,fieldName:"componentCode",options:d,value:1,label:"Data type",required:!0,width:"4"},{componentCode:a.hiddenInput,fieldName:"fieldName"}].concat(S),E=[{componentCode:a.hiddenInput,fieldName:l.id},{componentCode:a.basicInput,fieldName:"title",type:"text",label:"Section name",required:!0},{componentCode:a.childOfSelectorForSection,fieldName:"childOf",label:"Parent sections:",options:[]}];!function(e){e[e.advanced=1]="advanced",e[e.basic=2]="basic"}(x||(x={}));var F,P=(v={},Object(o.a)(v,x.advanced,{projectInfo:{newItem:w,existingItem:k},sectionInfo:E,sectionEles:{newItem:I,existingItem:C},optionEles:{newItem:p,existingItem:j}}),Object(o.a)(v,x.basic,{projectInfo:{newItem:w,existingItem:k},sectionInfo:E,sectionEles:{newItem:N,existingItem:D},optionEles:{newItem:b,existingItem:m}}),v);!function(e){e._settings="_settings",e._sections="_sections"}(F||(F={}));var A,T,_,M=n(4),L=n(5),B=n(38),V=function(){function e(){Object(M.a)(this,e)}return Object(L.a)(e,null,[{key:"make",value:function(e){var t=new Date((new Date).toUTCString()).toISOString(),n=Math.floor(9e3*Math.random())+1e3,r="".concat(e).concat(t).concat(n);return B.a.SHA256(r).toString()}},{key:"random",value:function(){var e=new Date((new Date).toUTCString()).toISOString(),t=Math.floor(9e3*Math.random())+1e3,n="".concat(e).concat(t);return B.a.SHA256(n).toString()}}]),e}(),U=n(88),R=n.n(U),H={original:(A={},Object(o.a)(A,F._settings,[]),Object(o.a)(A,F._sections,[]),A),project:(T={},Object(o.a)(T,F._settings,[]),Object(o.a)(T,F._sections,[]),T),mode:x.basic},q={sidebar:"-translate-x-full"},W=[],z={project:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case r.setCurrentProject:return t.payload;case r.resetCurrentProject:return null;default:return e}},projects:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case r.addProjectToList:return e?e.concat(t.payload):[t.payload];case r.setProjectList:return t.payload;default:return e}},sectionsForChildOfSelector:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:W,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case r.addSectionForChildOfSelector:var n=e.concat();if(n.length){var i=n.findIndex((function(e){return e.id===t.payload.id})),a=i>=0?i:n.length;n[a]=t.payload}else n.push(t.payload);return n;default:return e}},formElesValidState:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case r.setValidStateForEle:return Object(i.a)(Object(i.a)({},e),{},Object(o.a)({},t.payload.formEleId,t.payload.valid));case r.unsetValidStateForEle:var n=Object(i.a)({},e);return Object.keys(n).forEach((function(e){e.startsWith(t.payload)&&delete n[e]})),n;default:return e}},formElement:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case r.updateFormElement:return{element:Object(i.a)({},t.payload)};default:return e}},formProject:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:H,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case r.setProjectEditorMode:return{original:e.original,project:e.project,mode:e.mode===x.basic?x.advanced:x.basic};case r.setFormProject:return{original:R()(t.payload),mode:e.mode,project:R()(t.payload)};case r.updateFormProjectSettings:return{original:e.original,mode:e.mode,project:Object(i.a)(Object(i.a)({},e.project),{},Object(o.a)({},F._settings,[Object(i.a)({},t.payload)]))};case r.updateFormProjectAddSection:return{original:e.original,mode:e.mode,project:Object(i.a)(Object(i.a)({},e.project),{},Object(o.a)({},F._sections,e.project[F._sections].concat({id:V.random(),title:"",formModel:[{}]})))};case r.updateFormProjectUpdateSection:var n={original:e.original,mode:e.mode,project:Object(i.a)({},e.project)};return n.project[F._sections][t.payload.index]=Object(i.a)({},t.payload.section),n;case r.updateFormProjectUpdateFormModelOfSection:var a={original:e.original,mode:e.mode,project:Object(i.a)({},e.project)};return a.project[F._sections][t.payload.indexSection].formModel[t.payload.indexFormElement]=Object(i.a)({},t.payload.formElement),a;case r.updateFormProjectAddFieldToSection:var c={original:e.original,mode:e.mode,project:Object(i.a)({},e.project)};return c.project[F._sections][t.payload].formModel.push({}),c;case r.updateFormProjectRemoveFieldFromSection:var s={original:e.original,mode:e.mode,project:Object(i.a)({},e.project)};return s.project[F._sections][t.payload.sectionIndex].formModel.splice(t.payload.fieldIndex,1),s;case r.updateFormProjectRemoveSection:var u={original:e.original,mode:e.mode,project:Object(i.a)({},e.project)};return u.project[F._sections].splice(t.payload,1),u;case r.updateFormProjectUpdateFormModelAddOption:var l={original:e.original,mode:e.mode,project:Object(i.a)({},e.project)},d=l.project[F._sections][t.payload.indexSection].formModel[t.payload.indexFormElement].options.length+1;return l.project[F._sections][t.payload.indexSection].formModel[t.payload.indexFormElement].options.push({label:"",value:d}),l;case r.updateFormProjectUpdateFormModelDeleteOption:var h={original:e.original,mode:e.mode,project:Object(i.a)({},e.project)};return h.project[F._sections][t.payload.indexSection].formModel[t.payload.indexFormElement].options.splice(t.payload.indexOptions,1),h;case r.updateFormProjectUpdateFormModelOptionValue:var f={original:e.original,mode:e.mode,project:Object(i.a)({},e.project)};return f.project[F._sections][t.payload.indexSection].formModel[t.payload.indexFormElement].options[t.payload.indexOptions]=t.payload.formElement,f;default:return e}},layout:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:q,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case r.toggleSidebar:var n=Object(i.a)({},e);return n.sidebar="-translate-x-full"===n.sidebar?"":"-translate-x-full",n;default:return e}}},K=n(90),Q=Object(K.a)(z),J=Object(K.b)(Q),G=n(1),Y=n.n(G),X=n(3),$={system:void 0},Z={name:"localSettings",fields:["data"]};!function(e){e[e.testData=1]="testData"}(_||(_={}));var ee,te={name:"projects",fields:["title","fileHandle","description",l.createdAt]},ne={projects:te.name,localSettings:Z.name},re=[],ie=[te,Z],ae={name:F._sections,pk:"id",fields:["title"],jsonFields:["childOf","formModel"]},ce={name:F._settings,pk:"id",fields:["title","localStorage","createdAt","description"]};!function(e){e[e.auds_settings=1]="auds_settings",e[e.auds_sections=2]="auds_sections"}(ee||(ee={}));var oe=[ce,ae],se=l.id,ue=l.parentsInfo,le=l.createdBy,de=n(150),he=function(){function e(){Object(M.a)(this,e)}return Object(L.a)(e,null,[{key:"info",value:function(t,n){var r=n?["".concat(t,": ").concat(JSON.stringify(n))]:[t];return e.doLog(r)}},{key:"list",value:function(t,n){e.isEmptyList(n)&&e.doLog([t,"none"]);var r=Array.isArray(n)?e.listFromArray(n):e.listFromObject(n);return r=r.substring(0,r.length-1),r+=".",e.doLog(["".concat(t," ").concat(r)])}},{key:"isEmptyList",value:function(e){return Array.isArray(e)&&!e.length||"object"===typeof e&&!Object.keys(e).length}},{key:"listFromArray",value:function(t){var n="";return t.forEach((function(t){n+="".concat(e.spacesForListeles).concat(e.formatValueForList(t),";")})),n}},{key:"listFromObject",value:function(t){var n="";for(var r in t)n+="".concat(e.spacesForListeles).concat(r,": ").concat(e.formatValueForList(t[r]),";");return n}},{key:"raw",value:function(t,n){return e.doLog(["".concat(t,": "),n])}},{key:"error",value:function(t,n,r){return e.doLog([t,n,r],"error")}},{key:"warn",value:function(t,n,r){return e.doLog([t,n,r],"warn")}},{key:"formatValueForList",value:function(t){return e.isPrimitiveValue(t)||null===t?t:JSON.stringify(t)}},{key:"isPrimitiveValue",value:function(e){switch(typeof e){case"string":case"number":case"boolean":case"undefined":return!0;default:return!1}}},{key:"doLog",value:function(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"log",i=(new Date).toISOString();return t[0]="[".concat(i,"] ").concat(t[0]),!0===e.debug&&(n=console)[r].apply(n,Object(de.a)(t)),t.join(". ")}}]),e}();he.debug=!0,he.spacesForListeles="\n                            - ";var fe,pe,be=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:se,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[se],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:se,s=arguments.length>7?arguments[7]:void 0,u=arguments.length>8?arguments[8]:void 0,l=arguments.length>9?arguments[9]:void 0;Object(M.a)(this,e),this.allSez=t,this.name=n,this.fields=r,this.jsonFields=i,this.pk=a,this.indexes=c,this.orderBy=o,this.childOf=s,this.parentsIdentifiers=u,this.ownerIdentifier=l,this.section=void 0}return Object(L.a)(e,[{key:"make",value:function(){return this.addPkToFields(),this.addPkToIndexes(),this.addSpecialFieldsToFields("indexes"),this.addSpecialFieldsToFields("jsonFields"),this.setOwnerIdentifier(),this.checkOrderByExists(),this.checkRelations(),this.checkParentIdentifier(),this.buildSez(),this.section}},{key:"addPkToFields",value:function(){this.fields.includes(this.pk)||this.fields.unshift(this.pk)}},{key:"addPkToIndexes",value:function(){this.indexes.includes(this.pk)||this.indexes.unshift(this.pk)}},{key:"addSpecialFieldsToFields",value:function(e){var t=this;this[e].forEach((function(e){t.fields.includes(e)||t.fields.push(e)}))}},{key:"setOwnerIdentifier",value:function(){this.ownerIdentifier||(this.ownerIdentifier=le),this.fields.includes(this.ownerIdentifier)||this.fields.push(this.ownerIdentifier)}},{key:"checkOrderByExists",value:function(){this.fields.includes(this.orderBy)||this.fields.push(this.orderBy)}},{key:"checkRelations",value:function(){this.childOf&&this.loopAllRelations()}},{key:"loopAllRelations",value:function(){var e=this;this.childOf.forEach((function(t){return e.checkRelationsExist(t)})),this.childOf.length||(this.childOf=void 0)}},{key:"checkRelationsExist",value:function(e){if(!(this.getSezByName(e)>=0)){var t=this.childOf.indexOf(e);this.childOf.splice(t,1),he.error("Error in .childOf list","Section '".concat(e,"' does not exist in the sections list and has hence been removed from the .childOf list"))}}},{key:"getSezByName",value:function(e){for(var t=-1,n=0,r=this.allSez.length;-1===t&&n<r;)this.allSez[n].name===e&&(t=n),n++;return t}},{key:"checkParentIdentifier",value:function(){this.childOf&&!this.parentsIdentifiers&&(this.parentsIdentifiers=ue)}},{key:"buildSez",value:function(){this.section={name:this.name,pk:this.pk,indexes:this.indexes,orderBy:this.orderBy,fields:this.fields,ownerIdentifier:this.ownerIdentifier,jsonFields:this.jsonFields},this.addChildOf()}},{key:"addChildOf",value:function(){this.childOf&&(this.section.childOf=this.childOf,this.section.parentsIdentifiers=this.parentsIdentifiers)}}]),e}(),je=function(){function e(t){Object(M.a)(this,e),this.allSez=t,this.ds={}}return Object(L.a)(e,[{key:"make",value:function(){var e=this;return this.allSez.forEach((function(t){return e.buildSez(t)})),this.ds}},{key:"buildSez",value:function(e){var t=new be(this.allSez,e.name,e.fields,e.jsonFields,e.pk,e.indexes,e.orderBy,e.childOf,e.parentsIdentifiers,e.ownerIdentifier).make();this.addToTempDs(t)}},{key:"addToTempDs",value:function(e){this.ds[e.name]=e}}]),e}(),me=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];Object(M.a)(this,e),this.executers=t,this.options=n,this.allSez=r,this.addSystemSections=i,this.dbStore=void 0,this.DS={}}return Object(L.a)(e,[{key:"init",value:function(){var e=Object(X.a)(Y.a.mark((function e(){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.addSystemSections&&(this.DS=Object.assign(this.DS,new je(oe).make())),this.allSez.length&&(this.DS=Object.assign(this.DS,new je(this.allSez).make())),this.options.DS&&(this.DS=Object.assign(this.DS,this.options.DS)),!this.executers.dbStore){e.next=9;break}return e.next=6,new this.executers.dbStore(this.options,this.DS).initDB();case 6:this.dbStore=e.sent,e.next=10;break;case 9:throw new Error("No dbStore passed to DbConnector. To initialize DbConnector, you must pass a valid dbStore");case 10:return e.abrupt("return",this);case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"callInsertor",value:function(e,t){return new this.executers.insertor(this,e,t)}},{key:"callSelector",value:function(e,t){return new this.executers.selector(this,e,t)}},{key:"callUpdator",value:function(e,t){return new this.executers.updator(this,e,t)}},{key:"callDeletor",value:function(e,t){return new this.executers.deletor(this,e,t)}}]),e}(),ve=function(){function e(t){Object(M.a)(this,e),this.sections=t,this.allSez=[],this.datastructure={}}return Object(L.a)(e,[{key:"extend",value:function(){var e=this;return this.sections.forEach((function(t){return e.buildSectionDefinition(t)})),this.allSez.forEach((function(t){return e.buildAndAddAllSections(t)})),this.datastructure}},{key:"buildSectionDefinition",value:function(e){var t={name:e.id,fields:Object.values(l),jsonFields:[l.parentsInfo]};e.formModel.forEach((function(e){t.fields.push(e.fieldName)})),this.allSez.push(t)}},{key:"buildAndAddAllSections",value:function(e){var t=new be(this.allSez,e.name,e.fields).make();this.addToTempTs(t)}},{key:"addToTempTs",value:function(e){this.datastructure[e.name]=e}}]),e}(),xe=n(146),Oe=function(){function e(t,n){Object(M.a)(this,e),this.options=t,this.DS=n,this.db=void 0,this.deletedSections=[]}return Object(L.a)(e,[{key:"initDB",value:function(){var e=Object(X.a)(Y.a.mark((function e(){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.options.indexedDbName){e.next=2;break}throw Error("No name found in DsDbInitOptions. Please provide a name for the database by setting the name on the property indexedDbName in the options passed to DbConnector.");case 2:return this.setDb(),this.options.previousVersions||(this.options.previousVersions=[]),this.handlePreviousVersion(),this.buildDb(),e.abrupt("return",this);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"postProjectCreation",value:function(){var e=Object(X.a)(Y.a.mark((function e(){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.makeDexieInfoForUpgrade());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"postProjectUpdate",value:function(){var e=Object(X.a)(Y.a.mark((function e(t){var n,r,i,a,c,o=this;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Object.keys(t).concat(t[F._sections].map((function(e){return e.id}))),r=Object.keys(this.DS),i=r.filter((function(e){return!n.includes(e)})),a=n.filter((function(e){return!r.includes(e)})),!(i.length>0||a.length>0)){e.next=17;break}return this.options.previousVersions.push(i.concat()),i.forEach((function(e){delete o.DS[e]})),a.length>0&&(c=t[F._sections].filter((function(e){return a.includes(e.id)})),Object.assign(this.DS,new ve(c).extend())),this.close(),console.log("1"),this.handlePreviousVersion(),console.log("2"),this.buildDb(),console.log("3"),e.next=16,this.db.open();case 16:console.log("4");case 17:return e.abrupt("return",this.makeDexieInfoForUpgrade());case 18:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"close",value:function(){return this.db.close()}},{key:"onProjectDeleted",value:function(){return this.db.delete()}},{key:"makeDexieInfoForUpgrade",value:function(){return{dexieInfoForUpgrade:{previousVersions:this.options.previousVersions,DS:this.DS}}}},{key:"setDb",value:function(){this.db=new xe.a(this.options.indexedDbName)}},{key:"handlePreviousVersion",value:function(){var e=this;this.deletedSections=[],this.options.previousVersions.forEach((function(t){return t.forEach((function(t){e.DS[t]||e.deletedSections.push(t)}))}))}},{key:"buildDb",value:function(){var e,t=(null===(e=this.options.previousVersions)||void 0===e?void 0:e.length)+1||1,n={};for(var r in this.DS)n[this.DS[r].name]=this.DS[r].indexes.join();return this.deletedSections.forEach((function(e){return n[e]=null})),this.db.version(t).stores(n)}}]),e}(),ye=n(20),ge=function(){function e(){Object(M.a)(this,e)}return Object(L.a)(e,null,[{key:"methodToExecute",value:function(e,t,n){var r=t.length;if(!r)return"dexieFullCollection";if(2===r&&(">="===t[0][1]||">"===t[0][1])&&("<="===t[1][1]||"<"===t[1][1]))return"dexieBetween";if("="!==t[0][1])return"complexSelect";if(1===r&&t[0][0]===e[n].pk)return"dexieGet";if(e[n].indexes.indexOf(t[0][0])>-1)return"dexieGet";var i=!0;return t.forEach((function(t){"="!==t[1]&&(i=!1),e[n].indexes.indexOf(t[0])<0&&(i=!1)})),i?"dexieWhere":"complexSelect"}},{key:"buildArrayFildsNValues",value:function(e){var t={};return e.forEach((function(e){t[e[0]]=e[2]})),t}},{key:"buildBetweenSearchParams",value:function(e){var t=">="===e[0][1],n="<="===e[1][1];return{field:e[0][0],lowerBound:e[0][2],upperBound:e[1][2],includeLower:t,includeUpper:n}}},{key:"buildFilter4Dexie",value:function(e){var t=e[0],n=e[1],r=e[2];return function(e){switch(n){case"===":return e[t]===r;case"!=":return e[t]!=r;case">":return e[t]>r;case">=":return e[t]>=r;case"<":return e[t]>r;case"<=":return e[t]<=r;default:return e[t]==r}}}},{key:"chainFilters",value:function(e,t){return function(n){if(!e.length)return!0;var r,i=e[0](n),a=Object(ye.a)(e);try{for(a.s();!(r=a.n()).done;){var c=r.value;switch(t){case"OR":i=i||c(n);break;default:i=i&&c(n)}}}catch(o){a.e(o)}finally{a.f()}return i}}}]),e}(),we=function(){function e(t,n,r){Object(M.a)(this,e),this.dbConnector=t,this.section=n,this.element=r,this.logic="AND",this.table=void 0,this.collection=void 0,this.dexieFilters=[],this.arrWhere=[],this.orderBy=void 0,this.debug=!1,this.table=this.dbConnector.DS[this.section].name,this.collection=this.dbConnector.dbStore.db[this.table]}return Object(L.a)(e,[{key:"addWhere",value:function(e){return this.arrWhere.push(e),this}},{key:"setOrLogic",value:function(){return this.logic="OR",this}},{key:"setOrderBy",value:function(e){this.orderBy=e}},{key:"select",value:function(){var e=Object(X.a)(Y.a.mark((function e(){var t;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("AND"===this.logic){e.next=2;break}return e.abrupt("return",this.complexSelect());case 2:return t=ge.methodToExecute(this.dbConnector.DS,this.arrWhere,this.section),this.handleDebug("SELECT","methodToExecute",t),e.abrupt("return",this[t]());case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"dexieGet",value:function(){var e=Object(X.a)(Y.a.mark((function e(){var t,n,r;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t={})[this.arrWhere[0][0]]=this.arrWhere[0][2],e.next=4,this.dbConnector.dbStore.db[this.table].get(t);case 4:return n=e.sent,r=n?[n]:[],e.abrupt("return",r);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"dexieWhere",value:function(){var e=Object(X.a)(Y.a.mark((function e(){var t;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=ge.buildArrayFildsNValues(this.arrWhere),e.abrupt("return",this.dbConnector.dbStore.db[this.table].where(t).toArray());case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"dexieBetween",value:function(){var e=Object(X.a)(Y.a.mark((function e(){var t;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=ge.buildBetweenSearchParams(this.arrWhere),e.abrupt("return",this.dbConnector.dbStore.db[this.table].where(t.field).between(t.lowerBound,t.upperBound,t.includeLower,t.includeUpper).toArray());case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"dexieFullCollection",value:function(){var e=Object(X.a)(Y.a.mark((function e(){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.dbConnector.dbStore.db[this.table].toArray());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"complexSelect",value:function(){var e=this;this.arrWhere.forEach((function(t){return e.dexieFilters.push(ge.buildFilter4Dexie(t))}));var t=this.dbConnector.dbStore.db[this.table].toCollection(),n=ge.chainFilters(this.dexieFilters,this.logic);return t=t.and(n),this.handleDebug("SELECT","WHERE",this.arrWhere),this.orderBy?t.sortBy(this.orderBy):t.toArray()}},{key:"insert",value:function(){var e=Object(X.a)(Y.a.mark((function e(){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.handleDebug("INSERT","WITH OBJECT",this.element),e.next=3,this.dbConnector.dbStore.db[this.table].put(this.element);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"update",value:function(){var e=Object(X.a)(Y.a.mark((function e(){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.handleDebug("UPDATE","WITH OBJECT",this.element),e.next=3,this.dbConnector.dbStore.db[this.table].update(this.element[this.dbConnector.DS[this.section].pk],this.element);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"count",value:function(){return this.collection.count()}},{key:"delete",value:function(){var e=Object(X.a)(Y.a.mark((function e(){var t;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=ge.buildArrayFildsNValues(this.arrWhere),this.handleDebug("DELETE","WHERE",this.arrWhere),e.next=4,this.dbConnector.dbStore.db[this.table].where(t).delete();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"clearDb",value:function(){var e=Object(X.a)(Y.a.mark((function e(){var t,n;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n in t=[],this.dbConnector.DS)this.dbConnector.DS[n].name&&t.push(this.dbConnector.dbStore.db[this.dbConnector.DS[n].name].clear());return e.next=4,Promise.all(t);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"clearTable",value:function(){var e=Object(X.a)(Y.a.mark((function e(){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.dbConnector.dbStore.db[this.table].clear();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"handleDebug",value:function(e,t,n){this.debug&&he.raw("EXECUTING ".concat(e," FOR TABLE ").concat(this.table," ").concat(t," "),n)}}]),e}(),ke=function(){function e(t,n,r){Object(M.a)(this,e),this.dbConnector=t,this.section=n,this.args=r}return Object(L.a)(e,[{key:"autoDelete",value:function(){var e=Object(X.a)(Y.a.mark((function e(){var t;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.args[this.dbConnector.DS[this.section].pk]){e.next=6;break}return t=this.args[this.dbConnector.DS[this.section].pk],e.next=4,new we(this.dbConnector,this.section).addWhere([this.dbConnector.DS[this.section].pk,"=",t]).delete();case 4:e.next=7;break;case 6:he.error("Error in autoDelete","No PK value was found on the element");case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"clearSection",value:function(){var e=Object(X.a)(Y.a.mark((function e(){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new we(this.dbConnector,this.section).clearTable();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),Se={insertor:function(){function e(t,n,r){Object(M.a)(this,e),this.dbConnector=t,this.section=n,this.element=r}return Object(L.a)(e,[{key:"autoInsert",value:function(){return this.element instanceof Array?this.insertMany():this.insertOne()}},{key:"insertMany",value:function(){var e=this.dbConnector.DS[this.section].name;return this.dbConnector.dbStore.db[e].bulkPut(this.element)}},{key:"insertOne",value:function(){return new we(this.dbConnector,this.section,this.element).insert().catch((function(e){he.error("Error in autoinsert: ",e)}))}}]),e}(),selector:function(){function e(t,n,r){Object(M.a)(this,e),this.dbConnector=t,this.section=n,this.args=r,this.data=[],this.qe=void 0}return Object(L.a)(e,[{key:"single",value:function(){var e=Object(X.a)(Y.a.mark((function e(){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setUpSelect(),this.setQuery(),e.next=4,this.executeSelect();case 4:return e.abrupt("return",this.data[0]);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"multiple",value:function(){var e=Object(X.a)(Y.a.mark((function e(){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setUpSelect(),this.setQuery(),this.setOrder(),e.next=5,this.executeSelect();case 5:return e.abrupt("return",this.data);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"count",value:function(){var e=Object(X.a)(Y.a.mark((function e(){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new we(this.dbConnector,this.section).count());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setUpSelect",value:function(){this.qe=new we(this.dbConnector,this.section)}},{key:"setQuery",value:function(){this.args&&this.args[this.dbConnector.DS[this.section].pk]&&this.qe.addWhere([this.dbConnector.DS[this.section].pk,"=",this.args[this.dbConnector.DS[this.section].pk]])}},{key:"setOrder",value:function(){this.qe.setOrderBy(this.dbConnector.DS[this.section].orderBy)}},{key:"executeSelect",value:function(){var e=Object(X.a)(Y.a.mark((function e(){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.qe.select();case 2:this.data=e.sent;case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),updator:function(){function e(t,n,r){Object(M.a)(this,e),this.dbConnector=t,this.section=n,this.element=r}return Object(L.a)(e,[{key:"autoUpdate",value:function(){return new we(this.dbConnector,this.section,this.element).update().catch((function(e){he.error("Error in autoUpdate",e)}))}}]),e}(),deletor:ke,dbStore:Oe},Ie=function(){function e(){Object(M.a)(this,e),this.projectList=[]}return Object(L.a)(e,[{key:"load",value:function(){var e=Object(X.a)(Y.a.mark((function e(){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadFromLocalDB();case 2:this.dispatchProjectList(this.projectList);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadFromLocalDB",value:function(){var e=Object(X.a)(Y.a.mark((function e(){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$.system.callSelector(ne.projects).multiple();case 2:this.projectList=e.sent;case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"dispatchProjectList",value:function(e){J.dispatch({type:r.setProjectList,payload:e})}}]),e}(),Ne=n(2),Ce=n.n(Ne),De=function(){function e(){Object(M.a)(this,e),this.systemDbName="anitaDB"}return Object(L.a)(e,[{key:"init",value:function(){var e=Object(X.a)(Y.a.mark((function e(){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return he.info("Anita web app."),e.next=3,this.initSystemIndexedDb(this.systemDbName);case 3:this.setLoggerDebug(),this.loadProjectList();case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initSystemIndexedDb",value:function(){var e=Object(X.a)(Y.a.mark((function e(t){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new me(Se,{previousVersions:re,indexedDbName:t},ie,!1).init();case 2:$.system=e.sent;case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"isReactDev",value:function(){return"_self"in Ce.a.createElement("div")}},{key:"setLoggerDebug",value:function(){he.debug=this.isReactDev()}},{key:"loadProjectList",value:function(){(new Ie).load()}}]),e}();!function(e){e.add="add",e.edit="edit"}(fe||(fe={})),function(e){e.projectId="projectId",e.sectionId="sectionId",e.elementId="elementId",e.parentId="parentId"}(pe||(pe={}));var Ee={projectsNone:"/projects/none",projectsList:"/projects/list",projectAdd:"/projects/".concat(fe.add),projectEdit:"/projects/".concat(fe.edit,"/:").concat(pe.projectId),projectDetails:"/project/:".concat(pe.projectId,"/info"),projectSectionElesList:"/project/:".concat(pe.projectId,"/list/:").concat(pe.sectionId),projectSectionAddEle:"/project/:".concat(pe.projectId,"/:").concat(pe.sectionId,"/").concat(fe.add),projectSectionEditEle:"/project/:".concat(pe.projectId,"/:").concat(pe.sectionId,"/").concat(fe.edit,"/:").concat(pe.elementId),projectSectionEleDetails:"/project/:".concat(pe.projectId,"/:").concat(pe.sectionId,"/details/:").concat(pe.elementId)},Fe=n(12);function Pe(){return window.showDirectoryPicker()}function Ae(e){return Te.apply(this,arguments)}function Te(){return(Te=Object(X.a)(Y.a.mark((function e(t){var n;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getFile();case 2:return n=e.sent,e.abrupt("return",n.text());case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _e(e,t){return Me.apply(this,arguments)}function Me(){return(Me=Object(X.a)(Y.a.mark((function e(t,n){var r,i,a;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getFileHandle(n,{create:!0});case 2:return r=e.sent,e.next=5,r.getFile();case 5:return i=e.sent,e.next=8,i.arrayBuffer();case 8:return a=e.sent,e.abrupt("return",new Uint8Array(a));case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Le(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Anita project data file",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{"application/json":[".json"]},r={types:[{name:e,description:t,accept:n}]};return window.showSaveFilePicker(r)}function Be(){return(Be=Object(X.a)(Y.a.mark((function e(t,n){var r;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.createWritable();case 2:return r=e.sent,e.next=5,r.write(n);case 5:return e.next=7,r.close();case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ve(e,t){return Ue.apply(this,arguments)}function Ue(){return(Ue=Object(X.a)(Y.a.mark((function e(t,n){var r;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={},n&&(r.writable=!0,r.mode="readwrite"),e.next=4,t.queryPermission(r);case 4:if(e.t0=e.sent,"granted"!==e.t0){e.next=7;break}return e.abrupt("return",!0);case 7:return e.next=9,t.requestPermission(r);case 9:if(e.t1=e.sent,"granted"!==e.t1){e.next=12;break}return e.abrupt("return",!0);case 12:return e.abrupt("return",!1);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Re=function(){function e(t){Object(M.a)(this,e),this.dbConnector=t,this.data=void 0}return Object(L.a)(e,[{key:"save",value:function(){var e=Object(X.a)(Y.a.mark((function e(){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setData(),e.next=3,this.saveDataToDisk();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setData",value:function(){this.data=JSON.stringify(this.dbConnector.dbStore.db)}},{key:"saveDataToDisk",value:function(){return function(e,t){return Be.apply(this,arguments)}(this.dbConnector.options.projectInfo.fileHandle,this.data)}}]),e}(),He=function(){function e(t,n,r){Object(M.a)(this,e),this.dbConnector=t,this.section=n,this.args=r}return Object(L.a)(e,[{key:"autoDelete",value:function(){var e=Object(X.a)(Y.a.mark((function e(){var t,n=this;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object.keys(this.args).length){e.next=2;break}return e.abrupt("return","Fatal error: trying to delete without any parameter");case 2:return t=this.dbConnector.dbStore.db[this.section].findIndex((function(e){return e.id===n.args.id})),this.dbConnector.dbStore.db[this.section].splice(t,1),e.next=6,new Re(this.dbConnector).save();case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"clearSection",value:function(){var e=Object(X.a)(Y.a.mark((function e(){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.dbConnector.dbStore.db[this.section].length=0,e.next=3,new Re(this.dbConnector).save();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),qe=n(7),We=n(8),ze="286b88f2ceb76ce1e7d28117bb2a7659";function Ke(e,t){return B.a.AES.encrypt(e,t).toString()}function Qe(e,t){return B.a.AES.decrypt(e,t).toString()}var Je=function(){function e(t,n,r){Object(M.a)(this,e),this.dbConnector=t,this.section=n,this.element=r,this.owner=void 0,this.undecryptedKey=void 0,this.keyIdentifier=void 0}return Object(L.a)(e,[{key:"getUserKey",value:function(){if(this.setOwner(),this.setUndecryptedKey(),this.undecryptedKey)return this.makeKeyIdentifier(),e.userKeys[this.keyIdentifier]||this.decryptUserKey(),this.returnUserUnencryptedKey()}},{key:"logNoKeyError",value:function(){he.error("ERROR: skipping encryption as no key was found for user ".concat(this.owner,". Did you forget to pass the user key in the options when initializing DbInit?"))}},{key:"setOwner",value:function(){this.owner=this.element[this.dbConnector.DS[this.section].ownerIdentifier]}},{key:"setUndecryptedKey",value:function(){this.undecryptedKey="object"===typeof this.dbConnector.options.encryptionKeys&&this.dbConnector.options.encryptionKeys[this.owner]?this.dbConnector.options.encryptionKeys[this.owner]:void 0}},{key:"makeKeyIdentifier",value:function(){this.keyIdentifier="".concat(this.owner).concat(this.undecryptedKey)}},{key:"decryptUserKey",value:function(){e.userKeys[this.keyIdentifier]=Qe(this.undecryptedKey,ze)}},{key:"returnUserUnencryptedKey",value:function(){return e.userKeys[this.keyIdentifier]}}],[{key:"decryptUserKey",value:function(e){return Ke(e,ze)}}]),e}();Je.userKeys={};var Ge=function(e){Object(qe.a)(n,e);var t=Object(We.a)(n);function n(){return Object(M.a)(this,n),t.apply(this,arguments)}return Object(L.a)(n,[{key:"do",value:function(){var e=Object(X.a)(Y.a.mark((function e(){var t,n;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==(t=this.getUserKey())){e.next=3;break}return e.abrupt("return",this.logNoKeyError());case 3:for(n in this.element)Object.values(l).includes(n)||this.encrypt(t,n);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"encrypt",value:function(e,t){this.element[t]&&(this.element[t]=Ke(this.element[t],e))}}]),n}(Je),Ye=function(){function e(t,n,r){Object(M.a)(this,e),this.dbConnector=t,this.section=n,this.elements=r,this.index=void 0,this.element=void 0}return Object(L.a)(e,[{key:"save",value:function(){var e=Object(X.a)(Y.a.mark((function e(){var t,n,r;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.setSectionStore(),this.elements instanceof Array){t=Object(ye.a)(this.elements);try{for(t.s();!(n=t.n()).done;)r=n.value,this.processElement(r)}catch(i){t.e(i)}finally{t.f()}}else this.processElement(this.elements);return e.next=4,new Re(this.dbConnector).save();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setSectionStore",value:function(){this.dbConnector.dbStore.db[this.section]||(this.dbConnector.dbStore.db[this.section]=[])}},{key:"processElement",value:function(e){this.element=e,this.checkIfElementInStoreAndSetIndex(),this.addToStore()}},{key:"checkIfElementInStoreAndSetIndex",value:function(){var e=this,t=this.dbConnector.dbStore.db[this.section],n=t.findIndex((function(t){return e.element[e.dbConnector.DS[e.section].pk]===t[e.dbConnector.DS[e.section].pk]}));this.index=n>=0?n:t.length}},{key:"addToStore",value:function(){this.dbConnector.dbStore.db[this.section][this.index]=this.element}}]),e}(),Xe=function(e){Object(qe.a)(n,e);var t=Object(We.a)(n);function n(){return Object(M.a)(this,n),t.apply(this,arguments)}return Object(L.a)(n,[{key:"autoInsert",value:function(){var e=Object(X.a)(Y.a.mark((function e(){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.dbConnector.options.encrypted){e.next=3;break}return e.next=3,this.handleEncryption();case 3:return e.next=5,this.save();case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"handleEncryption",value:function(){var e=Object(X.a)(Y.a.mark((function e(){var t,n,r;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.elements instanceof Array)){e.next=20;break}t=Object(ye.a)(this.elements),e.prev=2,t.s();case 4:if((n=t.n()).done){e.next=10;break}return r=n.value,e.next=8,new Ge(this.dbConnector,this.section,r).do();case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),t.e(e.t0);case 15:return e.prev=15,t.f(),e.finish(15);case 18:e.next=22;break;case 20:return e.next=22,new Ge(this.dbConnector,this.section,this.elements).do();case 22:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));return function(){return e.apply(this,arguments)}}()}]),n}(Ye),$e=function(e){Object(qe.a)(n,e);var t=Object(We.a)(n);function n(){return Object(M.a)(this,n),t.apply(this,arguments)}return Object(L.a)(n,[{key:"do",value:function(){var e=Object(X.a)(Y.a.mark((function e(){var t,n;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==(t=this.getUserKey())){e.next=3;break}return e.abrupt("return",this.logNoKeyError());case 3:for(n in this.element)Object.values(l).includes(n)||this.decrypt(t,n);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"decrypt",value:function(e,t){this.element[t]&&(this.element[t]=Qe(this.element[t],e))}}]),n}(Je),Ze=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object(M.a)(this,e),this.dbConnector=t,this.section=n,this.args=r,this.results=void 0}return Object(L.a)(e,[{key:"single",value:function(){var e=Object(X.a)(Y.a.mark((function e(){var t=this;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.doSelect();case 2:if(this.results.length){e.next=4;break}return e.abrupt("return");case 4:return e.abrupt("return",this.results.find((function(e){return t.filterKeys(e)})));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"filterKeys",value:function(e){for(var t=Object.keys(this.args),n=!0,r=0;n&&r<t.length;)n=e[t[r]]===this.args[t[r]],r++;return n}},{key:"multiple",value:function(){var e=Object(X.a)(Y.a.mark((function e(){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.doSelect();case 2:return e.abrupt("return",this.results);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"count",value:function(){var e=Object(X.a)(Y.a.mark((function e(){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.multiple();case 2:return e.abrupt("return",this.results.length);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"doSelect",value:function(){var e=Object(X.a)(Y.a.mark((function e(){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.results=this.dbConnector.dbStore.db[this.section]&&this.dbConnector.dbStore.db[this.section].length?this.dbConnector.dbStore.db[this.section]:[],e.next=3,this.handleDecryption();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"handleDecryption",value:function(){var e=Object(X.a)(Y.a.mark((function e(){var t;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.dbConnector.options.encrypted||!this.results.length){e.next=8;break}t=0;case 2:if(!(t<this.results.length)){e.next=8;break}return e.next=5,new $e(this.dbConnector,this.section,this.results[t]).do();case 5:t++,e.next=2;break;case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();function et(e,t,n){return tt.apply(this,arguments)}function tt(){return(tt=Object(X.a)(Y.a.mark((function e(t,n,r){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.projectInfo.fileHandle){e.next=4;break}return e.next=3,Le("anita-fh-".concat(t.projectInfo.id),n,r);case 3:return e.abrupt("return",e.sent);case 4:return e.next=6,Ve(t.projectInfo.fileHandle,!0);case 6:return e.abrupt("return",t.projectInfo.fileHandle);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function nt(e,t,n){return rt.apply(this,arguments)}function rt(){return(rt=Object(X.a)(Y.a.mark((function e(t,n,r){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.projectInfo.fileHandle){e.next=4;break}return e.next=3,Pe();case 3:return e.abrupt("return",e.sent);case 4:return e.next=6,Ve(t.projectInfo.fileHandle,!0);case 6:return e.abrupt("return",t.projectInfo.fileHandle);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var it=function(){function e(t,n){var r;Object(M.a)(this,e),this.options=t,this.DS=n,this.db=(r={},Object(o.a)(r,F._settings,[]),Object(o.a)(r,F._sections,[]),r),this.contents=void 0}return Object(L.a)(e,[{key:"initDB",value:function(){var e=Object(X.a)(Y.a.mark((function e(){var t;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.options.projectInfo){e.next=2;break}throw new Error("No projectInfo passed to DbConnector.\nTo retrieve a project from a local file, pass the an Object of type LocalProjectSettings as value of projectInfo to the options of DbConnector");case 2:return e.next=4,et(this.options);case 4:if(t=e.sent,!this.options.projectInfo.fileHandle){e.next=10;break}return e.next=8,this.initializeExistingProject();case 8:e.next=11;break;case 10:this.options.projectInfo.fileHandle=t;case 11:return e.abrupt("return",this);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"postProjectCreation",value:function(){var e=Object(X.a)(Y.a.mark((function e(){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.initializeExistingProject();case 2:return e.abrupt("return",{fileHandle:this.options.projectInfo.fileHandle});case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"postProjectUpdate",value:function(){var e=Object(X.a)(Y.a.mark((function e(){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{fileHandle:this.options.projectInfo.fileHandle});case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"close",value:function(){}},{key:"initializeExistingProject",value:function(){var e=Object(X.a)(Y.a.mark((function e(){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.doReadFile();case 2:this.parseFileContents(),this.makedDS();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"doReadFile",value:function(){var e=Object(X.a)(Y.a.mark((function e(){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ae(this.options.projectInfo.fileHandle);case 2:this.contents=e.sent;case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"parseFileContents",value:function(){this.db=JSON.parse(this.contents)}},{key:"makedDS",value:function(){Object.assign(this.DS,new ve(this.db[F._sections]).extend())}}]),e}(),at={insertor:Xe,selector:Ze,updator:function(e){Object(qe.a)(n,e);var t=Object(We.a)(n);function n(){return Object(M.a)(this,n),t.apply(this,arguments)}return Object(L.a)(n,[{key:"autoUpdate",value:function(){var e=Object(X.a)(Y.a.mark((function e(){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.dbConnector.options.encrypted){e.next=3;break}return e.next=3,this.handleEncryption();case 3:return e.next=5,this.save();case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"handleEncryption",value:function(){var e=Object(X.a)(Y.a.mark((function e(){var t,n,r;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.elements instanceof Array)){e.next=20;break}t=Object(ye.a)(this.elements),e.prev=2,t.s();case 4:if((n=t.n()).done){e.next=10;break}return r=n.value,e.next=8,new Ge(this.dbConnector,this.section,r).do();case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),t.e(e.t0);case 15:return e.prev=15,t.f(),e.finish(15);case 18:e.next=22;break;case 20:return e.next=22,new Ge(this.dbConnector,this.section,this.elements).do();case 22:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));return function(){return e.apply(this,arguments)}}()}]),n}(Ye),deletor:He,dbStore:it},ct=n(48),ot=n(39),st=n.n(ot),ut=function(){function e(t,n,r){Object(M.a)(this,e),this.dbConnector=t,this.section=n,this.element=r}return Object(L.a)(e,[{key:"select",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=st.a.select({autoQuoteTableNames:!0,autoQuoteFieldNames:!0}).from(this.dbConnector.DS[this.section].name);return e.length&&e.forEach((function(e){return t.where("".concat(e.field," ").concat(e.operator," ?"),e.value)})),t.toString()}},{key:"count",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=st.a.select({autoQuoteTableNames:!0,autoQuoteFieldNames:!1}).field("COUNT(*) as count").from(this.dbConnector.DS[this.section].name);return e.length&&e.forEach((function(e){return t.where("".concat(e.field," ").concat(e.operator," ?"),e.value)})),t.toString()}},{key:"insert",value:function(){return this.element instanceof Array?this.insertMany():this.insertOne()}},{key:"insertOne",value:function(){var e=Object(i.a)({},this.element);for(var t in e)this.fieldsRemoverIfThereIsNoColumn(e,t);return st.a.insert({autoQuoteTableNames:!0,autoQuoteFieldNames:!0}).into(this.dbConnector.DS[this.section].name).setFields(e).toString()}},{key:"insertMany",value:function(){var e=this,t=Object(ct.cloneDeep)(this.element);return t.forEach((function(t){for(var n in t)e.fieldsRemoverIfThereIsNoColumn(t,n)})),st.a.insert({autoQuoteTableNames:!0,autoQuoteFieldNames:!0}).into(this.dbConnector.DS[this.section].name).setFieldsRows(t).toString()}},{key:"update",value:function(){var e=Object(i.a)({},this.element);for(var t in e)t!==this.dbConnector.DS[this.section].pk&&this.fieldsRemoverIfThereIsNoColumn(e,t);var n=st.a.update({autoQuoteTableNames:!0,autoQuoteFieldNames:!0}).table(this.dbConnector.DS[this.section].name).setFields(e),r=this.dbConnector.DS[this.section].pk;return n.where("".concat(r," = ?"),e[this.dbConnector.DS[this.section].pk]),n.toString()}},{key:"delete",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=st.a.delete({autoQuoteTableNames:!0,autoQuoteFieldNames:!0}).from(this.dbConnector.DS[this.section].name);return e.length&&e.forEach((function(e){return t.where("".concat(e.field," ").concat(e.operator," ?"),e.value)})),t.toString()}},{key:"fieldsRemoverIfThereIsNoColumn",value:function(e,t){this.dbConnector.DS[this.section].fields.includes(t)||(delete e[t],he.warn("WARNING: field ".concat(t," removed because no corresponding column was found in the schema.")))}}]),e}(),lt=function(){function e(t){Object(M.a)(this,e),this.args=t,this.whereArgs=[],this.addWhereFromObj()}return Object(L.a)(e,[{key:"addWhereFromObj",value:function(){if(this.args)for(var e in this.args)this.addWhere(e,this.args[e])}},{key:"addWhere",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"=",r={field:e,operator:n,value:t};return this.whereArgs.push(r),this}}]),e}();function dt(e,t){return ht.apply(this,arguments)}function ht(){return(ht=Object(X.a)(Y.a.mark((function e(t,n){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.dbStore.db.run(n);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ft(e,t,n){return pt.apply(this,arguments)}function pt(){return(pt=Object(X.a)(Y.a.mark((function e(t,n,r){var i,a,c;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return he.info("Exporting schema..."),i=t.export(),e.next=4,n.getFileHandle("".concat(r,".db"),{create:!0});case 4:return a=e.sent,e.next=7,a.createWritable({keepExistingData:!0});case 7:return c=e.sent,e.next=10,c.write(i);case 10:return e.next=12,c.close();case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var bt=function(e){Object(qe.a)(n,e);var t=Object(We.a)(n);function n(e,r,i){var a;return Object(M.a)(this,n),(a=t.call(this,i)).dbConnector=e,a.section=r,a}return Object(L.a)(n,[{key:"autoDelete",value:function(){var e=Object(X.a)(Y.a.mark((function e(){var t;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object.keys(this.args).length){e.next=2;break}return e.abrupt("return","Fatal error: trying to delete without any parameter");case 2:return t=new ut(this.dbConnector,this.section).delete(this.whereArgs),e.next=5,dt(this.dbConnector,t);case 5:return e.next=7,ft(this.dbConnector.dbStore.db,this.dbConnector.options.projectInfo.fileHandle,this.dbConnector.options.projectInfo.id);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"clearSection",value:function(){var e=Object(X.a)(Y.a.mark((function e(){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),n}(lt),jt=function(){function e(t,n,r){Object(M.a)(this,e),this.dbConnector=t,this.section=n,this.elements=void 0,this.elements=Object(ct.cloneDeep)(r)}return Object(L.a)(e,[{key:"autoInsert",value:function(){var e=Object(X.a)(Y.a.mark((function e(){var t,n;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.dbConnector.options.encrypted){e.next=3;break}return e.next=3,this.handleEncryption();case 3:return(null===(t=this.dbConnector.DS[this.section].jsonFields)||void 0===t?void 0:t.length)&&this.handleJsonFields(),n=new ut(this.dbConnector,this.section,this.elements).insert(),e.next=7,dt(this.dbConnector,n);case 7:return e.next=9,ft(this.dbConnector.dbStore.db,this.dbConnector.options.projectInfo.fileHandle,this.dbConnector.options.projectInfo.id);case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"handleJsonFields",value:function(){if(this.elements instanceof Array){var e,t=Object(ye.a)(this.elements);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.handleJsonField(n)}}catch(r){t.e(r)}finally{t.f()}}else this.handleJsonField(this.elements)}},{key:"handleJsonField",value:function(e){var t,n=Object(ye.a)(this.dbConnector.DS[this.section].jsonFields);try{for(n.s();!(t=n.n()).done;){var r=t.value;e[r]&&(e[r]=JSON.stringify(e[r]))}}catch(i){n.e(i)}finally{n.f()}}},{key:"handleEncryption",value:function(){var e=Object(X.a)(Y.a.mark((function e(){var t,n,r;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.elements instanceof Array)){e.next=20;break}t=Object(ye.a)(this.elements),e.prev=2,t.s();case 4:if((n=t.n()).done){e.next=10;break}return r=n.value,e.next=8,new Ge(this.dbConnector,this.section,r).do();case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),t.e(e.t0);case 15:return e.prev=15,t.f(),e.finish(15);case 18:e.next=22;break;case 20:return e.next=22,new Ge(this.dbConnector,this.section,this.elements).do();case 22:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));return function(){return e.apply(this,arguments)}}()}]),e}();function mt(e,t){return vt.apply(this,arguments)}function vt(){return(vt=Object(X.a)(Y.a.mark((function e(t,n){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.exec(n));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function xt(e,t){return t.map((function(t){var n={};return t.forEach((function(t,r){return n[e[r]]=t})),n}))}var Ot=function(e){Object(qe.a)(n,e);var t=Object(We.a)(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Object(M.a)(this,n),(i=t.call(this,a)).dbConnector=e,i.section=r,i.results=void 0,i}return Object(L.a)(n,[{key:"single",value:function(){var e=Object(X.a)(Y.a.mark((function e(){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.doSelect();case 2:if(!this.results.length){e.next=4;break}return e.abrupt("return",this.results[0]);case 4:return e.abrupt("return");case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"multiple",value:function(){var e=Object(X.a)(Y.a.mark((function e(){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.doSelect();case 2:return e.abrupt("return",this.results);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"count",value:function(){var e=Object(X.a)(Y.a.mark((function e(){var t,n;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new ut(this.dbConnector,this.section).count(this.whereArgs),e.next=3,mt(this.dbConnector.dbStore.db,t);case 3:if((n=e.sent).length){e.next=6;break}return e.abrupt("return",0);case 6:return e.abrupt("return",n[0].values[0][0]);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"doSelect",value:function(){var e=Object(X.a)(Y.a.mark((function e(){var t,n,r;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.count(),n=new ut(this.dbConnector,this.section).select(this.whereArgs),e.next=4,mt(this.dbConnector.dbStore.db,n);case 4:if((r=e.sent).length){e.next=8;break}return this.results=[],e.abrupt("return");case 8:if(this.results=xt(r[0].columns,r[0].values),!this.dbConnector.options.encrypted){e.next=12;break}return e.next=12,this.handleDecryption();case 12:(null===(t=this.dbConnector.DS[this.section].jsonFields)||void 0===t?void 0:t.length)&&this.parseJsonFields();case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"parseJsonFields",value:function(){var e=this;this.results.forEach((function(t){for(var n in t)e.dbConnector.DS[e.section].jsonFields.includes(n)&&(t[n]=JSON.parse(t[n]))}))}},{key:"handleDecryption",value:function(){var e=Object(X.a)(Y.a.mark((function e(){var t;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.dbConnector.options.encrypted||!this.results.length){e.next=8;break}t=0;case 2:if(!(t<this.results.length)){e.next=8;break}return e.next=5,new $e(this.dbConnector,this.section,this.results[t]).do();case 5:t++,e.next=2;break;case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(lt),yt=function(){function e(t,n){Object(M.a)(this,e),this.dbStore=t,this.DS=n,this.sql=""}return Object(L.a)(e,[{key:"createSchema",value:function(){var e=Object(X.a)(Y.a.mark((function e(){var t;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t in this.DS)this.handleTable(this.DS[t].name,this.DS[t].fields);return e.next=3,this.dbStore.db.run(this.sql);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"handleTable",value:function(e,t){this.sql+="DROP TABLE IF EXISTS '".concat(e,"'; CREATE TABLE '").concat(e,"' (").concat(this.createFields(t),");")}},{key:"createFields",value:function(e){var t,n="",r=Object(ye.a)(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;n+="".concat(i," TEXT,")}}catch(a){r.e(a)}finally{r.f()}return n.substring(0,n.length-1)}}]),e}(),gt=n(147),wt=n.n(gt),kt=function(){function e(t,n){Object(M.a)(this,e),this.options=t,this.DS=n,this.db=void 0,this.contents=void 0}return Object(L.a)(e,[{key:"initDB",value:function(){var e=Object(X.a)(Y.a.mark((function e(){var t;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.options.projectInfo){e.next=2;break}throw new Error("No projectInfo passed to DbConnector.\nTo retrieve a project from a local file, pass the an Object of type LocalProjectSettings as value of projectInfo to the options of DbConnector");case 2:return e.next=4,nt(this.options,"SQLite Project Database",{"application/x-sqlite3":[".db"]});case 4:if(t=e.sent,!this.options.projectInfo.fileHandle){e.next=10;break}return e.next=8,this.initializeExistingProject();case 8:e.next=12;break;case 10:return e.next=12,this.onProjectCreation(t);case 12:return e.abrupt("return",this);case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"postProjectCreation",value:function(){var e=Object(X.a)(Y.a.mark((function e(){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.makeDSFromDB();case 2:return e.abrupt("return",{fileHandle:this.options.projectInfo.fileHandle});case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"postProjectUpdate",value:function(){var e=Object(X.a)(Y.a.mark((function e(){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{fileHandle:this.options.projectInfo.fileHandle});case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"close",value:function(){}},{key:"initializeExistingProject",value:function(){var e=Object(X.a)(Y.a.mark((function e(){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.doReadFile();case 2:return e.next=4,this.loadDB(this.contents);case 4:return e.next=6,this.makeDSFromDB();case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onProjectCreation",value:function(){var e=Object(X.a)(Y.a.mark((function e(t){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Object.assign(this.options.projectInfo,{fileHandle:t}),e.next=3,this.loadDB();case 3:return e.next=5,new yt(this,this.DS).createSchema();case 5:return e.next=7,ft(this.db,this.options.projectInfo.fileHandle,this.options.projectInfo.id);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"doReadFile",value:function(){var e=Object(X.a)(Y.a.mark((function e(){var t;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat(this.options.projectInfo.id,".db"),e.next=3,_e(this.options.projectInfo.fileHandle,t);case 3:this.contents=e.sent;case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"makeDSFromDB",value:function(){var e=Object(X.a)(Y.a.mark((function e(){var t,n;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,mt(this.db,"SELECT * FROM _sections");case 2:t=e.sent,(n=xt(t[0].columns,t[0].values)).forEach((function(e){ae.jsonFields.forEach((function(t){e[t]=JSON.parse(e[t])}))})),Object.assign(this.DS,new ve(n).extend());case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadDB",value:function(){var e=Object(X.a)(Y.a.mark((function e(t){var n;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,wt()({locateFile:function(){return"".concat("/app","/assets/sql-wasm.wasm")}});case 2:n=e.sent,this.db=new n.Database(t);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),St={insertor:jt,selector:Ot,updator:function(){function e(t,n,r){Object(M.a)(this,e),this.dbConnector=t,this.section=n,this.elements=r}return Object(L.a)(e,[{key:"autoUpdate",value:function(){var e=Object(X.a)(Y.a.mark((function e(){var t,n,r,i;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.dbConnector.options.encrypted){e.next=3;break}return e.next=3,this.handleEncryption();case 3:if(t=[],this.elements instanceof Array){n=Object(ye.a)(this.elements);try{for(n.s();!(r=n.n()).done;)i=r.value,t.push(this.buildQuery(i))}catch(a){n.e(a)}finally{n.f()}}else t.push(this.buildQuery(this.elements));return dt(this.dbConnector,t.join(";")),e.next=8,ft(this.dbConnector.dbStore.db,this.dbConnector.options.projectInfo.fileHandle,this.dbConnector.options.projectInfo.id);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"buildQuery",value:function(e){var t,n=Object(i.a)({},e);if(null===(t=this.dbConnector.DS[this.section].jsonFields)||void 0===t?void 0:t.length){var r,a=Object(ye.a)(this.dbConnector.DS[this.section].jsonFields);try{for(a.s();!(r=a.n()).done;){var c=r.value;n[c]=JSON.stringify(n[c])}}catch(o){a.e(o)}finally{a.f()}}return new ut(this.dbConnector,this.section,n).update()}},{key:"handleEncryption",value:function(){var e=Object(X.a)(Y.a.mark((function e(){var t,n,r;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.elements=Object(ct.cloneDeep)(this.elements),!(this.elements instanceof Array)){e.next=21;break}t=Object(ye.a)(this.elements),e.prev=3,t.s();case 5:if((n=t.n()).done){e.next=11;break}return r=n.value,e.next=9,new Ge(this.dbConnector,this.section,r).do();case 9:e.next=5;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),t.e(e.t0);case 16:return e.prev=16,t.f(),e.finish(16);case 19:e.next=23;break;case 21:return e.next=23,new Ge(this.dbConnector,this.section,this.elements).do();case 23:case"end":return e.stop()}}),e,this,[[3,13,16,19]])})));return function(){return e.apply(this,arguments)}}()}]),e}(),deletor:bt,dbStore:kt},It=function(){function e(t,n,r){Object(M.a)(this,e),this.projectInfo=t,this.projectSections=n,this.fileHandle=r,this.projectId=void 0,this.projectId=t.id}return Object(L.a)(e,[{key:"init",value:function(){var e=Object(X.a)(Y.a.mark((function e(){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.projectInfo.localStorage!=u.fileSystem){e.next=5;break}return e.next=3,this.doFileSystem();case 3:e.next=12;break;case 5:if(this.projectInfo.localStorage!=u.SQLite){e.next=10;break}return e.next=8,this.doSQLite();case 8:e.next=12;break;case 10:return e.next=12,this.doIndexedDb();case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"doFileSystem",value:function(){var e=Object(X.a)(Y.a.mark((function e(){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.fileHandle&&(this.projectInfo=Object(i.a)(Object(i.a)({},this.projectInfo),{},{fileHandle:this.fileHandle})),e.next=3,new me(at,{projectInfo:this.projectInfo}).init();case 3:$[this.projectId]=e.sent;case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"doSQLite",value:function(){var e=Object(X.a)(Y.a.mark((function e(){var t,n;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.fileHandle&&(this.projectInfo=Object(i.a)(Object(i.a)({},this.projectInfo),{},{fileHandle:this.fileHandle})),this.projectSections&&(n=new ve(this.projectSections)).extend(),e.next=4,new me(St,{projectInfo:this.projectInfo},null===(t=n)||void 0===t?void 0:t.allSez).init();case 4:$[this.projectId]=e.sent;case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"doIndexedDb",value:function(){var e=Object(X.a)(Y.a.mark((function e(){var t;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.projectSections){e.next=8;break}return(t=new ve(this.projectSections)).extend(),e.next=5,new me(Se,{previousVersions:[],indexedDbName:this.projectId},t.allSez).init();case 5:$[this.projectId]=e.sent,e.next=12;break;case 8:if(!this.projectInfo.dexieInfoForUpgrade){e.next=12;break}return e.next=11,new me(Se,{previousVersions:this.projectInfo.dexieInfoForUpgrade.previousVersions,DS:this.projectInfo.dexieInfoForUpgrade.DS,indexedDbName:this.projectId}).init();case 11:$[this.projectId]=e.sent;case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),Nt=function(){function e(t,n){Object(M.a)(this,e),this.projectSettings=t,this.sectionsDefinitions=n}return Object(L.a)(e,[{key:"set",value:function(){var e;J.dispatch({type:r.setCurrentProject,payload:(e={},Object(o.a)(e,F._settings,this.projectSettings.concat()),Object(o.a)(e,F._sections,this.sectionsDefinitions.concat()),e)})}}]),e}(),Ct=function(){function e(t,n){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];Object(M.a)(this,e),this.projectId=t,this.projectInfo=n,this.setProject=r,this.projectSettings=void 0,this.projectSections=void 0}return Object(L.a)(e,[{key:"loadProject",value:function(){var e=Object(X.a)(Y.a.mark((function e(){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.projectInfo){e.next=3;break}return e.next=3,this.setProjectInfoFromIndexedDB();case 3:return e.next=5,this.createNewInstanceOfDbConnectorForrProject();case 5:return e.next=7,this.loadProjectSettings();case 7:return e.next=9,this.loadProjectSections();case 9:this.setProject&&this.callCurrentProjectSetter();case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setProjectInfoFromIndexedDB",value:function(){var e=Object(X.a)(Y.a.mark((function e(){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$.system.callSelector(ne.projects,{id:this.projectId}).single();case 2:this.projectInfo=e.sent;case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"createNewInstanceOfDbConnectorForrProject",value:function(){var e=Object(X.a)(Y.a.mark((function e(){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new It(this.projectInfo).init();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadProjectSettings",value:function(){var e=Object(X.a)(Y.a.mark((function e(){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$[this.projectId].callSelector(F._settings).multiple();case 2:this.projectSettings=e.sent;case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadProjectSections",value:function(){var e=Object(X.a)(Y.a.mark((function e(){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$[this.projectId].callSelector(F._sections).multiple();case 2:this.projectSections=e.sent;case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"callCurrentProjectSetter",value:function(){new Nt(this.projectSettings,this.projectSections).set()}}]),e}();function Dt(e){return Et.apply(this,arguments)}function Et(){return(Et=Object(X.a)(Y.a.mark((function e(t){var n,r,i,a=arguments;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=!(a.length>1&&void 0!==a[1])||a[1],"function"!==typeof(null===$||void 0===$||null===(n=$[t])||void 0===n?void 0:n.callSelector)){e.next=3;break}return e.abrupt("return",!0);case 3:return e.next=5,$.system.callSelector(ne.projects,{id:t}).single();case 5:if((i=e.sent).localStorage!=u.IndexedDB){e.next=10;break}return e.next=9,new Ct(t,i,r).loadProject();case 9:return e.abrupt("return",!0);case 10:return e.abrupt("return",!1);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ft=function(){function e(t,n){Object(M.a)(this,e),this.childOf=t,this.sections=n,this.parentInfoFormModel=void 0,this.options=[]}return Object(L.a)(e,[{key:"build",value:function(){return this.setOptions(),this.setParentSelector(),this.parentInfoFormModel}},{key:"setOptions",value:function(){var e=this;this.childOf.forEach((function(t){var n=e.sections.find((function(e){return e.id===t}));e.options.push({value:t,label:n.title})}))}},{key:"setParentSelector",value:function(){this.parentInfoFormModel={componentCode:a.parentsSelector,fieldName:l.parentsInfo,label:"Parent elements",options:this.options}}}]),e}();function Pt(e,t){return e.find((function(e){return e.id===t}))}var At=n(0),Tt=function(e){var t=e.children,n=e.width;return Object(At.jsx)("div",{className:"".concat(n," my-3 px-2 inline-block align-top"),children:t})},_t=function(e){var t=e.label;return Object(At.jsx)("label",{className:"w-full block mb-0 ml-1 text-gray-700 text-sm",children:t})},Mt=function(e){var t=e.formEle,n=e.element,i=e.fieldId,a=e.touched,c=n[t.fieldName];return Object(Ne.useEffect)((function(){J.dispatch({type:r.setValidStateForEle,payload:{formEleId:"".concat(i,"-required"),valid:""!==c&&void 0!==c&&null!==c}})}),[c,i]),c||!a?Object(At.jsx)("div",{className:"ml-1 text-xs italic text-gray-400",children:"Required"}):Object(At.jsx)("div",{className:"ml-1 text-red-600 text-xs italic",children:"This field is required"})},Lt=function(e){var t=[];return e.formEle.required&&t.push(Object(At.jsx)(Mt,Object(i.a)({},e),"required-validator")),Object(At.jsx)("span",{children:t})},Bt=n(23),Vt=n.n(Bt),Ut=n(10),Rt=function(e){var t=e.formEle,n=e.element,i=e.handleChange,a=Object(Ne.useState)(!1),c=Object(Fe.a)(a,2),o=c[0],s=c[1],u=Object(Ne.useRef)(Vt()(t.fieldName)).current,l=Object(Ut.b)((function(e){return e.formElesValidState})),d=Object.keys(l).some((function(e){return e.startsWith(u)&&!1===l[e]}));Object(Ne.useEffect)((function(){return function(){J.dispatch({type:r.unsetValidStateForEle,payload:u})}}),[u]);var h=t.width?t.width:"w-full";return Object(At.jsxs)(Tt,{width:h,children:[Object(At.jsx)(_t,{label:t.label}),Object(At.jsx)("input",{name:t.fieldName,type:"checkbox",checked:!(!Reflect.has(n,t.fieldName)||"boolean"!==typeof n[t.fieldName])&&n[t.fieldName],className:"rounded mt-3 ".concat(d&&o?"text-red-600 border border-red-600":"text-prussian-blue-500"),onChange:function(e){return i(t.fieldName,e.target.checked)},onBlur:function(){return s(!0)}},t.fieldName),Object(At.jsx)(Lt,{formEle:t,element:n,fieldId:u,touched:o})]})};function Ht(e){switch(e){case"1":return"w-full lg:w-1/12";case"2":return"w-full lg:w-2/12";case"3":return"w-full lg:w-3/12";case"4":return"w-full lg:w-4/12";case"5":return"w-full lg:w-5/12";case"6":return"w-full lg:w-6/12";case"7":return"w-full lg:w-7/12";case"8":return"w-full lg:w-8/12";case"9":return"w-full lg:w-9/12";case"10":return"w-full lg:w-10/12";case"11":return"w-full lg:w-11/12";case"12":return"w-full lg:w-12/12";default:return"w-full"}}var qt="rounded-md border border-gray-300 hover:border-gray-400 focus:border-prussian-blue-500 focus:ring-0",Wt="rounded-md border-2 border-red-300 hover:border-red-400 focus:border-red-200 focus:ring-0",zt=function(e){var t=e.formEle,n=e.element,i=e.handleChange,a=Object(Ne.useState)(!1),c=Object(Fe.a)(a,2),o=c[0],s=c[1],u=Object(Ne.useRef)(Vt()(t.fieldName)).current,l=Object(Ut.b)((function(e){return e.formElesValidState})),d=Object.keys(l).some((function(e){return e.startsWith(u)&&!1===l[e]}));Object(Ne.useEffect)((function(){return function(){J.dispatch({type:r.unsetValidStateForEle,payload:u})}}),[u]);var h=t.width?Ht(t.width):"w-full";return void 0!==n[t.fieldName]&&null!==n[t.fieldName]||(n[t.fieldName]=""),Object(At.jsxs)(Tt,{width:h,children:[Object(At.jsx)(_t,{label:t.label}),Object(At.jsx)("input",{name:t.fieldName,type:"text",placeholder:t.label,disabled:!!t.disabled&&t.disabled,required:!!t.required&&t.required,className:"w-full ".concat(d&&o?Wt:qt),value:n[t.fieldName],onChange:function(e){return i(t.fieldName,e.target.value)},onBlur:function(){return s(!0)}},t.fieldName),Object(At.jsx)(Lt,{formEle:t,element:n,fieldId:u,touched:o})]})},Kt=n(28),Qt=function(e){var t=e.formEle,n=e.element,i=e.handleChange,a=Object(Ne.useState)(!1),c=Object(Fe.a)(a,2),o=c[0],s=c[1],u=Object(Ne.useRef)(Vt()(t.fieldName)).current,l=Object(Ut.b)((function(e){return e.formElesValidState})),d=Object.keys(l).some((function(e){return e.startsWith(u)&&!1===l[e]}));Object(Ne.useEffect)((function(){return function(){J.dispatch({type:r.unsetValidStateForEle,payload:u})}}),[u]);var h=t.width?t.width:"w-full";return!n[t.fieldName]&&t.value&&(n[t.fieldName]=t.value),Object(At.jsxs)(Tt,{width:h,children:[Object(At.jsx)(_t,{label:t.label}),Object(At.jsx)("div",{className:"mt-2 pl-1",children:t.options.map((function(e,r){return Object(At.jsxs)("div",{className:"mb-2",children:[Object(At.jsx)("input",{type:"radio",value:e.value,name:t.fieldName,checked:n[t.fieldName]==e.value,disabled:!(!e.disabled&&!t.disabled),className:"".concat(d&&o?"bg-red-600 text-red-600":"bg-gray-200 text-prussian-blue-500"," mr-2 border-transparent focus:border-gray-500 focus:text-prussian-blue-600 focus:ring-prussian-blue-600"),onChange:function(e){return i(t.fieldName,e.target.value)},onBlur:function(){return s(!0)}}),Object(At.jsx)("span",{className:e.disabled||t.disabled?"text-gray-300 cursor-not-allowed":"",children:e.label}),e.hint&&Object(At.jsxs)("span",{children:[Object(At.jsx)("sup",{children:Object(At.jsx)("i",{className:"ml-1 text-xs bi-info-circle","data-tip":!0,"data-for":"".concat(u).concat(r)})}),Object(At.jsx)(Kt.a,{id:"".concat(u).concat(r),effect:"solid","data-multiline":!0,className:"msg-wrapper text-center",children:Object(At.jsx)("span",{children:e.hint})})]})]},e.value)}))}),Object(At.jsx)(Lt,{formEle:t,element:n,fieldId:u,touched:o})]},t.fieldName)},Jt=function(e){var t=e.formEle,n=e.element,i=e.handleChange,a=Object(Ne.useState)(!1),c=Object(Fe.a)(a,2),o=c[0],s=c[1],u=Object(Ne.useRef)(Vt()(t.fieldName)).current,l=Object(Ut.b)((function(e){return e.formElesValidState})),d=Object.keys(l).some((function(e){return e.startsWith(u)&&!1===l[e]}));Object(Ne.useEffect)((function(){return function(){J.dispatch({type:r.unsetValidStateForEle,payload:u})}}),[u]);var h=t.width?Ht(t.width):"w-full";return Object(At.jsxs)(Tt,{width:h,children:[Object(At.jsx)(_t,{label:t.label}),Object(At.jsxs)("select",{className:"w-full ".concat(d&&o?Wt:qt),value:n[t.fieldName],onChange:function(e){return i(t.fieldName,e.target.value)},onBlur:function(){return s(!0)},children:[Object(At.jsx)("option",{value:"",children:"Please chose one"}),t.options.map((function(e,t){return Object(At.jsx)("option",{value:e.value,children:e.label},t)}))]}),Object(At.jsx)(Lt,{formEle:t,element:n,fieldId:u,touched:o})]})},Gt=function(e){var t=e.formEle,n=e.element,i=e.handleChange,a=Object(Ne.useState)(!1),c=Object(Fe.a)(a,2),o=c[0],s=c[1],u=Object(Ne.useRef)(Vt()(t.fieldName)).current,l=Object(Ut.b)((function(e){return e.formElesValidState})),d=Object.keys(l).some((function(e){return e.startsWith(u)&&!1===l[e]}));Object(Ne.useEffect)((function(){return function(){J.dispatch({type:r.unsetValidStateForEle,payload:u})}}),[u]);var h=t.width?t.width:"w-full";return void 0!==n[t.fieldName]&&null!==n[t.fieldName]||(n[t.fieldName]=""),Object(At.jsxs)(Tt,{width:h,children:[Object(At.jsx)(_t,{label:t.label}),Object(At.jsx)("textarea",{name:t.fieldName,className:"w-full ".concat(d&&o?Wt:qt),value:n[t.fieldName],onChange:function(e){return i(t.fieldName,e.target.value)},onBlur:function(){return s(!0)}}),Object(At.jsx)(Lt,{formEle:t,element:n,fieldId:u,touched:o})]})};function Yt(e){var t=[];return e.forEach((function(e){t.push(e.value)})),t}function Xt(e,t){var n=[];return e&&t?(e.forEach((function(e){var r=t.find((function(t){return t.options.find((function(t){return t.value===e}))}));if(r){var i=r.options.find((function(t){return t.value===e}));i&&n.push(i)}})),n):n}function $t(e,t){var n=[];return e&&t?(e.forEach((function(e){var r=t.find((function(t){return t.value===e}));r&&n.push(r)})),n):n}var Zt=n(63),en=function(e){var t=e.formEle,n=e.element,i=e.handleChange,a=e.sectionId,c=Object(Ut.b)((function(e){return e.formProject.project[F._sections]})),o=Object(Ne.useState)([]),s=Object(Fe.a)(o,2),u=s[0],l=s[1],d=Object(Ne.useState)(!1),h=Object(Fe.a)(d,2),f=h[0],p=h[1],b=Object(Ne.useRef)(Vt()(t.fieldName)).current,j=Object(Ut.b)((function(e){return e.formElesValidState})),m=Object.keys(j).some((function(e){return e.startsWith(b)&&!1===j[e]}));Object(Ne.useEffect)((function(){return function(){J.dispatch({type:r.unsetValidStateForEle,payload:b})}}),[b]),Object(Ne.useEffect)((function(){var e=!0;return e&&function(){if(Array.isArray(c)){var e=[];c.forEach((function(t){t.id!==a&&e.push({value:t.id,label:t.title})})),l(e)}}(),function(){e=!1}}),[c,c.length,a]);return 0===u.length?null:Object(At.jsxs)(Tt,{width:"w-full",children:[Object(At.jsx)(_t,{label:t.label}),Object(At.jsx)(Zt.a,{defaultValue:$t(n[t.fieldName],u),isMulti:!0,name:t.fieldName,options:u,className:m&&f?"border border-red-600 rounded":"",onChange:function(e){i(t.fieldName,Yt(e))},onBlur:function(){return p(!0)}}),Object(At.jsx)(Lt,{formEle:t,element:n,fieldId:b,touched:f})]})},tn=n(29),nn=function(e){var t=e.formEle,n=e.element,i=e.handleChange,a=Object(Ne.useState)(!1),c=Object(Fe.a)(a,2),o=c[0],s=c[1],u=Object(Ne.useRef)(Vt()(t.fieldName)).current,l=Object(Ut.b)((function(e){return e.formElesValidState})),d=Object.keys(l).some((function(e){return e.startsWith(u)&&!1===l[e]}));Object(Ne.useEffect)((function(){return function(){J.dispatch({type:r.unsetValidStateForEle,payload:u})}}),[u]);var h=t.width?t.width:"w-full";return Object(At.jsxs)(Tt,{width:h,children:[Object(At.jsx)(_t,{label:t.label}),Object(At.jsx)("input",{name:t.fieldName,type:"date",placeholder:t.label,className:"w-full ".concat(d&&o?Wt:qt),value:tn("yyyy-MM-ddThh:mm:ss",new Date(n[t.fieldName])),onChange:function(e){return i(t.fieldName,e.target.value)},onBlur:function(){return s(!0)}},t.fieldName),Object(At.jsx)(Lt,{formEle:t,element:n,fieldId:u,touched:o})]})},rn=function(e){var t=e.formEle,n=e.element,i=e.handleChange,a=Object(Ne.useState)(!1),c=Object(Fe.a)(a,2),o=c[0],s=c[1],u=Object(Ne.useRef)(Vt()(t.fieldName)).current,l=Object(Ut.b)((function(e){return e.formElesValidState})),d=Object.keys(l).some((function(e){return e.startsWith(u)&&!1===l[e]}));Object(Ne.useEffect)((function(){return function(){J.dispatch({type:r.unsetValidStateForEle,payload:u})}}),[u]);var h=t.width?Ht(t.width):"w-full";return Object(At.jsxs)(Tt,{width:h,children:[Object(At.jsx)(_t,{label:t.label}),Object(At.jsx)("input",{name:t.fieldName,type:"datetime-local",placeholder:t.label,className:"w-full ".concat(d&&o?Wt:qt),value:tn("yyyy-MM-ddThh:mm:ss",new Date(n[t.fieldName])),onChange:function(e){return i(t.fieldName,e.target.value)},onBlur:function(){return s(!0)}},t.fieldName),Object(At.jsx)(Lt,{formEle:t,element:n,fieldId:u,touched:o})]})},an=function(e){var t=e.formEle,n=e.element,r=e.handleChange;return void 0!==n[t.fieldName]&&null!==n[t.fieldName]||(n[t.fieldName]=""),Object(At.jsx)("input",{name:t.fieldName,type:"hidden",value:n[t.fieldName],onChange:function(e){return r(t.fieldName,e.target.value)}},t.fieldName)},cn="bg-transparent hover:".concat("bg-green-500"," ").concat("text-green-700"," font-semibold hover:text-white border ").concat("border-green-500"," hover:border-transparent rounded"),on="bg-transparent hover:".concat("bg-red-500"," ").concat("text-red-700"," font-semibold hover:text-white border ").concat("border-red-500"," hover:border-transparent rounded");var sn=function(e){var t=e.formEle,n=e.element,r=e.handleOptionsChange,i=e.handleClickDeleteOption,a=e.indexSection,c=e.indexFormElement,o=e.index,s=e.optionElement,u=Object(Ut.b)((function(e){return e.formProject.mode})),l=Object(Ut.b)((function(e){return e.formProject.original[F._sections][a]})),d=Object(Ne.useMemo)((function(){!function(e,t,n){!(e&&e.formModel[t]&&e.formModel[t].options&&e.formModel[t].options.length)||e.formModel[t].options.some((function(e){return e.value===n}))}(l,c,s.value);return P[u].optionEles.newItem}),[l,c,s.value,u]);return Object(At.jsxs)("li",{children:[Object(At.jsx)(vn,{formModel:d,element:s,handleChange:r.bind(void 0,o,s)}),"function"===typeof i&&n[t.fieldName].length>2&&Object(At.jsxs)("div",{className:"inline-block w-full lg:w-1/12 px-2 lg:pl-1 lg:pr-3 lg:align-bottom mb-8",children:[Object(At.jsxs)("button",{onClick:i.bind(void 0,o),"data-tip":!0,"data-for":"deleteOption-".concat(o),className:"w-full py-1 ".concat(on),children:[Object(At.jsx)("i",{className:"bi-trash hidden lg:block"}),Object(At.jsxs)("span",{className:"lg:hidden",children:["Delete option ",o+1]})]}),Object(At.jsx)(Kt.a,{id:"deleteOption-".concat(o),effect:"solid",children:Object(At.jsxs)("span",{children:["Delete option ",o+1]})})]})]})},un=function(e){var t=e.formEle,n=e.element,r=e.handleOptionsChange,a=e.handleClickAddOption;return"function"!==typeof r?null:(n[t.fieldName]&&Array.isArray(n[t.fieldName])&&n[t.fieldName].length||(n[t.fieldName]=Array.from(Array(2),(function(e,t){return{label:"",value:t+1}}))),Object(At.jsxs)("div",{className:"mt-6 pl-10 py-4 bg-gray-50 rounded-lg",children:[Object(At.jsx)("p",{className:"-ml-5 font-semibold mb-1",children:"Choices"}),Object(At.jsx)("ol",{className:"list-decimal",children:n[t.fieldName].map((function(t,n){return Object(At.jsx)(sn,Object(i.a)({index:n,optionElement:t},e),n)}))}),"function"===typeof a&&Object(At.jsx)("div",{className:"flex items-end",children:Object(At.jsx)("button",{className:"ml-auto mr-4 mt-3 py-2 px-3 ".concat(cn),onClick:a,children:"Add option"})})]}))};function ln(e){var t=void 0;return e.some((function(e,n){return!l[e.fieldName]&&(t=n,!0)})),t}function dn(e){var t=e.toLowerCase(),n={a:"[\xe0\xe1\xe2\xe3\xe4\xe5]",ae:"\xe6",c:"\xe7",e:"[\xe8\xe9\xea\xeb]",i:"[\xec\xed\xee\xef]",n:"\xf1",o:"[\xf2\xf3\xf4\xf5\xf6]",oe:"\u0153",u:"[\xf9\xfa\xfb\u0171\xfc]",y:"[\xfd\xff]"};for(var r in n)t=t.replace(new RegExp(n[r],"g"),r);return t.replace(/\s/g,"-").replace(/[^\w-]/gi,"")}function hn(e,t){return fn.apply(this,arguments)}function fn(){return(fn=Object(X.a)(Y.a.mark((function e(t,n){var r,i;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.length,i=0;case 2:if(!(i<r)){e.next=8;break}return e.next=5,n(t[i],i,t);case 5:i++,e.next=2;break;case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var pn=function(){function e(t,n){Object(M.a)(this,e),this.project=t,this.options=n,this.optionsGroups=[]}return Object(L.a)(e,[{key:"buildOptions",value:function(){var e=Object(X.a)(Y.a.mark((function e(){var t=this;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,hn(this.options,function(){var e=Object(X.a)(Y.a.mark((function e(n){var r;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$[t.project[F._settings][0].id].callSelector(n.value).multiple();case 2:(r=e.sent).length&&t.createGroupOption(n.value,n.label,r);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:return e.abrupt("return",this.optionsGroups);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"createGroupOption",value:function(e,t,n){var r=[],i=Pt(this.project[F._sections],e),a=ln(i.formModel);n.forEach((function(t){return r.push({value:"".concat(e,"|").concat(t.id),label:t[i.formModel[a].fieldName]})})),this.optionsGroups.push({label:t,options:r})}}]),e}(),bn=function(e){var t=e.formEle,n=e.element,i=e.handleChange,a=Object(Ne.useState)([]),c=Object(Fe.a)(a,2),o=c[0],s=c[1],u=Object(Ut.b)((function(e){return e.project})),l=Object(Ne.useState)(!1),d=Object(Fe.a)(l,2),h=d[0],f=d[1],p=Object(Ne.useRef)(Vt()(t.fieldName)).current,b=Object(Ut.b)((function(e){return e.formElesValidState})),j=Object.keys(b).some((function(e){return e.startsWith(p)&&!1===b[e]}));Object(Ne.useEffect)((function(){return function(){J.dispatch({type:r.unsetValidStateForEle,payload:p})}}),[p]),Object(Ne.useEffect)((function(){var e=!0;return e&&function(){var n=Object(X.a)(Y.a.mark((function n(){var r;return Y.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,new pn(u,t.options).buildOptions();case 2:r=n.sent,e&&s(r);case 4:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}()(),function(){e=!1}}),[u,t.options]);return 0===o.length?null:Object(At.jsxs)(Tt,{width:"w-full",children:[Object(At.jsx)(_t,{label:t.label}),Object(At.jsx)(Zt.a,{defaultValue:Xt(n[t.fieldName],o),isMulti:!0,name:t.fieldName,options:o,className:j&&h?"border border-red-600 rounded":"",onChange:function(e){i(t.fieldName,Yt(e))},onBlur:function(){return f(!0)}}),Object(At.jsx)(Lt,{formEle:t,element:n,fieldId:p,touched:h})]})};var jn=function(){function e(t,n){Object(M.a)(this,e),this.formEle=t,this.objValues=n,this.isIntegrated=!1}return Object(L.a)(e,[{key:"integrates",value:function(){return!this.formEle.prerequisites||!this.formEle.prerequisites.length||(this.loopPrerequisites(),this.isIntegrated)}},{key:"loopPrerequisites",value:function(){for(var e=0;!1===this.isIntegrated&&e<this.formEle.prerequisites.length;)this.checkPrerequisites(this.formEle.prerequisites[e]),e++}},{key:"checkPrerequisites",value:function(e){var t=this,n=function(n){t.objValues[n]&&e[n].filter((function(e){return e==t.objValues[n]})).length>0&&t.setIsIntegrated()};for(var r in e)n(r)}},{key:"setIsIntegrated",value:function(){this.isIntegrated=!0}}]),e}(),mn=function(e){return Object(Ne.useMemo)((function(){return new jn(e.formEle,e.element).integrates()}),[e.formEle,e.element])?function(e,t,n){switch(t){case a.hiddenInput:return Object(At.jsx)(an,Object(i.a)({},n),e);case a.basicInput:return Object(At.jsx)(zt,Object(i.a)({},n),e);case a.basicSelect:return Object(At.jsx)(Jt,Object(i.a)({},n),e);case a.basicTextarea:return Object(At.jsx)(Gt,Object(i.a)({},n),e);case a.basicCheckbox:return Object(At.jsx)(Rt,Object(i.a)({},n),e);case a.basicRadio:return Object(At.jsx)(Qt,Object(i.a)({},n),e);case a.datePicker:return Object(At.jsx)(nn,Object(i.a)({},n),e);case a.dateTimePicker:return Object(At.jsx)(rn,Object(i.a)({},n),e);case a.optionsMaker:return Object(At.jsx)(un,Object(i.a)({},n),e);case a.childOfSelectorForSection:return Object(At.jsx)(en,Object(i.a)({},n),e);case a.parentsSelector:return Object(At.jsx)(bn,Object(i.a)({},n),e);default:return Object(At.jsx)(zt,Object(i.a)({},n),e)}}(e.formEle.fieldName,e.formEle.componentCode,e):null},vn=function(e){return Object(At.jsx)("span",{children:e.formModel.map((function(t){return Object(At.jsx)(mn,Object(i.a)({formEle:t},e),t.fieldName)}))})},xn=function(e){var t=e.sectionId,n=Object(Ut.b)((function(e){return e.project}))[F._sections],a=Pt(n,t),c=Object(Ut.b)((function(e){return e.formElement.element})),s=function(e,t){J.dispatch({type:r.updateFormElement,payload:Object(i.a)(Object(i.a)({},c),{},Object(o.a)({},e,t))})};return Object(At.jsxs)("form",{name:"element-form",children:[a.childOf&&a.childOf.length>0&&Object(At.jsx)(vn,{formModel:[new Ft(a.childOf,n).build()],element:c,handleChange:s}),Object(At.jsx)(vn,{formModel:a.formModel,element:c,handleChange:s})]})},On=function(){function e(t,n,r,i){Object(M.a)(this,e),this.projectId=t,this.sectionId=n,this.element=r,this.mode=i,this.sectionModelInDS=void 0}return Object(L.a)(e,[{key:"save",value:function(){var e=Object(X.a)(Y.a.mark((function e(){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.setSectionModel(),this.checkAndSetPk(),this.setcreatedAt(),this.deleteEmptyProps(),this.mode!==fe.add){e.next=9;break}return e.next=7,$[this.projectId].callInsertor(this.sectionId,this.element).autoInsert();case 7:e.next=12;break;case 9:return this.setupdatedAtValueIfInEditMode(),e.next=12,$[this.projectId].callUpdator(this.sectionId,this.element).autoUpdate();case 12:return e.abrupt("return",this.element);case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setSectionModel",value:function(){this.sectionModelInDS=$[this.projectId].DS[this.sectionId]}},{key:"checkAndSetPk",value:function(){this.element[this.sectionModelInDS.pk]||(this.element[this.sectionModelInDS.pk]=V.make(this.sectionModelInDS.name))}},{key:"deleteEmptyProps",value:function(){for(var e in this.element)""===this.element[e]&&delete this.element[e]}},{key:"setcreatedAt",value:function(){this.sectionModelInDS.fields.includes(l.createdAt)&&!this.element[l.createdAt]&&(this.element[l.createdAt]=new Date((new Date).toUTCString()).toISOString())}},{key:"setupdatedAtValueIfInEditMode",value:function(){this.sectionModelInDS.fields.includes(l.updatedAt)&&(this.element[l.updatedAt]=new Date((new Date).toUTCString()).toISOString())}}]),e}(),yn=n(11),gn=function(e){var t=e.sectionId,n=Object(Ut.b)((function(e){return e.project})),r=Object(Ut.b)((function(e){return e.formElement.element})),i=Object(Ut.b)((function(e){return e.formElesValidState})),a=Object(yn.g)(),c=function(){var e=Object(X.a)(Y.a.mark((function e(){var i;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r.id?fe.edit:fe.add,e.next=3,new On(n[F._settings][0].id,t,r,i).save();case 3:a(-1);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(At.jsxs)("div",{className:"mt-6 mb-3 px-2 flex justify-end",children:[Object(At.jsx)("button",{className:"py-2 px-6 bg-gray-200 font-semibold rounded hover:bg-gray-300 mr-3",onClick:function(){return a(-1)},children:"Cancel"}),Object(At.jsx)("button",{disabled:Object.keys(i).some((function(e){return!1===i[e]})),className:"py-2 px-6 bg-prussian-blue-400 text-white font-semibold rounded hover:bg-prussian-blue-500",onClick:c,children:"Save"})]})},wn=function(e){var t=e.children,n=e.headerText;return Object(At.jsxs)("div",{className:"p-4 bg-white rounded shadow",children:[n?Object(At.jsxs)("div",{className:"mt-3",children:[Object(At.jsx)("h3",{className:"text-xl font-bold",children:n}),Object(At.jsx)("hr",{className:"mt-4"})]}):null,Object(At.jsx)("div",{className:"pt-4",children:t})]})},kn=function(){return Object(At.jsxs)("svg",{className:"mx-auto my-5 animate-spin h-5 w-5 text-prussian-blue-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[Object(At.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),Object(At.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})},Sn=function(){var e=Object(yn.h)(),t=e[pe.elementId]?fe.edit:fe.add,n=e[pe.projectId],i=e[pe.sectionId],a=t===fe.edit?e[pe.elementId]:null,c=Object(Ne.useState)(null),o=Object(Fe.a)(c,2),s=o[0],u=o[1];if(Object(Ne.useEffect)((function(){var e=!0;return e&&function(){var r=Object(X.a)(Y.a.mark((function r(){var c,o;return Y.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Dt(n);case 2:if(c=r.sent,n&&i&&c){r.next=5;break}return r.abrupt("return",u(void 0));case 5:if(t!==fe.add){r.next=7;break}return r.abrupt("return",u({}));case 7:return r.next=9,$[n].callSelector(i,{id:a}).single();case 9:o=r.sent,e&&u(o);case 11:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}()(),function(){e=!1}}),[t,n,i,a]),void 0===s)return Object(At.jsx)(yn.a,{to:Ee.projectsList});var l=t===fe.add?"Add Element":"Edit Element";return J.dispatch({type:r.updateFormElement,payload:s}),Object(At.jsxs)(wn,{headerText:l,children:[null===s&&Object(At.jsx)(kn,{}),null!==s&&Object(At.jsx)(xn,{sectionId:i}),null!==s&&Object(At.jsx)(gn,{sectionId:i})]})};function In(e,t){var n=e.find((function(e){return e.value==t}));return"undefined"===typeof n?null:n.label}var Nn=function(){function e(t){Object(M.a)(this,e),this.project=t}return Object(L.a)(e,[{key:"delete",value:function(){var e=Object(X.a)(Y.a.mark((function e(){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.callOnProjectDeleted();case 2:return e.next=4,this.doDelete();case 4:this.reloadProjectList();case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"doDelete",value:function(){var e=Object(X.a)(Y.a.mark((function e(){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$.system.callDeletor(ne.projects,{id:this.project.id}).autoDelete();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"callOnProjectDeleted",value:function(){var e=Object(X.a)(Y.a.mark((function e(){var t,n;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Dt(this.project.id,!1);case 2:if(!e.sent){e.next=6;break}return e.next=6,null===(t=(n=$[this.project.id].dbStore).onProjectDeleted)||void 0===t?void 0:t.call(n);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"reloadProjectList",value:function(){(new Ie).load()}}]),e}(),Cn=function(e){var t=e.children;return Object(At.jsx)("div",{className:"mt-2",children:t})},Dn=function(e){var t=e.children,n=e.icon;return Object(At.jsx)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:Object(At.jsxs)("div",{className:"sm:flex sm:items-start",children:[n&&Object(At.jsx)("div",{className:"mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-red-100 sm:mx-0 sm:h-10 sm:w-10",children:Object(At.jsx)("i",{className:"".concat(n," text-xl -mt-1")})}),Object(At.jsx)("div",{className:"sm:flex sm:items-start",children:Object(At.jsx)("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left",children:t})})]})})},En=function(e){var t=e.children;return Object(At.jsx)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:t})},Fn=function(e){var t=e.children;return Object(At.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900",id:"modal-title",children:t})},Pn={confirm:{normal:"bg-prussian-blue-500",hover:"bg-prussian-blue-600",focus:"bg-prussian-blue-800"},alert:{normal:"bg-red-600",hover:"bg-red-700",focus:"bg-red-900"}},An=function(e){var t=e.title,n=e.children,r=e.type,i=e.actionText,a=e.icon,c=e.handleClickAction,o=e.closeFn,s=e.animationClass,u=e.disableAction,l=void 0!==u&&u;return Object(At.jsx)("div",{className:"fixed z-10 inset-0 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true",children:Object(At.jsxs)("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[Object(At.jsx)("div",{className:"animate__animated ".concat(s," animate__faster fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"),"aria-hidden":"true"}),Object(At.jsx)("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"\u200b"}),Object(At.jsxs)("div",{className:"animate__animated ".concat(s," animate__faster inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl sm:my-8 sm:align-middle sm:max-w-lg sm:w-full"),children:[Object(At.jsxs)(Dn,{icon:a,children:[Object(At.jsx)(Fn,{children:t}),Object(At.jsx)(Cn,{children:n})]}),Object(At.jsxs)(En,{children:[Object(At.jsx)("button",{onClick:c,type:"button",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 ".concat(Pn[r].normal," text-base font-medium text-white hover:").concat(Pn[r].focus," focus:outline-none focus:ring-0 focus:").concat(Pn[r].focus," sm:ml-3 sm:w-auto sm:text-sm"),disabled:l,children:i}),Object(At.jsx)("button",{onClick:o,type:"button",className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-0 focus:bg-gray-200 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm",children:"Cancel"})]})]})]})})},Tn=function(e){var t=e.project,n=Object(Ne.useState)(!1),i=Object(Fe.a)(n,2),a=i[0],c=i[1],o=Object(Ne.useState)("animate__fadeIn"),s=Object(Fe.a)(o,2),u=s[0],l=s[1],d=Object(Ut.b)((function(e){return e.project})),h=Object(yn.g)(),f=function(){a?(l("animate__fadeOut"),setTimeout((function(){return c(!1)}),500)):(l("animate__fadeIn"),c(!0))};return Object(At.jsxs)("span",{children:[Object(At.jsxs)("button",{onClick:f,className:"px-4 py-2 text-red-700 inline-flex items-center md:mb-2 lg:mb-0 rounded bg-red-700 bg-opacity-10 hover:bg-opacity-20 text-sm",children:[Object(At.jsx)("i",{className:"bi-trash"}),Object(At.jsx)("span",{className:"ml-2 hidden lg:inline-block",children:"Delete project"})]}),a&&Object(At.jsx)(An,{title:"Delete Project",actionText:"Delete",type:"alert",handleClickAction:function(){var e;f(),(null===d||void 0===d||null===(e=d[F._settings][0])||void 0===e?void 0:e.id)===t.id&&J.dispatch({type:r.resetCurrentProject}),setTimeout((function(){new Nn(t).delete(),h(Ee.projectsList)}),500)},closeFn:f,animationClass:u,icon:"text-red-600 bi-exclamation-triangle",children:Object(At.jsxs)("p",{className:"text-sm text-gray-500",children:["Are you sure you want to delete this project?",Object(At.jsx)("br",{}),Object(At.jsx)("br",{}),"All project data will be permanently removed from this device. This action cannot be undone.",Object(At.jsx)("br",{}),Object(At.jsx)("br",{}),"Data stored on other devices will not be affected."]})})]})};function _n(e,t){var n=e;return t.forEach((function(e){n=n.replace(new RegExp(":".concat(e.name),"g"),e.value)})),n}var Mn=n(18),Ln=function(e){var t=e.project;return Object(At.jsxs)(Mn.b,{to:_n(Ee.projectEdit,[{name:pe.projectId,value:t.id}]),className:"px-4 py-3 text-gray-800 mr-3 inline-flex items-center ml-auto leading-none text-sm bg-gray-100 hover:bg-gray-200 rounded",children:[Object(At.jsx)("i",{className:"bi-pencil"})," ",Object(At.jsx)("span",{className:"ml-2 hidden sm:inline-block",children:"Edit Project"})]})},Bn=function(e){var t=e.children;return Object(At.jsx)("div",{className:"flex items-end flex-wrap mt-6",children:t})},Vn=function(e){var t=e.project;return Object(At.jsxs)("div",{className:"p-6",children:[Object(At.jsx)("h1",{className:"title-font text-lg font-medium text-gray-900 mb-3",children:t.title}),Object(At.jsx)("p",{className:"text-gray-600 text-xs",children:"Description"}),Object(At.jsx)("p",{className:"text-lg mb-3",children:t.description}),Object(At.jsx)("p",{className:"text-gray-600 text-xs",children:"Created on:"}),Object(At.jsx)("p",{className:"text-md mb-3",children:tn("yyyy/MM/dd, at hh:mm",new Date(t.createdAt))}),Object(At.jsx)("p",{className:"text-gray-600 text-xs",children:"Storage method:"}),Object(At.jsx)("p",{className:"text-md",children:In(g,t.localStorage)}),Object(At.jsxs)(Bn,{children:[Object(At.jsx)(Tn,{project:t}),Object(At.jsx)(Ln,{project:t})]})]})},Un=function(){var e=Object(yn.h)()[pe.projectId],t=Object(Ne.useState)(null),n=Object(Fe.a)(t,2),r=n[0],i=n[1];return Object(Ne.useEffect)((function(){var t=!0;return t&&function(){var n=Object(X.a)(Y.a.mark((function n(){var r;return Y.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Dt(e);case 2:if(n.sent){n.next=5;break}return n.abrupt("return",i(void 0));case 5:return n.next=7,$[e].callSelector(F._settings).single();case 7:r=n.sent,t&&i(r);case 9:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}()(),function(){t=!1}}),[e]),void 0===r?Object(At.jsx)(yn.a,{to:Ee.projectsList}):Object(At.jsx)("div",{className:"relative border-2 border-gray-200 border-opacity-60 rounded bg-white",style:{minHeight:"200px"},children:null===r?Object(At.jsx)(kn,{}):Object(At.jsx)(Vn,{project:r})})},Rn=function(e){var t=e.projectId,n=e.sectionId,r=e.elementId,i=Object(Ne.useState)(!1),a=Object(Fe.a)(i,2),c=a[0],o=a[1],s=Object(Ne.useState)("animate__fadeIn"),u=Object(Fe.a)(s,2),l=u[0],d=u[1],h=Object(yn.g)(),f=function(){c?(d("animate__fadeOut"),setTimeout((function(){return o(!1)}),500)):(d("animate__fadeIn"),o(!0))};return Object(At.jsxs)("span",{children:[Object(At.jsx)("button",{"data-tip":!0,"data-for":"deleteElement",onClick:f,className:"".concat(on," mt-6 px-4 py-2"),children:Object(At.jsx)("i",{className:"bi-trash"})}),Object(At.jsx)(Kt.a,{id:"deleteElement",effect:"solid",children:"Delete element"}),c&&Object(At.jsxs)(An,{title:"Delete element",actionText:"Delete",type:"alert",handleClickAction:function(){f(),setTimeout((function(){$[t].callDeletor(n,{id:r}).autoDelete(),h(_n(Ee.projectSectionElesList,[{name:pe.projectId,value:t},{name:pe.sectionId,value:n}]))}),500)},closeFn:f,animationClass:l,icon:"text-red-600 bi-exclamation-triangle",children:[Object(At.jsx)("p",{className:"text-sm text-gray-500",children:"Are you sure you want to delete this element?"}),Object(At.jsx)("p",{className:"text-sm text-gray-500",children:"This action cannot be undone."})]})]})},Hn=function(){function e(t,n,r){Object(M.a)(this,e),this.listOfParents=t,this.projectId=n,this.sections=r,this.parentInfoForDetailsView=[]}return Object(L.a)(e,[{key:"get",value:function(){var e=Object(X.a)(Y.a.mark((function e(){var t=this;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,hn(this.listOfParents,function(){var e=Object(X.a)(Y.a.mark((function e(n){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.processElement(n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:return e.abrupt("return",this.parentInfoForDetailsView);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"processElement",value:function(){var e=Object(X.a)(Y.a.mark((function e(t){var n,r,i,a;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.split("|"),e.next=3,$[this.projectId].callSelector(n[0],Object(o.a)({},l.id,n[1])).single();case 3:r=e.sent,i=Pt(this.sections,n[0]),a=ln(i.formModel),this.parentInfoForDetailsView.push({sectionId:n[0],element:r,txt:r[i.formModel[a].fieldName]});case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),qn=function(e){var t=e.projectId,n=e.parentsInfo,r=e.sections,i=Object(Ne.useState)([]),a=Object(Fe.a)(i,2),c=a[0],o=a[1];return Object(Ne.useEffect)((function(){var e=!0;return e&&function(){var i=Object(X.a)(Y.a.mark((function i(){var a;return Y.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,new Hn(n,t,r).get();case 2:a=i.sent,e&&o(a);case 4:case"end":return i.stop()}}),i)})));return function(){return i.apply(this,arguments)}}()(),function(){e=!1}}),[n,t,r]),Object(At.jsxs)("div",{className:"p-3 pt-0",children:[Object(At.jsx)("p",{className:"text-sm text-gray-500 mb-2",children:"Parent elements:"}),c.map((function(e,n){return Object(At.jsx)(Mn.b,{to:_n(Ee.projectSectionEleDetails,[{name:pe.projectId,value:t},{name:pe.sectionId,value:e.sectionId},{name:pe.elementId,value:e.element.id}]),className:"mr-2 py-1 px-4 bg-gray-200 hover:bg-gray-300 bg-opacity-80 rounded-md text-sm font-semibold",children:e.txt},e.element.id)}))]})},Wn=function(e){return e.value||null},zn=function(e){return e.value?"\u2713":null},Kn=function(e){var t=e.value;return t?tn("yyyy/MM/dd hh:mm",new Date(t)):null},Qn=function(e){var t=e.value;return t?tn("yyyy/MM/dd",new Date(t)):null},Jn=function(e,t){return In(e,t.value)},Gn=function(e){switch(e.componentCode){case a.basicInput:case a.basicTextarea:return Wn;case a.basicSelect:case a.basicRadio:return Jn.bind(null,e.options);case a.basicCheckbox:return zn;case a.datePicker:return Qn;case a.dateTimePicker:return Kn;default:return Wn}},Yn=function(e){var t=e.projectId,n=e.sectionId,r=e.mode,i=e.elementId,a=r===fe.add?"bi-plus":"bi-pencil",c=[{name:pe.projectId,value:t},{name:pe.sectionId,value:n}];r===fe.edit&&c.push({name:pe.elementId,value:i});var o=_n(r===fe.add?Ee.projectSectionAddEle:Ee.projectSectionEditEle,c);return Object(At.jsx)(Mn.b,{to:o,className:"absolute bottom-5 right-7 md:bottom-7 md:right-10 bg-prussian-blue-400 text-white text-xl shadow-xl rounded-3xl h-14 w-14 flex items-center justify-center",children:Object(At.jsx)("i",{className:a})})},Xn=function(){var e=Object(Ne.useState)(null),t=Object(Fe.a)(e,2),n=t[0],r=t[1],i=Object(Ut.b)((function(e){return e.project})),a=Object(yn.h)(),c=a[pe.projectId],o=a[pe.sectionId],s=a[pe.elementId];return Object(Ne.useEffect)((function(){var e=!0;return e&&function(){var t=Object(X.a)(Y.a.mark((function t(){var n,i;return Y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Dt(c);case 2:if(n=t.sent,c&&o&&s&&n){t.next=5;break}return t.abrupt("return",r(void 0));case 5:return t.next=7,$[c].callSelector(o,{id:s}).single();case 7:i=t.sent,e&&r(i);case 9:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()(),function(){e=!1}}),[c,o,s,i]),void 0===n?c&&o?Object(At.jsx)(yn.a,{to:_n(Ee.projectSectionElesList,[{name:pe.projectId,value:c},{name:pe.sectionId,value:o}])}):Object(At.jsx)(yn.a,{to:Ee.projectsList}):Object(At.jsxs)(wn,{headerText:"Details",children:[null===n||null===i?Object(At.jsx)(kn,{}):Object(At.jsx)($n,{element:n,formModels:Pt(i[F._sections],o).formModel}),null!==n&&n.parentsInfo&&Array.isArray(n.parentsInfo)&&n.parentsInfo.length>0&&Object(At.jsx)(qn,{projectId:c,parentsInfo:n.parentsInfo,sections:i[F._sections]}),null!==n&&Object(At.jsxs)("div",{children:[Object(At.jsx)(Rn,{projectId:c,sectionId:o,elementId:s}),Object(At.jsx)(Yn,{projectId:c,sectionId:o,elementId:s,mode:fe.edit})]})]})},$n=function(e){var t=e.element,n=e.formModels;return Object(At.jsx)("div",{className:"p-3",children:n.map((function(e){return e.label?Object(At.jsx)(Zn,{formModel:e,value:t[e.fieldName]},e.fieldName):null}))})},Zn=function(e){var t=e.formModel,n=e.value;return"undefined"===typeof n?null:Object(At.jsxs)("div",{children:[Object(At.jsx)("p",{className:"text-sm text-gray-500",children:t.label}),Object(At.jsx)("p",{className:"mb-3",children:Gn(t)({value:n})})]})},er=function(e){var t=e.children,n=e.tdProps,r=e.elementId,a=Object(yn.g)(),c=Object(yn.h)();return Object(At.jsx)("td",Object(i.a)(Object(i.a)({onClick:function(){return a(_n(Ee.projectSectionEleDetails,[{name:pe.projectId,value:c.projectId},{name:pe.sectionId,value:c.sectionId},{name:pe.elementId,value:r}]))},className:"px-6 py-4 cursor-pointer"},n),{},{children:t}))},tr=n(89),nr=function(e){var t=e.sectionInfo,n=e.sectionData,r=function(e){var t=Object(Ne.useMemo)((function(){return[]}),[e.id,e.formModel]);return Object(Ne.useMemo)((function(){return e.formModel.forEach((function(n){e.id&&n.label&&t.push({Header:n.label,accessor:n.fieldName,Cell:Gn(n)})}))}),[e.id,e.formModel,t]),t}(t),a=Object(tr.useTable)({columns:r,data:n},tr.useSortBy),c=a.getTableProps,o=a.getTableBodyProps,s=a.headerGroups,u=a.rows,l=a.prepareRow;return Object(At.jsxs)("table",Object(i.a)(Object(i.a)({className:"table-auto w-full divide-y divide-gray-200"},c()),{},{children:[Object(At.jsx)("thead",{className:"bg-gray-50",children:s.map((function(e){return Object(At.jsx)("tr",Object(i.a)(Object(i.a)({},e.getHeaderGroupProps()),{},{children:e.headers.map((function(e){return Object(At.jsx)("th",Object(i.a)(Object(i.a)({className:"px-6 py-2 text-xs text-gray-500 text-left"},e.getHeaderProps(e.getSortByToggleProps())),{},{children:e.render("Header")}))}))}))}))}),Object(At.jsx)("tbody",Object(i.a)(Object(i.a)({className:"divide-y divide-gray-200"},o()),{},{children:u.map((function(e){return l(e),Object(At.jsx)("tr",Object(i.a)(Object(i.a)({className:"whitespace-nowrap"},e.getRowProps()),{},{children:e.cells.map((function(e){return Object(At.jsx)(er,{tdProps:e.getCellProps(),elementId:e.row.original.id,children:e.render("Cell")},"".concat(e.column.id).concat(e.row.id))}))}))}))}))]}))},rr=function(e){var t=e.sectionTitle,n=e.sectionId,r=e.projectId;return Object(At.jsx)("div",{className:"container px-5 py-24 mx-auto",children:Object(At.jsx)("div",{className:"p-4 lg:w-2/3 mx-auto",children:Object(At.jsxs)("div",{className:"h-full bg-white shadow px-8 pt-16 pb-16 rounded-lg overflow-hidden text-center relative",children:[Object(At.jsx)("h2",{className:"tracking-widest text-xs title-font font-medium text-gray-400 mb-1",children:"Nothing here yet"}),Object(At.jsxs)("h1",{className:"title-font sm:text-2xl text-xl font-medium text-gray-900 mb-3",children:["There are no items in ",t]}),Object(At.jsx)("p",{className:"leading-relaxed mb-3",children:"Create a new entry to populate this list"}),Object(At.jsx)("div",{className:"flex flex-wrap mt-7",children:Object(At.jsx)(Mn.b,{to:_n(Ee.projectSectionAddEle,[{name:pe.projectId,value:r},{name:pe.sectionId,value:n}]),className:"flex-grow mx-2 mt-4 text-white bg-prussian-blue-400 border-0 py-3 px-8 focus:outline-none hover:bg-prussian-blue-500 rounded font-bold text-sm",children:"Create a new element"})})]})})})},ir=function(){var e=Object(yn.h)(),t=e[pe.projectId],n=e[pe.sectionId],r=Object(Ut.b)((function(e){return e.project})),i=Object(Ne.useState)(null),a=Object(Fe.a)(i,2),c=a[0],o=a[1];if(Object(Ne.useEffect)((function(){var e=!0;return e&&function(){var r=Object(X.a)(Y.a.mark((function r(){var i;return Y.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Dt(t);case 2:if(r.sent){r.next=5;break}return r.abrupt("return",o(void 0));case 5:return r.next=7,$[t].callSelector(n).multiple();case 7:i=r.sent,e&&o(i);case 9:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}()(),function(){e=!1}}),[n,t]),void 0===c)return Object(At.jsx)(yn.a,{to:Ee.projectsList});if(null===r||null===c)return Object(At.jsx)(kn,{});var s=Pt(r[F._sections],n);return s?0===c.length?Object(At.jsx)(rr,{sectionId:n,sectionTitle:s.title,projectId:t}):Object(At.jsxs)(wn,{headerText:s.title,children:[Object(At.jsx)(nr,{sectionInfo:s,sectionData:c}),Object(At.jsx)(Yn,{projectId:t,sectionId:n,mode:fe.add})]}):null},ar=function(){function e(t,n){Object(M.a)(this,e),this.projectSettings=t,this.localSettingAdditionalKeys=n,this.copyOfProjectSettings=void 0}return Object(L.a)(e,[{key:"save",value:function(){var e=Object(X.a)(Y.a.mark((function e(){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setProjectSettingsCloneWithAdditionalKeys(),this.doStoreProjectSettings(),e.abrupt("return",this.copyOfProjectSettings);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setProjectSettingsCloneWithAdditionalKeys",value:function(){this.copyOfProjectSettings=Object(i.a)(Object(i.a)({},this.projectSettings),this.localSettingAdditionalKeys)}},{key:"doStoreProjectSettings",value:function(){$.system.callInsertor(ne.projects,this.copyOfProjectSettings).autoInsert()}}]),e}(),cr=function(){function e(t,n){var r;Object(M.a)(this,e),this.project=t,this.mode=n,this.projectDataToSave=(r={},Object(o.a)(r,F._settings,[]),Object(o.a)(r,F._sections,[]),r)}return Object(L.a)(e,[{key:"save",value:function(){var e=Object(X.a)(Y.a.mark((function e(){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.projectDataToSave[F._settings]=this.project[F._settings].concat(),this.projectDataToSave[F._sections]=this.project[F._sections].concat(),this.setcreatedAt(),this.mode===fe.edit&&this.setupdatedAt(),$[this.projectDataToSave[F._settings][0].id]){e.next=7;break}return e.next=7,this.initDbInstance();case 7:return e.next=9,this.saveSettings();case 9:return e.next=11,this.saveSections();case 11:return e.next=13,this.postSaveActions();case 13:return e.abrupt("return",this.projectDataToSave);case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setcreatedAt",value:function(){this.projectDataToSave[F._settings][0].createdAt=new Date((new Date).toUTCString()).toISOString()}},{key:"setupdatedAt",value:function(){this.projectDataToSave[F._settings][0].updatedAt=new Date((new Date).toUTCString()).toISOString()}},{key:"initDbInstance",value:function(){var e=Object(X.a)(Y.a.mark((function e(){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new It(this.projectDataToSave[F._settings][0],this.projectDataToSave[F._sections]).init();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"saveSettings",value:function(){var e=Object(X.a)(Y.a.mark((function e(){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$[this.projectDataToSave[F._settings][0].id].callInsertor(F._settings,this.projectDataToSave[F._settings][0]).autoInsert();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"saveSections",value:function(){var e=Object(X.a)(Y.a.mark((function e(){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$[this.projectDataToSave[F._settings][0].id].callDeletor(F._sections).clearSection();case 2:return e.next=4,$[this.projectDataToSave[F._settings][0].id].callInsertor(F._sections,this.projectDataToSave[F._sections]).autoInsert();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"postSaveActions",value:function(){var e=Object(X.a)(Y.a.mark((function e(){var t,n,r,i;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.mode===fe.add?"postProjectCreation":"postProjectUpdate",e.next=3,null===(t=(n=$[this.projectDataToSave[F._settings][0].id].dbStore)[r])||void 0===t?void 0:t.call(n,this.projectDataToSave);case 3:if(e.t0=e.sent,e.t0){e.next=6;break}e.t0={};case 6:return i=e.t0,e.next=9,new ar(this.projectDataToSave[F._settings][0],i).save();case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),or=function(e){var t=e.indexSection,n=e.indexFormElement,a=e.element,c=Object(yn.h)(),s=Object(Ut.b)((function(e){return e.formProject.mode})),u=Object(Ut.b)((function(e){return e.formProject.original[F._sections][t]})),l=c[pe.projectId],d=Object(Ne.useMemo)((function(){return l?fe.edit:fe.add}),[l]),h=function(e,t){return!(!t||!e)&&e.formModel.some((function(e){return e.fieldName===t}))}(u,a.fieldName),f=Object(Ne.useMemo)((function(){return d===fe.edit&&h?P[s].sectionEles.existingItem:P[s].sectionEles.newItem}),[h,d,s]);return Object(At.jsx)(vn,Object(i.a)({},Object(i.a)(Object(i.a)({},e),{},{formModel:f,handleChange:function(e,t,n,c){var s="label"!==n||h?{}:{fieldName:"string"===typeof c?dn(c):c};J.dispatch({type:r.updateFormProjectUpdateFormModelOfSection,payload:{indexSection:e,indexFormElement:t,formElement:Object(i.a)(Object(i.a)(Object(i.a)({},a),s),{},Object(o.a)({},n,c))}})}.bind(void 0,t,n),handleOptionsChange:function(e,t,n,a,c,s){J.dispatch({type:r.updateFormProjectUpdateFormModelOptionValue,payload:{indexSection:e,indexFormElement:t,indexOptions:n,formElement:Object(i.a)(Object(i.a)({},a),{},Object(o.a)({},c,s))}})}.bind(void 0,t,n),handleClickAddOption:function(e,t){J.dispatch({type:r.updateFormProjectUpdateFormModelAddOption,payload:{indexSection:e,indexFormElement:t}})}.bind(void 0,t,n),handleClickDeleteOption:function(e,t,n){J.dispatch({type:r.updateFormProjectUpdateFormModelDeleteOption,payload:{indexSection:e,indexFormElement:t,indexOptions:n}})}.bind(void 0,t,n)})))},sr=function(e){var t=e.section,n=e.sectionIndex,a=Object(Ut.b)((function(e){return e.formProject.mode})),c=Object(Ut.b)((function(e){return e.formProject.project[F._sections]})),s=t.formModel.map((function(e){return Object.values(l).includes(e.fieldName)?null:e.fieldName})).filter((function(e){return null!==e})),u=function(e){J.dispatch({type:r.updateFormProjectRemoveFieldFromSection,payload:{sectionIndex:n,fieldIndex:e}})};return Object(At.jsxs)("div",{className:"mt-5 p-4 bg-white rounded shadow",children:[Object(At.jsxs)("div",{children:[Object(At.jsx)("h3",{className:"text-md font-bold",children:"Section # ".concat(n+1)}),Object(At.jsx)("hr",{className:"mt-4"})]}),Object(At.jsx)("div",{className:"pt-4",children:Object(At.jsx)(vn,{formModel:P[a].sectionInfo,element:t,handleChange:function(e,n,a){J.dispatch({type:r.updateFormProjectUpdateSection,payload:{section:Object(i.a)(Object(i.a)({},t),{},Object(o.a)({},n,a)),index:e}})}.bind(void 0,n),sectionId:t.id})}),Object(At.jsx)("h4",{className:"pl-2 font-bold mb-2 mt-6",children:"Section element fields"}),t.formModel.map((function(e,r){return s.includes(e.fieldName)?Object(At.jsxs)("div",{className:"border border-transparent hover:border-prussian-blue-500 shadow rounded mb-3 p-4",children:[Object(At.jsx)(or,{indexFormElement:r,indexSection:n,element:e}),s.length<2?null:Object(At.jsx)("div",{className:"flex justify-end",children:Object(At.jsx)("button",{onClick:u.bind(void 0,r),className:"text-sm py-1 px-3 ".concat(on),children:"Delete field"})})]},"".concat(t.id,"-").concat(r)):null})),Object(At.jsxs)("div",{className:"flex items-end mt-10 mb-1",children:[c.length>1&&Object(At.jsx)("button",{onClick:function(){J.dispatch({type:r.updateFormProjectRemoveSection,payload:n})},className:"py-2 px-4 text-sm ".concat(on),children:"Delete section"}),Object(At.jsx)("button",{onClick:function(){J.dispatch({type:r.updateFormProjectAddFieldToSection,payload:n})},className:"ml-auto py-2 px-4 text-sm ".concat(cn),children:"Add field"})]})]})},ur=function(){var e=Object(yn.h)().projectId,t=Object(Ut.b)((function(e){return e.formProject.mode})),n=Object(Ut.b)((function(e){return e.formProject.project})),a=Object(Ut.b)((function(e){return e.formElesValidState})),c=e?fe.edit:fe.add,s=Object(yn.g)(),u=function(){var e=Object(X.a)(Y.a.mark((function e(){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new cr(n,c).save();case 2:return e.next=4,(new Ie).load();case 4:new Nt(n[F._settings],n[F._sections]).set(),s(_n(Ee.projectDetails,[{name:pe.projectId,value:n[F._settings][0].id}]));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),l=c===fe.add?P[t].projectInfo.newItem:P[t].projectInfo.existingItem;return Object(At.jsxs)("span",{children:[Object(At.jsx)("div",{className:"mt-5 p-4 bg-white rounded shadow",children:Object(At.jsx)(vn,{formModel:l,element:n[F._settings][0],handleChange:function(e,t){J.dispatch({type:r.updateFormProjectSettings,payload:Object(i.a)(Object(i.a)({},n[F._settings][0]),{},Object(o.a)({},e,t))})}})}),Object(At.jsx)("div",{className:"px-1 md:px-2 lg:px-3",children:n[F._sections].map((function(e,t){return Object(At.jsx)(sr,{section:e,sectionIndex:t},e.id)}))}),Object(At.jsx)("div",{className:"mt-5 p-4 bg-white rounded shadow",children:Object(At.jsxs)("div",{className:"flex items-end flex-wrap",children:[Object(At.jsx)("button",{className:"w-full sm:w-auto py-2 px-6 sm:mr-3 ".concat(cn),onClick:function(){J.dispatch({type:r.updateFormProjectAddSection})},children:"Add section"}),Object(At.jsx)("button",{className:"w-5/12 sm:w-auto sm:ml-auto py-2 px-6 bg-gray-200 font-semibold rounded hover:bg-gray-300 mr-3",onClick:function(){return s(-1)},children:"Cancel"}),Object(At.jsx)("button",{disabled:Object.keys(a).some((function(e){return!1===a[e]})),className:"w-5/12 ml-auto sm:ml-0 mt-8 sm:mt-0 sm:w-auto py-2 px-6 bg-prussian-blue-400 text-white font-semibold rounded hover:bg-prussian-blue-500 disabled:bg-gray-400 disabled:bg-opacity-40 disabled:cursor-not-allowed",onClick:u,children:"Save"})]})})]})},lr=(n(284),function(){return Object(At.jsx)("div",{className:"ml-auto",children:Object(At.jsxs)("label",{htmlFor:"project-editor-mode-toggle",className:"flex items-center cursor-pointer",children:[Object(At.jsxs)("div",{className:"mr-3 mt-1 text-gray-500 text-xs leading-none text-right",children:["Advanced",Object(At.jsx)("br",{}),"mode"]}),Object(At.jsxs)("div",{className:"relative mt-1",children:[Object(At.jsx)("input",{type:"checkbox",id:"project-editor-mode-toggle",className:"sr-only",onChange:function(){J.dispatch({type:r.setProjectEditorMode})}}),Object(At.jsx)("div",{className:"block bg-gray-600 w-10 h-6 rounded-full"}),Object(At.jsx)("div",{className:"dot absolute left-1 top-1 bg-white w-4 h-4 rounded-full transition"})]})]})})}),dr=function(){var e=Object(yn.h)(),t=e[pe.projectId]?fe.edit:fe.add,n=e[pe.projectId],i=Object(Ne.useState)(null),a=Object(Fe.a)(i,2),c=a[0],s=a[1];if(Object(Ne.useEffect)((function(){var e,r=!0;return t===fe.add?s((e={},Object(o.a)(e,F._settings,[{id:V.random(),title:"",description:"",createdAt:"",localStorage:u.IndexedDB}]),Object(o.a)(e,F._sections,[{id:V.random(),title:"",formModel:[{}]}]),e)):(r&&function(){var e=Object(X.a)(Y.a.mark((function e(){var t,i,a;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Dt(n);case 2:if(t=e.sent,n&&t){e.next=5;break}return e.abrupt("return",s(void 0));case 5:return e.next=7,$[n].callSelector(F._settings).multiple();case 7:return i=e.sent,e.next=10,$[n].callSelector(F._sections).multiple();case 10:a=e.sent,r&&s({_settings:i,_sections:a});case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()(),function(){r=!1})}),[t,n]),void 0===c)return Object(At.jsx)(yn.a,{to:Ee.projectsList});var l=t===fe.add?"Add Project":"Edit Project";return J.dispatch({type:r.setFormProject,payload:c}),Object(At.jsxs)("span",{children:[Object(At.jsxs)("div",{className:"p-4 bg-white rounded shadow flex",children:[Object(At.jsx)("div",{children:Object(At.jsx)("h3",{className:"text-xl font-bold",children:l})}),null!==c&&Object(At.jsx)(lr,{})]}),null===c&&Object(At.jsx)(kn,{}),null!==c&&Object(At.jsx)(ur,{})]})},hr=function(){function e(t,n){Object(M.a)(this,e),this.projectData=t,this.fileHandle=n}return Object(L.a)(e,[{key:"import",value:function(){var e=Object(X.a)(Y.a.mark((function e(){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.initializeDb();case 2:return e.next=4,this.setLocalProjectSettings();case 4:if(this.dispatchProject(this.projectData[F._settings][0]),this.projectData[F._settings][0].localStorage!=u.IndexedDB){e.next=8;break}return e.next=8,this.saveDataToDb();case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setLocalProjectSettings",value:function(){var e=Object(X.a)(Y.a.mark((function e(){var t,n,r;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(t=(n=$[this.projectData[F._settings][0].id].dbStore).postProjectCreation)||void 0===t?void 0:t.call(n,this.projectData);case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0={};case 5:return r=e.t0,e.next=8,new ar(this.projectData[F._settings][0],r).save();case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initializeDb",value:function(){var e=Object(X.a)(Y.a.mark((function e(){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new It(this.projectData[F._settings][0],this.projectData[F._sections],this.fileHandle).init();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"saveDataToDb",value:function(){var e=Object(X.a)(Y.a.mark((function e(){var t;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=Y.a.keys(this.projectData);case 1:if((e.t1=e.t0()).done){e.next=7;break}return t=e.t1.value,e.next=5,$[this.projectData[F._settings][0].id].callInsertor(t,this.projectData[t]).autoInsert();case 5:e.next=1;break;case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"dispatchProject",value:function(e){J.dispatch({type:r.addProjectToList,payload:e})}}]),e}(),fr=n(149),pr=n.n(fr),br=function(){function e(){Object(M.a)(this,e),this.fileHandle=void 0,this.fileContents=void 0,this.projectData=void 0}return Object(L.a)(e,[{key:"import",value:function(){var e=Object(X.a)(Y.a.mark((function e(){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("function"!==typeof window.showOpenFilePicker){e.next=5;break}return e.next=3,this.askForFileHandle();case 3:e.next=7;break;case 5:return e.next=7,this.importFromFile();case 7:if(this.fileContents){e.next=9;break}return e.abrupt("return");case 9:return this.parseFileContents(),e.abrupt("return",{project:this.projectData,fileHandle:this.fileHandle});case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"askForFileHandle",value:function(){var e=Object(X.a)(Y.a.mark((function e(){var t;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.showOpenFilePicker({multiple:!1});case 2:return t=e.sent,this.fileHandle=t[0],e.next=6,Ae(this.fileHandle);case 6:this.fileContents=e.sent;case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"importFromFile",value:function(){var e=Object(X.a)(Y.a.mark((function e(){var t;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,pr()({multiple:!1,accept:"text/json"});case 2:return t=e.sent,e.next=5,t[0].text();case 5:this.fileContents=e.sent;case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"parseFileContents",value:function(){this.projectData=JSON.parse(this.fileContents)}}]),e}(),jr=function(e){var t=e.btnType,n=void 0===t?"icon":t,r=Object(yn.g)(),a=Object(Ut.b)((function(e){return e.formElesValidState})),c=Object(Ne.useState)(!1),s=Object(Fe.a)(c,2),u=s[0],l=s[1],d=Object(Ne.useState)("animate__fadeIn"),h=Object(Fe.a)(d,2),f=h[0],p=h[1],b=Object(Ne.useState)(null),j=Object(Fe.a)(b,2),m=j[0],v=j[1],x=Object(Ne.useState)(),O=Object(Fe.a)(x,2),y=O[0],g=O[1],k=Object(Ne.useState)(null),S=Object(Fe.a)(k,2),I=S[0],N=S[1],C=function(){var e=Object(X.a)(Y.a.mark((function e(){var t,n,r;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!u){e.next=5;break}p("animate__fadeOut"),setTimeout((function(){return l(!1)}),500),e.next=20;break;case 5:return e.next=7,(new br).import();case 7:if(e.t0=e.sent,e.t0){e.next=10;break}e.t0={};case 10:if(t=e.t0,n=t.project,r=t.fileHandle,n){e.next=15;break}return e.abrupt("return");case 15:p("animate__fadeIn"),l(!0),v(n),N(n[F._settings][0]),g(r);case 20:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),D=function(){var e=Object(X.a)(Y.a.mark((function e(){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m[F._settings][0]=I,e.next=3,new hr(m,y).import();case 3:C(),new Nt(m[F._settings],m[F._sections]).set(),setTimeout((function(){return r(Ee.projectsList)}),500);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(At.jsxs)("span",{children:["icon"===n?Object(At.jsxs)("span",{children:[Object(At.jsx)("button",{"data-tip":!0,"data-for":"importProject",onClick:C,className:"mx-2 my-2 text-white bg-prussian-blue-600 border-0 py-1 px-6 focus:outline-none hover:bg-prussian-blue-700 rounded font-bold text-sm",children:Object(At.jsx)("i",{className:"bi bi-arrow-bar-down"})}),Object(At.jsx)(Kt.a,{id:"importProject",effect:"solid",children:Object(At.jsx)("span",{children:"Import an existing project"})})]}):Object(At.jsx)("button",{"data-tip":!0,"data-for":"importProject",onClick:C,className:"w-full mt-4 text-white bg-prussian-blue-400 border-0 py-3 px-8 focus:outline-none hover:bg-prussian-blue-500 rounded font-bold text-sm",children:"Import an existing project"}),u&&Object(At.jsx)(An,{title:"Import project",actionText:"Import",type:"confirm",handleClickAction:D,closeFn:C,animationClass:f,disableAction:Object.keys(a).some((function(e){return!1===a[e]})),children:I&&Object(At.jsx)(vn,{element:I,formModel:w,handleChange:function(e,t){N(Object(i.a)(Object(i.a)({},I),{},Object(o.a)({},e,t)))}})})]})},mr=function(){return Object(At.jsx)("div",{className:"container px-0 md:px2 lg:px-5 pt-20 md:pt-24 mx-auto",children:Object(At.jsx)("div",{className:"p-4 lg:w-2/3 mx-auto",children:Object(At.jsxs)("div",{className:"h-full bg-white shadow px-8 pt-16 pb-16 rounded-lg overflow-hidden text-center relative",children:[Object(At.jsx)("h2",{className:"tracking-widest text-xs title-font font-medium text-gray-400 mb-1",children:"No projects found"}),Object(At.jsx)("h1",{className:"title-font sm:text-2xl text-xl font-medium text-gray-900 mb-3",children:"You don't have any Projects on this device yet"}),Object(At.jsx)("p",{className:"leading-relaxed mb-3",children:"You can create a new project or import one from an existing project file."}),Object(At.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 lg:gap-2 mt-7",children:[Object(At.jsx)(jr,{btnType:"text"}),Object(At.jsx)(Mn.b,{to:Ee.projectAdd,className:"w-full flex flex-wrap content-center justify-center mt-4 bg-gray-200 border-0 py-3 px-8 focus:outline-none hover:bg-gray-400 rounded font-bold text-sm",children:"Create a new project"})]})]})})})},vr=function(e){var t=e.project;return Object(At.jsxs)("div",{className:"ml-auto",children:[Object(At.jsx)(Ln,{project:t}),Object(At.jsxs)(Mn.b,{to:_n(Ee.projectDetails,[{name:pe.projectId,value:t.id}]),className:"px-4 py-3 text-white inline-flex items-center leading-none text-sm bg-prussian-blue-400 hover:bg-prussian-blue-500 rounded",children:[Object(At.jsx)("i",{className:"bi-info-circle mr-2"}),"Project details"]})]})},xr=function(e){var t=e.project;return Object(At.jsx)("button",{onClick:function(){return new Ct(t.id).loadProject()},className:"px-4 py-2 text-white ml-auto inline-flex items-center md:mb-2 lg:mb-0 rounded bg-green-500 hover:bg-green-600 text-sm",children:"Load project"})},Or=function(e){var t=e.project,n=Object(Ut.b)((function(e){return e.project}));return Object(At.jsx)("div",{className:" mt-4 h-full border-2 border-gray-200 border-opacity-60 rounded-lg bg-white",children:Object(At.jsxs)("div",{className:"p-6",children:[Object(At.jsx)("h1",{className:"title-font text-lg font-medium text-gray-900 mb-3",children:t.title}),Object(At.jsx)("p",{className:"text-lg mb-3",children:t.description}),Object(At.jsx)("p",{className:"text-gray-600 text-xs",children:"Created on:"}),Object(At.jsx)("p",{className:"text-md",children:tn("yyyy/MM/dd, at hh:mm",new Date(t.createdAt))}),Object(At.jsxs)(Bn,{children:[Object(At.jsx)(Tn,{project:t}),null===n||n[F._settings][0].id!==t.id||void 0===$[t.id]?Object(At.jsx)(xr,{project:t}):Object(At.jsx)(vr,{project:t})]})]})})},yr=function(){var e=Object(Ne.useState)(!1),t=Object(Fe.a)(e,2),n=t[0],r=t[1],i=Object(Ut.b)((function(e){return e.projects})),a=(null===i||void 0===i?void 0:i.length)||0;return Object(Ne.useEffect)((function(){var e=!0;return e&&function(){var e=Object(X.a)(Y.a.mark((function e(){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new Ie).load();case 2:r(!0);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()(),function(){e=!1}}),[a]),Array.isArray(i)&&0===i.length?Object(At.jsx)(yn.a,{to:Ee.projectsNone}):n?Object(At.jsxs)("div",{children:[Object(At.jsx)("div",{className:"md:w-full bg-white border-b-2 rounded border-white",children:Object(At.jsxs)("div",{className:"flex h-full border-t-2 border-prussian-blue-400 border-opacity-60 rounded justify-between",children:[Object(At.jsx)("div",{className:"px-6 py-3",children:Object(At.jsx)("h1",{className:"title-font text-md font-medium text-gray-900",children:"Projects on this device"})}),Object(At.jsxs)("div",{className:"my-2",children:[Object(At.jsx)(jr,{}),Object(At.jsx)(Mn.b,{"data-tip":!0,"data-for":"createProject",to:Ee.projectAdd,className:"mx-2 my-2 text-white bg-prussian-blue-400 border-0 py-1 px-6 focus:outline-none hover:bg-gray-400 rounded font-bold text-sm",children:Object(At.jsx)("i",{className:"bi bi-plus"})}),Object(At.jsx)(Kt.a,{id:"createProject",effect:"solid",children:Object(At.jsx)("span",{children:"Create a new project"})})]})]})}),Object(At.jsx)("div",{className:"p-1 md:w-full",children:i.map((function(e,t){return Object(At.jsx)(Or,{project:e},e.id)}))})]}):Object(At.jsx)("span",{})},gr=function(){return Object(At.jsxs)(yn.d,{children:[Object(At.jsx)(yn.b,{path:Ee.projectsList,element:Object(At.jsx)(yr,{})}),Object(At.jsx)(yn.b,{path:Ee.projectAdd,element:Object(At.jsx)(dr,{})}),Object(At.jsx)(yn.b,{path:Ee.projectEdit,element:Object(At.jsx)(dr,{})}),Object(At.jsx)(yn.b,{path:Ee.projectsNone,element:Object(At.jsx)(mr,{})}),Object(At.jsx)(yn.b,{path:Ee.projectDetails,element:Object(At.jsx)(Un,{})}),Object(At.jsx)(yn.b,{path:Ee.projectSectionElesList,element:Object(At.jsx)(ir,{})}),Object(At.jsx)(yn.b,{path:Ee.projectSectionEleDetails,element:Object(At.jsx)(Xn,{})}),Object(At.jsx)(yn.b,{path:Ee.projectSectionAddEle,element:Object(At.jsx)(Sn,{})}),Object(At.jsx)(yn.b,{path:Ee.projectSectionEditEle,element:Object(At.jsx)(Sn,{})}),Object(At.jsx)(yn.b,{path:"*",element:Object(At.jsx)(yn.a,{to:Ee.projectsList})})]})},wr=function(e){var t,n=e.project,r=Object(Ut.b)((function(e){return e.projects})),i=Object(yn.g)(),a=Object(Ne.useState)(!1),c=Object(Fe.a)(a,2),o=c[0],s=c[1],u=function(e){s(!o)},l=function(){var e=Object(X.a)(Y.a.mark((function e(t){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Ct(t).loadProject();case 2:d(t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),d=function(e){i(_n(Ee.projectDetails,[{name:pe.projectId,value:e}]))};return Object(At.jsxs)("span",{children:[o&&Object(At.jsx)("div",{onClick:function(){return s(!1)},className:"absolute inset-0 h-full w-full z-10"}),Object(At.jsx)("p",{className:"text-xs text-gray-600 pl-3",children:"Current project:"}),Object(At.jsxs)("div",{"x-data":"{ dropdownOpen: true }",className:"relative",children:[Object(At.jsxs)("button",{onClick:function(){return s(!o)},className:"relative w-full flex justify-between text-left z-10 rounded py-2 px-3 bg-gray-100 hover:bg-gray-200 focus:outline-none focus:bg-gray-300",children:[Object(At.jsx)("span",{children:null===n||void 0===n||null===(t=n[F._settings][0])||void 0===t?void 0:t.title}),Object(At.jsx)("i",{className:"bi-chevron-expand my-auto"})]}),o&&Object(At.jsxs)("div",{className:"absolute left-0 mt-2 w-60 bg-white rounded-md overflow-hidden shadow-xl z-20 border border-bg-500",children:[(null===r||void 0===r?void 0:r.length)>1&&Object(At.jsx)("div",{className:"block py-2.5 px-4 text-sm bg-gray-100 text-gray-600",children:"Projects on this device"}),null===r||void 0===r?void 0:r.map((function(e){return n[F._settings][0].id===e.id?null:Object(At.jsx)("button",{className:"w-full block text-left px-4 py-2 text-sm text-gray-800 border-b hover:bg-gray-200",onClick:function(){return u(l(e.id))},children:e.title},e.id)})),Object(At.jsx)("div",{className:"block py-2.5 px-4 text-sm bg-gray-100 text-gray-600",children:"Actions"}),Object(At.jsx)("button",{className:"w-full block text-left px-4 py-2 text-sm text-gray-800 border-b hover:bg-gray-200",onClick:function(){return u(d(n[F._settings][0].id))},children:"Go to the details of this project"}),Object(At.jsx)("button",{className:"w-full block text-left px-4 py-2 text-sm text-gray-800 border-b hover:bg-gray-200",onClick:function(){return u(i(Ee.projectsList))},children:"Go to the projects list"}),Object(At.jsx)("button",{className:"w-full block text-left px-4 py-2 text-sm text-gray-800 border-b hover:bg-gray-200",onClick:function(){return u(i(Ee.projectAdd))},children:"Create a new project"})]})]})]})},kr="block py-2.5 px-4 transition duration-200 border-l-2 hover:border-prussian-blue-700 hover:text-prussian-blue-500 text-sm font-semibold",Sr=function(e,t){return"".concat(kr,e===t?" border-prussian-blue-700":" border-transparent")},Ir=[{to:Ee.projectsList,txt:"Projects",icon:"bi-files"}],Nr=function(){var e,t=Object(Ut.b)((function(e){return e.project})),n=Object(yn.f)();return null===t?Object(At.jsx)("span",{}):Object(At.jsxs)("div",{className:"mt-3",children:[Object(At.jsx)("div",{className:"block py-2.5 px-1",children:Object(At.jsx)(wr,{project:t})}),Object(At.jsx)("div",{className:"block py-2.5 px-4",children:Object(At.jsx)("p",{className:"text-xs text-gray-600",children:"Project sections:"})}),null===t||void 0===t||null===(e=t[F._sections])||void 0===e?void 0:e.map((function(e){var r=_n(Ee.projectSectionElesList,[{name:pe.projectId,value:t[F._settings][0].id},{name:pe.sectionId,value:e.id}]);return Object(At.jsxs)(Mn.b,{to:r,className:Sr(n.pathname,r),children:[Object(At.jsx)("i",{className:"bi-chevron-compact-right"}),Object(At.jsx)("span",{className:"ml-2",children:e.title})]},e.id)}))]})},Cr=function(){var e=Object(yn.f)();return Object(At.jsxs)("div",{children:[Ir.map((function(t){return Object(At.jsxs)(Mn.b,{to:t.to,className:Sr(e.pathname,t.to),children:[Object(At.jsx)("i",{className:t.icon}),Object(At.jsx)("span",{className:"ml-2",children:t.txt})]},t.to)})),Object(At.jsx)(Nr,{})]})},Dr=function(e){return Object(At.jsx)("div",{className:"flex-1 p-2 md:p-3 md:pt-5 lg:pt-5 lg:p-10 pt-5 overflow-auto",children:e.children})},Er=function(){var e=Object(Ut.b)((function(e){return e.layout.sidebar})),t=function(){J.dispatch({type:r.toggleSidebar})};return Object(At.jsxs)("div",{className:"bg-white text-gray-700 flex h-14 shadow-md justify-between",children:[Object(At.jsx)("button",{className:"mobile-menu-button p-4 focus:outline-none  md:hidden",onClick:t,children:Object(At.jsx)("svg",{className:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:Object(At.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6h16M4 12h16M4 18h16"})})}),Object(At.jsxs)("div",{className:"relative flex items-center lg:w-auto lg:static md:pl-5 -ml-7 md:ml-0",children:[Object(At.jsx)(Mn.b,{to:"/",className:"text-lg font-bold leading-relaxed inline-block mr-4 py-2 whitespace-no-wrap uppercase",children:Object(At.jsx)("img",{src:"".concat("/app","/assets/logo/logo_square.svg"),style:{height:"30px",width:"auto"},alt:"Anita"})}),Object(At.jsxs)(Mn.b,{to:"/",className:"hidden md:inline-block mr-4 py-2 whitespace-no-wrap text-prussian-blue-400",children:[Object(At.jsx)("span",{className:"text-md font-bold leading-relaxed uppercase",children:"Anita"}),Object(At.jsx)("sup",{style:{fontVariant:"small-caps"},children:"Beta"})]})]}),Object(At.jsx)("div",{className:"visible md:hidden",children:"\xa0"}),""===e&&Object(At.jsx)("div",{onClick:t,className:"absolute inset-0 h-full w-full z-10 md:hidden"})]})},Fr=function(e){var t=Object(Ut.b)((function(e){return e.layout.sidebar}));return Object(At.jsx)("div",{className:"py-5 z-10",children:Object(At.jsxs)("div",{className:"".concat(t," sidebar h-full bg-white shadow rounded-sm text-prussian-blue-500 w-64 space-y-6 py-7 px-2 absolute inset-y-0 left-0 transform md:relative md:translate-x-0 transition duration-200 ease-in-out"),children:[Object(At.jsx)("nav",{children:e.children}),Object(At.jsxs)("div",{className:"absolute bottom-1 text-xs text-gray-400",children:[Object(At.jsxs)("p",{className:"inline-block mr-1",children:["v","0.11.0"]}),"|",Object(At.jsxs)("a",{className:"ml-1",href:"https://github.com/anita-app/anita/issues",target:"_blank",rel:"noreferrer",children:[Object(At.jsx)("i",{className:"bi-bug","data-tip":!0,"data-for":"reportBug"}),Object(At.jsx)(Kt.a,{id:"reportBug",effect:"solid",children:Object(At.jsx)("span",{children:"Report a bug"})})]})]})]})})},Pr=function(){return Object(At.jsxs)(Mn.a,{children:[Object(At.jsx)(Er,{}),Object(At.jsxs)("div",{className:"relative admin-container flex",children:[Object(At.jsx)(Fr,{children:Object(At.jsx)(Cr,{})}),Object(At.jsx)(Dr,{children:Object(At.jsx)(gr,{})})]})]})},Ar=n(37),Tr=n.n(Ar),_r=(n(285),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)));function Mr(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}(new De).init(),Tr.a.render(Object(At.jsx)(Ce.a.StrictMode,{children:Object(At.jsx)(Ut.a,{store:J,children:Object(At.jsx)(Pr,{})})}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/app",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/app","/service-worker.js");_r?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var r=n.headers.get("content-type");404===n.status||null!=r&&-1===r.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):Mr(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):Mr(t,e)}))}}()}},[[286,1,2]]]);
//# sourceMappingURL=main.eeb9045c.chunk.js.map